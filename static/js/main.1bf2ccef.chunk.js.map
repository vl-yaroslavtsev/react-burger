{"version":3,"sources":["pages/feed.module.css","pages/profile.module.css","services/hooks.ts","components/lazy-image/lazy-image.tsx","services/utils.ts","components/burger-ingredients/ingredient/ingredient.tsx","components/skeleton/skeleton.tsx","services/scrollbar.ts","services/api.ts","services/actions/ingredients.ts","components/burger-ingredients/burger-ingredients.tsx","images/done.svg","components/order-details/order-details.tsx","components/modal-overlay/modal-overlay.tsx","components/modal/modal.tsx","components/spinner/spinner.tsx","services/actions/constructor.ts","components/burger-constructor/drag-element/drag-element.tsx","services/actions/order.ts","components/burger-constructor/burger-constructor.tsx","pages/home.tsx","components/password-input/password-input.tsx","services/form.ts","services/actions/user.ts","services/auth.ts","pages/login.tsx","pages/register.tsx","pages/forgot-password.tsx","pages/reset-password.tsx","components/view-input/view-input.tsx","components/profile-form/profile-form.tsx","components/ingredient-avatar/ingredient-avatar.tsx","services/actions/ws-feed.ts","services/actions/ws-profile.ts","services/orders.ts","components/order-item/order-item.tsx","pages/profile.tsx","pages/feed.tsx","components/order-info/order-info.tsx","pages/order.tsx","components/ingredient-details/ingredient-details.tsx","pages/ingredient.tsx","pages/not-found.tsx","components/app-header/header-item/header-item.tsx","components/app-header/app-header.tsx","components/protected-route.tsx","components/unauthorized-route.tsx","components/ingredient-details-modal/ingredient-details-modal.tsx","components/order-info-modal/order-info-modal.tsx","components/app/app.tsx","reportWebVitals.ts","services/reducers/ingredients.ts","services/reducers/constructor.ts","services/reducers/order.ts","services/reducers/user.ts","services/reducers/ws-feed.ts","services/reducers/ws-profile.ts","services/reducers/index.ts","services/socket-middleware.ts","services/store.ts","index.tsx","components/burger-constructor/burger-constructor.module.css","components/burger-ingredients/burger-ingredients.module.css","components/order-item/order-item.module.css","components/app/app.module.css","components/order-info/order-info.module.css","pages/order.module.css","components/app-header/app-header.module.css","components/modal/modal.module.css","components/burger-ingredients/ingredient/ingredient.module.css","components/lazy-image/lazy-image.module.css","components/spinner/spinner.module.css","pages/register.module.css","pages/reset-password.module.css","components/profile-form/profile-form.module.css","components/ingredient-avatar/ingredient-avatar.module.css","components/ingredient-details/ingredient-details.module.css","components/skeleton/skeleton.module.css","components/order-details/order-details.module.css","components/modal-overlay/modal-overlay.module.css","components/burger-constructor/drag-element/drag-element.module.css","pages/login.module.css","pages/forgot-password.module.css","pages/ingredient.module.css","components/app-header/header-item/header-item.module.css"],"names":["module","exports","useDispatch","dispatchHook","useSelector","selectorHook","LazyImage","memo","src","responsive","className","alt","width","height","props","ref","useRef","imageLoaded","useState","isLoaded","setLoaded","loadImage","a","img","Image","Promise","resolve","reject","onload","onerror","useEffect","current","el","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","then","threshold","observe","unobserve","useImageLoaded","style","cn","styles","imageResponsive","imagePreloader","imagePreloaderResponsive","getCookie","name","matches","document","cookie","match","RegExp","replace","decodeURIComponent","undefined","setCookie","value","exp","expires","d","Date","setTime","getTime","toUTCString","path","updatedCookie","encodeURIComponent","propName","propValue","deleteCookie","isEqual","obj1","obj2","p","hasOwnProperty","toString","formatPastDate","dateStr","today","setHours","setMinutes","setSeconds","date","timezone","getHours","getUTCHours","hours","padStart","minutes","getMinutes","past","toLocaleDateString","days","Math","ceil","n","text_forms","n1","abs","declensionOfNum","timingFunctions","linear","k","easeIn","pow","easeOut","easeInOut","sin","PI","animate","timing","draw","duration","start","performance","now","timingFunc","requestAnimationFrame","time","timeFraction","progress","usePrevious","useWindowResize","callback","running","run","onResize","window","setTimeout","addEventListener","removeEventListener","getScreenSize","innerWidth","useScreenSize","screenSize","setScreenSize","Ingredient","item","count","onClick","price","image","useDrag","type","dragRef","container","e","data-test-id","_id","size","title","Skeleton","circle","repeat","tag","Tag","classNameTotal","skeleton","Array","fill","map","index","useScrollbar","arrExclude","exclude","maxHeight","isInModal","updateScrollbar","bottom","reduce","acc","getComputedStyle","offsetHeight","parseInt","marginTop","marginBottom","modalFix","top","getBoundingClientRect","aroundSpace","classList","add","appStyles","customScrollbar","useLayoutEffect","remove","API_URL","routes","ingredients","orders","auth","login","register","logout","token","user","password","resetCheck","reset","translate","msg","checkResponse","res","json","success","message","ok","Error","status","fetchPost","url","params","fetch","method","headers","body","JSON","stringify","setTokens","accessToken","refreshToken","split","localStorage","setItem","getItem","data","fetchWithRefresh","options","Authorization","loadIngredients","checkoutOrder","items","removeItem","checkResetPassword","resetPassword","loadUser","updateUser","id","GET_INGREDIENTS_REQUEST","GET_INGREDIENTS_SUCCESS","GET_INGREDIENTS_ERROR","getIngredients","dispatch","GROUP_NAME","bun","sauce","main","BurgerIngredients","currentTab","setCurrentTab","location","useLocation","store","error","itemsErrorMessage","loading","itemsRequest","construct","constructorItems","bunItem","ingredientsRef","counterMap","useMemo","filter","length","root","section","target","dataset","group","rootMargin","sections","querySelectorAll","ingredientList","ingredient","tabs","Object","key","active","tab","querySelector","startScroll","scrollTop","endScroll","offsetTop","scrollToTabSection","data-group","to","pathname","state","background","OrderDetails","orderNumber","statusIcon","ModalOverlay","visible","onClose","hidden","modalRoot","getElementById","visibleModals","Modal","children","header","modal","closeVisible","push","indexOf","splice","keyDownHandler","createPortal","closeButton","content","Spinner","stroke","center","radius","spinner","spinnerCenter","viewBox","cx","cy","r","strokeWidth","ADD_CONSTRUCTOR_INGREDIENT","REMOVE_CONSTRUCTOR_INGREDIENT","REORDER_CONSTRUCTOR_INGREDIENTS","CLEAR_CONSTRUCTOR","DragElement","onDelete","isHoverTop","setHoverTop","isTransition","setTransition","element","opacity","collect","monitor","isDrag","isDragging","dragTargetRef","useDrop","accept","drop","hoverIndex","dropIndex","hover","clientRect","offset","getSourceClientOffset","y","isOver","didDrop","dropTargetRef","prevIsDrag","overLeave","dragLeave","padding","defHeight","display","paddingBottom","paddingTop","transitionDuration","dragItem","text","thumbnail","handleClose","CHECKOUT_ORDER_REQUEST","CHECKOUT_ORDER_SUCCESS","CHECKOUT_ORDER_ERROR","CLEAR_ORDER","BurgerConstructor","isOrderShown","setOrderShown","totalPrice","order","number","orderLoading","checkoutRequest","orderError","checkoutErrorMessage","elementOnDelete","useCallback","zIndex","orderModalOnClose","canDrop","dropIngredientsRef","listRef","bottomBunRef","footerRef","history","useHistory","elements","dragMessage","dragMessageOver","bunElementTop","isLocked","elementsScroll","bunElementBottom","footer","footerCurrency","getState","ids","HomePage","DndProvider","backend","navigator","maxTouchPoints","msMaxTouchPoints","TouchBackend","HTML5Backend","PasswordInput","isValueHidden","setValueHidden","inputRef","handleIconClick","pos","selectionStart","focus","setSelectionRange","icon","onIconClick","emailRegExp","validationRules","required","email","test","String","toLowerCase","minLength","param","validate","rules","ruleName","ruleParam","validateAll","values","errors","keys","useFormSubmit","onSubmit","setValues","validation","setValidation","setData","setError","setLoading","prevDataRef","rulesRef","handleChange","handleSubmit","preventDefault","some","dataChanged","onChange","errorText","GET_USER_REQUEST","GET_USER_SUCCESS","GET_USER_ERROR","SET_USER","CLEAR_USER","useAuth","userRequest","userSuccess","userErrorMessage","userLoaded","signIn","signOut","LoginPage","from","placeholder","disabled","RegisterPage","callRegister","ForgotPasswordPage","ResetPasswordPage","ViewInput","setValue","isEditMode","setEditMode","iconClick","onBlur","ProfileForm","footerVisible","createSetValue","form","formFooter","IngredientAvatar","ingredientImage","ingredientFg","WS_FEED_CONNECTION_START","WS_FEED_CONNECTION_CLOSE","WS_FEED_CONNECTION_SUCCESS","WS_FEED_CONNECTION_CLOSED","WS_FEED_CONNECTION_ERROR","WS_FEED_GET_MESSAGE","WS_PROFILE_CONNECTION_START","WS_PROFILE_CONNECTION_CLOSE","WS_PROFILE_CONNECTION_SUCCESS","WS_PROFILE_CONNECTION_CLOSED","WS_PROFILE_CONNECTION_ERROR","WS_PROFILE_GET_MESSAGE","useIngredientsMap","getFullOrder","ingredientsMap","result","found","find","total","statusMap","created","pending","done","canceled","translateStatus","useOrders","ordersList","useOrderLoad","serverOrder","setServerOrder","setOrder","setOrderLoading","setOrderError","ingredientsError","ingredientsLoading","loadOrderById","catch","err","finally","Ingredients","list","slice","rest","OrderItem","useRouteMatch","createdAt","statusDone","Menu","menu","exact","menuItem","activeClassName","menuItemActive","menuFooter","Logout","logoutError","setLogoutError","OrderList","orderListRef","profile","ordersError","wsError","sort","b","useProfileOrders","orderList","skeletonOrder","ProfilePage","StatisticGridItem","complete","statisticGridItem","statisticGridItemTitle","statisticGridItemList","statisticGridItemText","FeedPage","statisticRef","feed","totalToday","completeNumbers","progressNumbers","useFeedOrders","statistic","statisticGrid","statisticTotalTitle","textSpaceShadow","ingredientName","OrderInfo","OrderPage","useParams","IngredientDetails","image_large","calories","proteins","fat","carbohydrates","IngredientPage","NotFound404","textAlign","HeaderItem","Icon","text_color_inactive","AppHeader","contentItem","navigation","BurgerIcon","ListIcon","contentItemCenter","contentItemRight","ProfileIcon","ProtectedRoute","render","UnauthorizedRoute","IngredientDetailsModal","modalOnClose","goBack","OrderInfoModal","feedOrders","profileOrders","startsWith","Number","App","action","app","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ingredientsState","itemsSuccess","countTotalPrice","prev","constructorState","orderState","checkoutSuccess","userState","initialState","wsConnected","rootReducer","combineReducers","dropItem","payload","socketMiddleware","wsUrl","wsActions","useToken","socket","next","wsInit","wsClose","wsSendMessage","onOpen","onError","onMessage","WebSocket","onopen","event","onmessage","parsedData","parse","restParsedData","close","onclose","send","wsFeedOrders","actions","wsProfileOrders","enhancer","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","applyMiddleware","thunk","createStore","ReactDOM","StrictMode"],"mappings":"4HACAA,EAAOC,QAAU,CAAC,UAAY,wBAAwB,QAAU,sBAAsB,UAAY,wBAAwB,UAAY,wBAAwB,cAAgB,4BAA4B,kBAAoB,gCAAgC,uBAAyB,qCAAqC,sBAAwB,oCAAoC,sBAAwB,oCAAoC,QAAU,sBAAsB,MAAQ,oBAAoB,cAAgB,4BAA4B,oBAAsB,oC,mBCAljBD,EAAOC,QAAU,CAAC,UAAY,2BAA2B,KAAO,sBAAsB,SAAW,0BAA0B,eAAiB,gCAAgC,WAAa,4BAA4B,UAAY,2BAA2B,MAAQ,uBAAuB,cAAgB,iC,6OCM9RC,EAAc,kBAAMC,eACpBC,EAA+CC,I,uGCuD5D,IAwCeC,EAxCyBC,gBACtC,YAQO,IAPLC,EAOI,EAPJA,IAOI,IANJC,kBAMI,aALJC,iBAKI,MALQ,GAKR,MAJJC,WAII,MAJE,GAIF,MAHJC,aAGI,MAHI,IAGJ,MAFJC,cAEI,MAFK,MAEL,EADDC,EACC,uEACEC,EAAMC,iBAAuB,MAC7BC,EA9DV,SAAwBT,EAAaO,GACnC,MAA8BG,oBAAS,GAAvC,mBAAOC,EAAP,KAAiBC,EAAjB,KAEMC,EAAS,uCAAG,WAAOb,GAAP,eAAAc,EAAA,yDACXd,EADW,wDAEVe,EAAM,IAAIC,OACZhB,IAAMA,EAHM,kBAKT,IAAIiB,SAAQ,SAACC,EAASC,GAC3BJ,EAAIK,OAAS,kBAAMF,EAAQlB,IAC3Be,EAAIM,QAAUF,MAPA,2CAAH,sDAqCf,OA1BAG,qBAAU,WACR,GAAoB,OAAhBf,EAAIgB,SAAqBvB,EAA7B,CAIA,IAAMwB,EAAKjB,EAAIgB,QAETE,EAAW,IAAIC,sBACnB,SAACC,EAASF,GACRE,EAAQC,SAAQ,SAACC,GAEXA,EAAMC,gBACRjB,EAAUb,GAAK+B,MAAK,kBAAMnB,GAAU,WAI1C,CACEoB,UAAW,IAMf,OAFAP,EAASQ,QAAQT,GAEV,kBAAMC,EAASS,UAAUV,OAC/B,CAACb,EAAUX,EAAKO,IAEZI,EAsBewB,CAAenC,EAAKO,GAClC6B,EAAQ,CACZ,cAAc,GAAd,OAAkBhC,EAAlB,MACA,eAAgBC,GAElB,OACE,mCACGI,EACC,6CACEP,UAAWmC,IAAGnC,EAAD,eAAeoC,IAAOC,gBAAkBtC,IACrDD,IAAKA,GACAC,EAAa,GAAK,CAAEG,UAH3B,IAIED,IAAKA,GACDG,IAGN,qBACEJ,UAAWmC,IAAGC,IAAOE,eAAgBtC,EAAxB,eACVoC,IAAOG,yBAA2BxC,IAErCM,IAAKA,EACL6B,MAAOA,SC7FZ,SAASM,EAAUC,GACxB,IAAMC,EAAUC,SAASC,OAAOC,MAC9B,IAAIC,OACF,WAAaL,EAAKM,QAAQ,yBAA0B,QAAU,aAGlE,OAAOL,EAAUM,mBAAmBN,EAAQ,SAAMO,EAG7C,SAASC,EACdT,EACAU,GAKC,IAJD/C,EAIA,uDADI,GAEAgD,EAAMhD,EAAMiD,QAChB,GAAkB,iBAAPD,GAAmBA,EAAK,CACjC,IAAME,EAAI,IAAIC,KACdD,EAAEE,QAAQF,EAAEG,UAAkB,IAANL,GACxBA,EAAMhD,EAAMiD,QAAUC,EAEpBF,GAAOA,aAAeG,OACxBnD,EAAMiD,QAAUD,EAAIM,eAEtBtD,EAAMuD,KAAO,IAEb,IAAIC,EAAgBnB,EAAO,KAD3BU,EAAQU,mBAAmBV,IAE3B,IAAK,IAAMW,KAAY1D,EAAO,CAC5BwD,GAAiB,KAAOE,EACxB,IAAMC,EAAa3D,EAA8C0D,IAC/C,IAAdC,IACFH,GAAiB,IAAMG,GAG3BpB,SAASC,OAASgB,EAGb,SAASI,EAAavB,GAC3BS,EAAUT,EAAM,GAAI,CAAEY,SAAU,IAG3B,SAASY,EAAQC,EAAWC,GAEjC,IAAK,IAAMC,KAAKF,EAAM,CAEpB,GAAIA,EAAKG,eAAeD,KAAOD,EAAKE,eAAeD,GAAI,OAAO,EAE9D,cAAeF,EAAKE,IAElB,IAAK,SACH,IAAKH,EAAQC,EAAKE,GAAID,EAAKC,IAAK,OAAO,EACvC,MAEF,IAAK,WACH,GACoB,oBAAXD,EAAKC,IACL,YAANA,GAAmBF,EAAKE,GAAGE,aAAeH,EAAKC,GAAGE,WAEnD,OAAO,EACT,MAEF,QACE,GAAIJ,EAAKE,KAAOD,EAAKC,GAAI,OAAO,GAKtC,IAAK,IAAMA,KAAKD,EACd,GAAsB,oBAAXD,EAAKE,GAAmB,OAAO,EAE5C,OAAO,EAwBF,SAASG,EAAeC,GAC7B,IAAMC,EAAQ,IAAIlB,KAClBkB,EAAMC,SAAS,GACfD,EAAME,WAAW,GACjBF,EAAMG,WAAW,GAEjB,IAAMC,EAAO,IAAItB,KAAKiB,GAChBM,EAAWD,EAAKE,WAAaF,EAAKG,cAClCC,EAAQJ,EAAKE,WAAWT,WAAWY,SAAS,EAAG,KAC/CC,EAAUN,EAAKO,aAAad,WAAWY,SAAS,EAAG,KAErDG,EAAO,GAEX,GAAIR,EAAKpB,UAAYgB,EAAMhB,UAAY,MACrC4B,EAAOR,EAAKS,0BACP,GAAIT,EAAOJ,EAChBY,EAAO,kDACF,GAAIR,EAAKpB,UAAYgB,EAAMhB,UAAY,MAC5C4B,EAAO,qCACF,CACL,IAAME,EAAOC,KAAKC,MACfhB,EAAMhB,UAAYoB,EAAKpB,WAAxB,OAEF4B,EAAI,UAAME,EAAN,YAtCR,SAAyBG,EAAWC,GAElC,IAAIC,GADJF,EAAIF,KAAKK,IAAIH,GAAK,KACL,GACb,OAAIA,EAAI,IAAMA,EAAI,GACTC,EAAW,GAEhBC,EAAK,GAAKA,EAAK,EACVD,EAAW,GAET,IAAPC,EACKD,EAAW,GAEbA,EAAW,GA0BEG,CAAgBP,EAAM,CAAC,2BAAQ,qBAAO,6BAApD,mCAGN,MAAM,GAAN,OAAUF,EAAV,aAAmBJ,EAAnB,YAA4BE,EAA5B,iBACEL,EAAW,EAAI,IAAM,IADvB,OAEGA,GAGE,IAAMiB,EAAkB,CAC7BC,OAD6B,SACtBC,GACL,OAAOA,GAETC,OAJ6B,SAItBD,GACL,OAAOT,KAAKW,IAAIF,EAAG,QAErBG,QAP6B,SAOrBH,GACN,OAAO,EAAIT,KAAKW,IAAI,EAAIF,EAAG,QAE7BI,UAV6B,SAUnBJ,GACR,MAAO,IAAOT,KAAKc,KAAKL,EAAI,IAAOT,KAAKe,IAAM,KAU3C,SAASC,EAAT,GAIY,IAAD,IAHhBC,cAGgB,MAHP,YAGO,EAFhBC,EAEgB,EAFhBA,KACAC,EACgB,EADhBA,SAEMC,EAAQC,YAAYC,MACpBC,EAAahB,EAAgBU,GAEnC,OAAO,IAAI1F,SAAQ,SAACC,GAClBgG,uBAAsB,SAASR,EAAQS,GAErC,IAAIC,GAAgBD,EAAOL,GAASD,EAChCO,EAAe,IAAGA,EAAe,GACjCA,EAAe,IAAGA,EAAe,GAGrC,IAAMC,EAAWJ,EAAWG,GAE5BR,EAAKS,GAEDD,EAAe,EACjBF,sBAAsBR,GAEtBxF,GAAQ,SAOT,SAASoG,EAAYjE,GAC1B,IAAM9C,EAAMC,mBAIZ,OAHAc,qBAAU,WACRf,EAAIgB,QAAU8B,IACb,CAACA,IACG9C,EAAIgB,QAgBN,SAASgG,EAAgBC,EAAoBlH,GAClD,IAAImH,GAAU,EAEd,SAASC,IACPF,IACAC,GAAU,EAGZ,SAASE,IACFF,IACHA,GAAU,EAENG,OAAOV,sBACTU,OAAOV,sBAAsBQ,GAE7BG,WAAWH,EAAK,KAKtBpG,qBAAU,WAGR,OAFAsG,OAAOE,iBAAiB,SAAUH,GAE3B,WACLC,OAAOG,oBAAoB,SAAUJ,MAEtCrH,GAGE,IAAM0H,EAAgB,WAC3B,IAAM5H,EAAQwH,OAAOK,WACrB,OAAI7H,EAAQ,IACH,SACEA,EAAQ,KACV,SAEF,WAGF,SAAS8H,IACd,MAAoCxH,mBAASsH,KAA7C,mBAAOG,EAAP,KAAmBC,EAAnB,KAMA,OAJAb,GAAgB,WACda,EAAcJ,OACb,IAEIG,ECnOT,IAqCeE,EArCgCtI,gBAC7C,YAAyD,IAAtDG,EAAqD,EAArDA,UAAWoI,EAA0C,EAA1CA,KAA0C,IAApCC,aAAoC,MAA5B,EAA4B,MAAzBC,eAAyB,MAAf,aAAe,EAC9C7F,EAAuB2F,EAAvB3F,KAAM8F,EAAiBH,EAAjBG,MAAOC,EAAUJ,EAAVI,MAErB,EAAoBC,aAAQ,iBAAO,CACjCC,KAAM,aACNN,WAFOO,EAAT,oBAKMV,EAAaD,IAEnB,OACE,sBACEhI,UAAWmC,IAAGC,IAAOwG,UAAW5I,GAChCsI,QAXgB,SAACO,GAAD,OAAyBP,EAAQO,EAAGT,IAYpD/H,IAAKsI,EACLG,eAAA,qBAA4BV,EAAKW,KAJnC,UAMGV,EAAQ,GACP,cAAC,UAAD,CACEA,MAAOA,EACPW,KAAqB,YAAff,EAA2B,UAAY,UAGjD,cAAC,EAAD,CAAWnI,IAAK0I,EAAOxI,UAAW,OAAQC,IAAKwC,EAAMvC,MAAO,MAC5D,oBAAGF,UAAWmC,IAAGC,IAAOmG,MAAO,sCAA/B,UACE,sBAAMvI,UAAU,OAAhB,SAAwBuI,IACxB,cAAC,eAAD,CAAcG,KAAK,eAErB,mBAAG1I,UAAWmC,IAAGC,IAAO6G,MAAO,+BAA/B,SACGxG,U,iBCEIyG,EAvC4B,SAAC,GAOrC,IANLhJ,EAMI,EANJA,MACAC,EAKI,EALJA,OACAH,EAII,EAJJA,UAII,IAHJmJ,cAGI,aAFJC,cAEI,MAFK,EAEL,MADJC,IAAKC,OACD,MADO,MACP,EACEpH,EAAK,uCACLhC,EAAQ,CAAEA,SAAU,IACpBiJ,EAAS,CAAEhJ,OAAQD,GAAU,IAC7BC,EAAS,CAAEA,UAAW,IAGtBoJ,EAAiBpH,IAAGC,IAAOoH,SAAUxJ,EAAlB,eACtBoC,IAAO+G,OAASA,IAGnB,OAAIC,EAAS,EAET,mCACGK,MAAML,GACJM,KAAK,MACLC,KAAI,SAACvB,EAAMwB,GAAP,OACH,cAACN,EAAD,CAAiBtJ,UAAWuJ,EAAgBrH,MAAK,eAAOA,GAAxD,iBAAU0H,QASlB,cAACN,EAAD,CAAKtJ,UAAWuJ,EAAgBrH,MAAK,eAAOA,GAA5C,mB,QCnCG,SAAS2H,EACdxJ,GAOC,IACGyJ,EADJ,yDAD8B,GAC9B,IALEC,eAKF,MALY,GAKZ,MAJE3J,aAIF,MAJU,GAIV,EAHE4J,EAGF,EAHEA,UACAC,EAEF,EAFEA,UAMAH,EADEC,aAAmBN,MACRM,EAEA,CAACA,GAGhB,IAAMG,EAAkB,WACtB,IAAM5I,EAAKjB,EAAIgB,QAEf,GAAKC,EAAL,CAEA,IAAM6I,EAASL,EAAWM,QAAO,SAACC,EAAKhK,GACrC,IAAMiB,EAAKjB,EAAIgB,QACf,IAAKC,EAAI,OAAO+I,EAChB,IAAMnI,EAAQoI,iBAAiBhJ,GAE/B,OACE+I,EACA/I,EAAGiJ,aACHC,SAAStI,EAAMuI,WACfD,SAAStI,EAAMwI,gBAEhB,GACGC,EAAWV,EAAY,eAAiB,MACtCW,EAAQtJ,EAAGuJ,wBAAXD,IACFE,EAAW,WAAOH,EAAP,cAAqBnF,KAAKC,KAAKmF,EAAMT,GAArC,OAEf7I,EAAGY,MAAM8H,UADPA,EACF,2BAAyCc,EAAzC,qBACEd,EADF,QAGA,uBAAqCc,EAArC,KAEFxJ,EAAGyJ,UAAUC,IAAIC,IAAUC,mBAG7BC,2BAAgB,WAEd,OADAjB,IACO,WACL,IAAM5I,EAAKjB,EAAIgB,QACVC,IACLA,EAAGyJ,UAAUK,OAAOH,IAAUC,iBAC9B5J,EAAGY,MAAM8H,UAAY,OANV,CAQX3J,EAAK2J,EAAWC,EAAWH,GARhB,mBAQ+B1J,KAE9CiH,EAAgB6C,EAAD,CACb7J,EACA2J,EACAC,EACAH,GAJa,mBAKV1J,KChEP,IAAMiL,EAAU,wCACHC,GAAS,CACpBC,YAAY,GAAD,OAAKF,EAAL,gBACXG,OAAO,GAAD,OAAKH,EAAL,WACNI,KAAM,CACJC,MAAM,GAAD,OAAKL,EAAL,eACLM,SAAS,GAAD,OAAKN,EAAL,kBACRO,OAAO,GAAD,OAAKP,EAAL,gBACNQ,MAAM,GAAD,OAAKR,EAAL,eACLS,KAAK,GAAD,OAAKT,EAAL,eAENU,SAAU,CACRC,WAAW,GAAD,OAAKX,EAAL,mBACVY,MAAM,GAAD,OAAKZ,EAAL,2BAIT,SAASa,GAAUC,GACjB,OAAQA,GACN,IAAK,kCACH,MAAO,4JACT,IAAK,wBACH,MAAO,+KACT,QACE,OAAOA,G,SAIEC,G,iFAAf,WAA6CC,GAA7C,eAAAzL,EAAA,6DACM0L,EAAuC,KAD7C,kBAGiBD,EAAIC,OAHrB,OAGIA,EAHJ,iEAMMA,GAASA,EAAKC,QANpB,uBAOID,EAAKE,QAAUN,GAAUI,EAAKE,SACxBF,EARV,WAWOD,EAAII,GAXX,uBAYU,IAAIC,MAAJ,gDAAqBL,EAAIM,SAZnC,WAeOL,EAfP,uBAgBU,IAAII,MAAJ,8HAhBV,iCAmBSJ,GAnBT,0D,+BAsBeM,G,mFAAf,WAAgCC,EAAaC,GAA7C,eAAAlM,EAAA,sEACoBmM,MAAMF,EAAK,CAC3BG,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAUN,KANzB,cACQT,EADR,yBASSD,GAAqBC,IAT9B,4C,sBAYA,SAASgB,GAAT,GAMI,IALFC,EAKC,EALDA,YACAC,EAIC,EAJDA,aAKID,GAEFpK,EAAU,cADVoK,EAAcA,EAAYE,MAAM,WAAW,IAG7CC,aAAaC,QAAQ,eAAgBH,GAGhC,SAAeA,KAAtB,gC,8CAAO,4BAAA3M,EAAA,sEACcgM,GAGhBtB,GAAOG,KAAKI,MAAO,CACpBA,MAAO4B,aAAaE,QAAQ,kBALzB,cAOLN,GANMO,EADD,0BAQEA,GARF,4C,+BAWQC,G,iFAAf,WACEhB,GADF,uCAAAjM,EAAA,8FAEoC,GAFpC,IAEIkM,cAFJ,MAEa,GAFb,MAEiBE,cAFjB,MAE0B,MAF1B,WAKUc,EAAuB,CAC3Bd,SACAC,QAAS,CACP,eAAgB,mBAChBc,cAAe,UAAYvL,EAAU,iBAG1B,QAAXwK,IACFc,EAAQZ,KAAOC,KAAKC,UAAUN,IAbpC,SAgBsBC,MAAMF,EAAKiB,GAhBjC,cAgBUzB,EAhBV,gBAiBiBD,GAAqBC,GAjBtC,6EAmBwB,gBAAhB,KAAIG,QAnBZ,kCAoBYe,KApBZ,iCAqBaM,GAAwBhB,EAAK,CAAEC,SAAQE,YArBpD,8E,sBA4BO,SAAegB,KAAtB,gC,8CAAO,8BAAApN,EAAA,sEACamM,MAAMzB,GAAOC,aAD1B,cACCc,EADD,gBAEcD,GAAuCC,GAFrD,cAECC,EAFD,yBAGEA,EAAKsB,MAHP,4C,sBAMA,SAAeK,KAAtB,gC,8CAAO,wCAAArN,EAAA,6DAA6BsN,EAA7B,+BAA+C,GAA/C,SACQL,GAAoCvC,GAAOE,OAAQ,CAC9DwB,OAAQ,OACRF,OAAQ,CAAEvB,YAAa2C,KAHpB,oF,sBAOA,SAAexC,GAAtB,mC,8CAAO,WAAqBoB,GAArB,eAAAlM,EAAA,sEACcgM,GAIhBtB,GAAOG,KAAKC,MAAOoB,GALjB,cAMLO,GALMO,EADD,0BAOEA,GAPF,4C,sBAUA,SAAehC,KAAtB,gC,8CAAO,4BAAAhL,EAAA,sEACcgM,GAAUtB,GAAOG,KAAKG,OAAQ,CAC/CC,MAAO4B,aAAaE,QAAQ,kBAFzB,cACCC,EADD,OAIL5J,EAAa,eACbyJ,aAAaU,WAAW,gBALnB,kBAMEP,GANF,4C,oEASA,WAAwBd,GAAxB,SAAAlM,EAAA,sEAKQgM,GAAUtB,GAAOG,KAAKE,SAAUmB,GALxC,oF,sBAQA,SAAesB,GAAtB,mC,8CAAO,WAAkCtB,GAAlC,SAAAlM,EAAA,sEACQgM,GAAUtB,GAAOS,SAASC,WAAYc,GAD9C,oF,sBAIA,SAAeuB,GAAtB,mC,8CAAO,WAA6BvB,GAA7B,SAAAlM,EAAA,sEAIQgM,GAAUtB,GAAOS,SAASE,MAAOa,GAJzC,oF,sBAOA,SAAewB,KAAtB,gC,8CAAO,sBAAA1N,EAAA,sEACQiN,GAAkCvC,GAAOG,KAAKK,MADtD,oF,sBAIA,SAAeyC,GAAtB,mC,8CAAO,WAA0BzB,GAA1B,SAAAlM,EAAA,sEAKQiN,GAAkCvC,GAAOG,KAAKK,KAAM,CAC/DkB,OAAQ,QACRF,WAPG,oF,oEAWA,WAA6B0B,GAA7B,iBAAA5N,EAAA,sEACamM,MAAM,GAAD,OAAIzB,GAAOE,OAAX,YAAqBgD,IADvC,cACCnC,EADD,gBAEcD,GAAoCC,GAFlD,cAECC,EAFD,yBAGEA,EAAKd,OAAO,IAHd,4C,sBCzLA,IAAMiD,GACX,0BACWC,GACX,0BACWC,GACX,wBAqBWC,GAA2B,yDAAM,WAAOC,GAAP,eAAAjO,EAAA,6DAC5CiO,EAAS,CACPnG,KAAM+F,KAFoC,kBAKtBT,KALsB,OAKpCE,EALoC,OAM1CW,EAAS,CACPnG,KAAMgG,GACNR,UARwC,gDAW1CW,EAAS,CACPnG,KAAMiG,GACNnC,QAAS,KAAIA,UAb2B,yDAAN,uDCflCsC,GAAa,CACjBC,IAAK,iCACLC,MAAO,iCACPC,KAAM,8CAkLOC,GA/KqB,WAClC,MAAoC1O,mBAAS,OAA7C,mBAAO2O,EAAP,KAAmBC,EAAnB,KAEMP,EAAWrP,IACX6P,EAAWC,cAEjB,EAII5P,GAAY,SAAC6P,GAAD,OAAWA,EAAMhE,eAHxBA,EADT,EACE2C,MACmBsB,EAFrB,EAEEC,kBACcC,EAHhB,EAGEC,aAGF,EAA6CjQ,GAC3C,SAAC6P,GAAD,OAAWA,EAAMK,aADJC,EAAf,EAAQ3B,MAAyB4B,EAAjC,EAAiCA,QAI3BC,EAAiBzP,iBAAyB,MAChDuJ,EAAakG,GAEb,IAAMC,EAAaC,mBACjB,kBACE1E,EAAYnB,QAAO,SAACT,EAAgCvB,GAClD,OAAI0H,GAAW1H,EAAKW,MAAQ+G,EAAQ/G,KAClCY,EAAIvB,EAAKW,KAAO,EACTY,IAGTA,EAAIvB,EAAKW,KAAO8G,EAAiBK,QAC/B,qBAAGnH,MAAkBX,EAAKW,OAC1BoH,OACKxG,KACN,MACL,CAAC4B,EAAasE,EAAkBC,IAGlC3E,2BAAgB,WACa,IAAvBI,EAAY4E,QACdtB,EAASD,QAEV,CAACC,EAAUtD,EAAY4E,SAuB1B/O,qBAAU,WACR,IAAMgP,EAAOL,EAAe1O,QAC5B,GAAK+O,EAAL,CAGA,IAAMjQ,EAASiQ,EAAK7F,aACdhJ,EAAW,IAAIC,sBACnB,SAACC,EAASF,GACRE,EAAQC,SAAQ,SAACC,GAEf,GAAIA,EAAMC,eAAgB,CACxB,IAAMyO,EAAU1O,EAAM2O,OACtBlB,EAAciB,EAAQE,QAAQC,OAAS,aAI7C,CACEJ,OACAK,WAAW,cAAD,OAAgB,IAAMtQ,EAAtB,YAIRuQ,EAAWN,EAAKO,iBAAiB,gBAGvC,OAFAD,EAAShP,SAAQ,SAAC2O,GAAD,OAAa9O,EAASQ,QAAQsO,MAExC,kBAAMK,EAAShP,SAAQ,SAAC2O,GAAD,OAAa9O,EAASS,UAAUqO,UAC7D,CAAC9E,IAEJ,IAAM/B,EAAWyG,mBACf,kBACE,oBACEjQ,UAAWmC,IAAGC,IAAOmJ,YAAa,SAClCzC,eAAa,uBAFf,SAIE,+BACE,cAAC,EAAD,CAAU5I,MAAO,IAAKF,UAAU,+BAChC,qBAAKA,UAAWmC,IAAGC,IAAOwO,eAAgB,uBAA1C,SACE,cAAC,EAAD,CACEzQ,OAAQ,IACRiJ,OAAQ,EACRpJ,UAAWmC,IAAGC,IAAOyO,WAAY,wBAM3C,IAGF,OACE,0BAAS7Q,UAAWmC,IAAGC,IAAOwG,WAA9B,UACE,oBAAI5I,UAAWmC,IAAG,4BAA6BC,IAAO6G,OAAtD,mGAGA,yBAASjJ,UAAWoC,IAAO0O,KAA3B,SACGC,OAAOtP,QAAQqN,IAAYnF,KAAI,YAAmB,IAAD,mBAAhBqH,EAAgB,KAAX7N,EAAW,KAChD,OACE,cAAC,MAAD,CAEEA,MAAO6N,EACPC,OAAQD,IAAQ7B,EAChB7G,QAAS,kBAlFM,SAAC4I,GAC1B,IAAM5P,EAAKyO,EAAe1O,QAE1B,GAAKC,EAAL,CAIA,IAAM+O,EAA8B/O,EAAG6P,cAAH,uBAClBD,EADkB,OAG9BE,EAAc9P,EAAG+P,UACjBC,GAAmB,OAAPjB,QAAO,IAAPA,OAAA,EAAAA,EAASkB,YAAa,EAExC/K,EAAQ,CACNE,KADM,SACDS,GACH7F,EAAG+P,UAAYD,GAAeE,EAAYF,GAAejK,GAE3DR,SAAU,OAiEa6K,CAAmBR,IAJpC,SAMG7N,GALI6N,QAUZxB,GACC,oBAAGxP,UAAWmC,IAAGC,IAAOoN,MAAO,qCAA/B,+QACwDA,KAGzDE,GAAWlG,EACZ,oBAAIxJ,UAAWmC,IAAGC,IAAOmJ,YAAa,SAAUlL,IAAK0P,EAArD,SACGE,mBACC,kBACE1E,EAAY4E,OAAS,GACrBY,OAAOtP,QAAQqN,IAAYnF,KAAI,YAAmB,IAAD,mBAAhBqH,EAAgB,KAAX7N,EAAW,KAC/C,OACE,qBAAcsO,aAAYT,EAA1B,UACE,oBAAIhR,UAAU,6BAAd,SAA4CmD,IAC5C,oBAAInD,UAAWmC,IAAGC,IAAOwO,gBAAzB,SACGrF,EACE2E,QAAO,qBAAGxH,OAAoBsI,KAC9BrH,KAAI,SAACvB,EAAMwB,GACV,OACE,oBAAI5J,UAAWmC,IAAGC,IAAOyO,YAAzB,SACE,cAAC,IAAD,CACEa,GAAI,CACFC,SAAS,gBAAD,OAAkBvJ,EAAKW,KAC/B6I,MAAO,CAAEC,WAAYxC,IAHzB,SAME,cAAC,EAAD,CACEhH,MAAO2H,EAAW5H,EAAKW,KACvBX,KAAMA,OAT+BA,EAAKW,YAPjDiI,QA0Bf,CAAC3B,EAAU9D,EAAayE,U,UC7LnB,OAA0B,iC,oBCgC1B8B,GAvBoC,SAAC,GAAqB,IAAnBC,EAAkB,EAAlBA,YACpD,OACE,sBAAK/R,UAAWmC,IAAGC,KAAOwG,UAAW,qBAArC,UACE,oBAAI5I,UAAWmC,IAAGC,KAAO6G,MAAO,yCAAhC,SACG8I,IAEH,mBAAG/R,UAAU,mCAAb,iIACA,qBACEE,MAAM,MACNC,OAAO,MACPL,IAAKkS,GACL/R,IAAI,8HAEN,mBAAGD,UAAU,yCAAb,qJAGA,mBAAGA,UAAU,kDAAb,gQ,wCCLSiS,GAZoC,SAAC,GAG7C,IAAD,IAFJC,eAEI,aADJC,eACI,MADM,aACN,EACJ,OACE,qBACEnS,UAAWmC,IAAGC,KAAOwG,UAAR,eAAsBxG,KAAOgQ,QAAUF,IACpD5J,QAAS6J,KCNTE,GAAY1P,SAAS2P,eAAe,gBAGpCC,GAAqD,GAmE5CC,GA3DsB3S,gBACnC,YAA0D,IAAvD4S,EAAsD,EAAtDA,SAAsD,IAA5CC,cAA4C,MAAnC,GAAmC,MAA/BR,eAA+B,SAAdC,EAAc,EAAdA,QACnCQ,EAAQrS,mBACRsS,IAAiBT,EAgCvB,OA9BA/Q,qBAAU,WACR,GAAI8Q,EACFK,GAAcM,KAAKF,OACd,CACL,IAAM/I,EAAQ2I,GAAcO,QAAQH,GACpCJ,GAAcQ,OAAOnJ,EAAO,MAE7B,CAACsI,IAGJ9Q,qBAAU,WACR,IAAM4R,EAAiB,SAACnK,GA1Bd,WA4BNA,EAAEmI,KACFuB,GAAcA,GAAcpC,OAAS,KAAOwC,GAC5CR,GAEAA,KAQJ,OAJID,GACFvP,SAASiF,iBAAiB,UAAWoL,GAGhC,WACLrQ,SAASkF,oBAAoB,UAAWmL,MAEzC,CAACb,EAASD,IAENe,uBACL,qCACE,cAAC,GAAD,CAAcf,QAASA,EAASC,QAASA,IACzC,sBACEnS,UAAWmC,IAAGC,KAAOwG,UAAW,0BAAnB,eACVxG,KAAOgQ,QAAUF,IAFtB,UAKE,oBAAIlS,UAAWmC,IAAGC,KAAO6G,MAAO,kCAAhC,SACGyJ,IAEFE,GACC,qBAAK5S,UAAWoC,KAAO8Q,YAAvB,SACE,cAAC,YAAD,CAAWxK,KAAK,UAAUJ,QAAS6J,MAGvC,yBAASnS,UAAWmC,IAAGC,KAAO+Q,SAA9B,SAAyCV,UAG7CJ,O,oBCjCSe,GA9B0B,SAAC,GAKnC,IAAD,IAJJpK,YAII,MAJG,GAIH,MAHJqK,cAGI,MAHK,EAGL,EAFJrT,EAEI,EAFJA,UAEI,IADJsT,cACI,SACEC,EAAS,GAAMvK,EAErB,OACE,qBACEhJ,UAAWmC,IACTC,KAAOoR,QADI,eAERpR,KAAOqR,cAAgBH,GAC1BtT,GAEFkC,MAAO,CAAEhC,MAAO8I,EAAM7I,OAAQ6I,GAC9B0K,QAAO,cAAS1K,EAAT,YAAiBA,GAP1B,SASE,wBACEhJ,UAAWoC,KAAO+G,OAClBwK,GAAI3K,EAAO,EACX4K,GAAI5K,EAAO,EACX6K,EAAGN,EACH7J,KAAK,OACLoK,YAAaT,OCjCRU,GACX,6BACWC,GACX,gCACWC,GACX,kCACWC,GAAyC,oB,oBC8HvCC,GA9GkC,SAAC,GAI3C,IAAD,IAHJ/L,EAGI,EAHJA,KACAwB,EAEI,EAFJA,MAEI,IADJwK,gBACI,MADO,aACP,EACEvF,EAAWrP,cACXa,EAAMC,iBAAsB,MAClC,EAAkCE,oBAAS,GAA3C,mBAAO6T,EAAP,KAAmBC,EAAnB,KACA,EAAsC9T,oBAAS,GAA/C,mBAAO+T,EAAP,KAAqBC,EAArB,KAEMC,EAAO,UAAGpU,EAAIgB,eAAP,aAAG,EAAa8P,cAAc,wBAE3C/P,qBAAU,WACR,IAAME,EAAKjB,EAAIgB,QACVC,IAGLA,EAAGY,MAAMwS,QAAU,IACnBlO,EAAQ,CACNE,KADM,SACDS,GACH7F,EAAGY,MAAMwS,QAAT,UAAsBvN,IAExBR,SAAU,IACVF,OAAQ,eAET,IAEH,MAAoCgC,YAAQ,CAC1CC,KAAM,kBACNN,KAAK,SAAD,mGAAC,EAAC,WACJ,MAAO,CAAEoG,GAAIpG,EAAKW,IAAKa,YAEzB+K,QAAS,SAACC,GAAD,MAAc,CACrBC,OAAQD,EAAQE,iBANpB,mBAASD,EAAT,KAASA,OAAUE,EAAnB,KAUA,EAA6CC,aAAQ,CACnDC,OAAQ,kBACRC,KAFmD,SAE9C9M,GACH,IAAM+M,EAAavL,GAASyK,EAAa,EAAI,GACvCe,EAAYhN,EAAKwB,MACvB4K,GAAc,GAEVY,IAAcD,IAIlBtG,EAAS,CACPnG,KAAMuL,GACNmB,YACAD,eAEF/M,EAAKwB,MAAQuL,IAEfE,MAlBmD,SAkB7CjN,EAAMwM,GACV,GAAKH,EAAL,CACAD,GAAc,GACd,IAAMc,EAAab,EAAQ5J,wBACrB0K,EAASX,EAAQY,yBAA2B,CAAEC,EAAG,GACvDnB,EAAYiB,EAAOE,GAAKH,EAAWG,KAErCd,QAAS,SAACC,GAAD,MAAc,CACrBc,OAAQd,EAAQc,SAChBC,QAASf,EAAQe,cA3BrB,0BAASD,EAAT,EAASA,OAAQC,EAAjB,EAAiBA,QAAWC,EAA5B,KA+BMC,EAAazO,EAAYyN,GAGzBiB,EAFa1O,EAAYsO,KAEEA,EAC3BK,EAAYF,IAAehB,EAE3B1U,GAAS,UAAAE,EAAIgB,eAAJ,eAAawJ,wBAAwB1K,SAAU,EAE9D4U,EAAca,EAAcvV,IAE5B,IAAM4H,EAAaD,IACbgO,EAAyB,YAAf/N,EAA2B,GAAK,EAC1CgO,EAA2B,YAAfhO,EAA2B,GAAK,GAElD,OACE,qBACEjI,UAAWmC,IAAGC,KAAOwG,WACrBvI,IAAKA,EACL6B,MAAO,CACLwS,QAASG,EAAS,EAAI,EACtBqB,QAASH,GAAaJ,EAAU,OAAS,GACzClL,UAAWoK,GAAUiB,GAAa3V,EAAS,EAC3CgW,cACGtB,IAAUa,GAAWrB,EAAuC2B,EAA1BC,EAAsB,EAAVD,EACjDI,YAAavB,GAAUa,GAAUrB,EAAa4B,EAAYD,EAAU,EACpEK,mBAAoB9B,EAAe,OAAS,MAE9CzL,eAAA,mBAA0BV,EAAKW,KAZjC,UAcE,mBAAG/I,UAAWmC,IAAGC,KAAOkU,UAAxB,SACE,cAAC,WAAD,CAAU5N,KAAK,cAEjB,cAAC,qBAAD,CACE6N,KAAMnO,EAAK3F,KACX8F,MAAOH,EAAKG,MACZiO,UAAWpO,EAAKI,MAChBiO,YAAa,kBAAMrC,EAAShM,EAAM/H,UC7H7BqW,GACX,yBACWC,GACX,yBACWC,GACX,uBACWC,GAA6B,c,oBC4M3BC,GAvLqB,WAAO,IAAD,EACxC,EAAsCtW,oBAAS,GAA/C,mBAAOuW,EAAP,KAAqBC,EAArB,KAEA,EAAuCtX,GACrC,SAAC6P,GAAD,OAAWA,EAAMK,aADXE,EAAR,EAAQA,QAAS5B,EAAjB,EAAiBA,MAAO+I,EAAxB,EAAwBA,WAIxB,EAIIvX,GAAY,SAAC6P,GAAD,OAAWA,EAAM2H,SAHvBnF,EADV,EACEoF,OACiBC,EAFnB,EAEEC,gBACsBC,EAHxB,EAGEC,qBAGI1I,EAAWrP,IAEXgY,EAAkBC,uBACtB,SAACrP,EAA8B/H,GAC7B,IAAMiB,EAAKjB,EAAIgB,QACf,GAAKC,EAAL,CAGA,IAAMnB,EAASmB,EAAGiJ,aAClBjJ,EAAGY,MAAMwV,OAAS,KAClBlR,EAAQ,CACNE,KADM,SACDS,GACH7F,EAAGY,MAAMwS,QAAT,UAAsB,EAAIvN,GAC1B7F,EAAGY,MAAMuI,UAAT,WAAyBtK,EAASgH,EAAlC,OAEFR,SAAU,IACVF,OAAQ,YACP5E,MAAK,kBAAMgN,EAAS,CAAEnG,KAAMsL,GAA+B5L,eAEhE,CAACyG,IAGG8I,EAAoBF,uBAAY,WACpCT,GAAc,GACVjF,IACFlD,EAAS,CAAEnG,KAAMwL,KACjBrF,EAAS,CAAEnG,KAAMmO,QAElB,CAAChI,EAAUkD,IAOd,MAAkDiD,cAChD,iBAAO,CACLC,OAAQ,aACRC,KAFK,SAEA9M,EAAMwM,GACT/F,EAAS,CAAEnG,KAAMqL,GAA4B3L,UAE/CuM,QAAS,SAACC,GAAD,MAAc,CACrBc,OAAQd,EAAQc,SAChBkC,QAAShD,EAAQgD,eAGrB,CAAC/I,IAXH,0BAAS6G,EAAT,EAASA,OAAQkC,EAAjB,EAAiBA,QAAWC,EAA5B,KAcMC,EAAUxX,iBAAyB,MACnCyX,EAAezX,iBAAsB,MACrC0X,EAAY1X,iBAAoB,MACtCuJ,EAAaiO,EAAS,CACpB/N,QAAS,CAACgO,EAAcC,GACxB5X,MAAO,CAAC0P,EAA0B,IAAjB5B,EAAMiC,UAGzB,IAAM8H,EAAUC,cACVjQ,EAAaD,IAEnB,MAAmB,kBAAfsP,GACFzI,EAAS,CACPnG,KAAMkO,GACNpK,QAAS,KAEXyL,EAAQlV,QAAQ,UACT,MAIP,sBACE/C,UAAWmC,IAAGC,KAAOwG,WACrBvI,IAAKwX,EACL/O,eAAa,wBAHf,UAKE,qBAAI9I,UAAWoC,KAAO+V,SAAtB,WACIrI,IAAY5B,EAAMiC,QAClB,oBACEnQ,UAAWmC,IACTC,KAAOgW,YACP,0CAFW,mBAIRhW,KAAOiW,gBAAkB3C,GAJjB,qCAKakC,GALb,IADf,sKAaD9H,GACC,oBAAI9P,UAAWoC,KAAOkW,cAAexP,eAAa,cAAlD,SACE,cAAC,qBAAD,CACEJ,KAAK,MACL6P,UAAU,EACVhC,KAAI,UAAKzG,EAAQrN,KAAb,+BACJ8F,MAAOuH,EAAQvH,MACfiO,UAAW1G,EAAQtH,UAIzB,6BACE,oBAAIxI,UAAWmC,IAAGC,KAAOoW,eAAgB,YAAanY,IAAKyX,EAA3D,SACG5J,EAAMvE,KAAI,SAACrI,EAAIsI,GACd,OACE,cAAC,GAAD,CAEExB,KAAM9G,EACNsI,MAAOA,EACPwK,SAAUoD,GAHLlW,EAAG0P,YASjBlB,GACC,oBACE9P,UAAWoC,KAAOqW,iBAClBpY,IAAK0X,EACLjP,eAAa,iBAHf,SAKE,cAAC,qBAAD,CACEJ,KAAK,SACL6P,UAAU,EACVhC,KAAI,UAAKzG,EAAQrN,KAAb,yBACJ8F,MAAOuH,EAAQvH,MACfiO,UAAW1G,EAAQtH,aAK3B,yBAAQxI,UAAWmC,IAAGC,KAAOsW,QAASrY,IAAK2X,EAA3C,UACE,mBAAGhY,UAAU,oCAAb,SAAkDiX,IAClD,mBAAGjX,UAAWmC,IAAG,OAAQC,KAAOuW,gBAAhC,SACE,cAAC,eAAD,CAAcjQ,KAAK,cAErB,cAAC,SAAD,CACEA,KAAK,UACLM,KAAqB,YAAff,EAA2B,QAAU,QAC3CK,QA7GR,WACE0O,GAAc,GACdnI,EDvCF,uCAAM,WAAOA,EAAuB+J,GAA9B,uBAAAhY,EAAA,2DACuBgY,IAAWhJ,UAA9BE,EADJ,EACIA,QAAS5B,EADb,EACaA,MAEZ4B,EAHD,yCAIKjB,EAAS,CACdnG,KAAMkO,GACNpK,QAAS,2MANT,cAUEqM,EAVF,CAUS/I,EAAQ/G,KAVjB,mBAUyBmF,EAAMvE,KAAI,SAACrI,GAAD,OAAQA,EAAGyH,SAElD8F,EAAS,CACPnG,KAAMgO,KAbJ,kBAgBiBzI,GAAc4K,GAhB/B,OAgBIjL,EAhBJ,OAiBFiB,EAAS,CACPnG,KAAMiO,GACNQ,OAAQvJ,EAAKsJ,MAAMC,SAnBnB,kDAsBFtI,EAAS,CACPnG,KAAMkO,GACNpK,QAAS,KAAIA,UAxBb,0DAAN,0DC+IM,gGAQF,cAAC,GAAD,CACEkG,OAAQ4E,GAAc,uCACtBpF,QAAS6E,EACT5E,QAASiF,OAAenU,EAAY0U,EAHtC,SAKE,qCACGP,GACC,sBAAKpX,UAAWoC,KAAOkR,OAAvB,UACE,mBAAGtT,UAAU,gDAAb,sGAGA,cAAC,GAAD,CAASA,UAAU,aAGtBsX,GACC,mBAAGtX,UAAWmC,IAAG,mCAAoCC,KAAOoN,OAA5D,SACG8H,IAGJvF,GAAe,cAAC,GAAD,CAAcA,YAAaA,aCrM9C,SAAS+G,KACd,OACE,eAACC,EAAA,EAAD,CAAaC,QhBmLb,iBAAkBtR,QAClBuR,UAAUC,eAAiB,GAC3BD,UAAUE,iBAAmB,EgBrLWC,IAAeC,IAAvD,UACE,cAAC,GAAD,IACA,cAAC,GAAD,O,WCyBSC,GA5BsC,SAAC,GAAkB,IAAblZ,EAAY,oBACrE,EAAwCI,oBAAS,GAAjD,mBAAO+Y,EAAP,KAAsBC,EAAtB,KACMC,EAAWnZ,iBAAyB,MAEpCoZ,EAAkBjC,uBAAY,WAClC+B,GAAgBD,GAChB,IAAMjY,EAAKmY,EAASpY,QACpB,GAAKC,EAAL,CAGA,IAAMqY,EAAMrY,EAAGsY,eACfjS,YAAW,WACTrG,EAAGuY,QACHvY,EAAGwY,kBAAkBH,GAAOrY,EAAG6B,MAAMgN,OAAQwJ,GAAOrY,EAAG6B,MAAMgN,UAC5D,MACF,CAACoJ,IAEJ,OACE,cAAC,QAAD,2BACMnZ,GADN,IAEEC,IAAKoZ,EACL/Q,KAAM6Q,EAAgB,WAAa,OACnCQ,KAAMR,EAAgB,WAAa,WACnCS,YAAaN,MC/BbO,GACJ,wJA2BIC,GAAoC,CACxCC,SAAU,YAA8C,IAA3ChX,EAA0C,EAA1CA,MAA0C,IAAnCqJ,eAAmC,MAAzB,8FAAyB,EACrD,OAAOrJ,GAASA,EAAMgN,OAAS,EAAI,GAAK3D,GAE1C4N,MAAO,YAAsD,IAAnDjX,EAAkD,EAAlDA,MAAkD,IAA3CqJ,eAA2C,MAAjC,gHAAiC,EAC1D,OAAOyN,GAAYI,KAAKC,OAAOnX,GAAOoX,eAAiB,GAAK/N,GAE9DgO,UAAW,YAAmE,IAAhErX,EAA+D,EAA/DA,MAA+D,IAAxDsX,aAAwD,MAAhD,EAAgD,EAA7CjO,EAA6C,EAA7CA,QAE9B,OADAA,EAAUA,GAAO,iGAAwBiO,EAAxB,qDACVtX,EAAMgN,QAAUsK,GAA0B,IAAjBtX,EAAMgN,OAAe,GAAK3D,IAU9D,SAASkO,GAASvX,EAAewX,GAC/B,OAAKA,GAEY5J,OAAOtP,QAAQkZ,GAAOhR,KAAI,YAA4B,IAAD,mBAAzBiR,EAAyB,KAAfC,EAAe,KACpE,OAAKA,EACEX,GAAgBU,GAAhB,aACLzX,QACAsX,MAA4B,kBAAdI,EAAyBA,EAAUJ,MAAQI,GAChC,kBAAdA,EAAyB,CAAErO,QAASqO,EAAUrO,SAAY,KAJhD,MAQT0D,QAAO,SAAC1D,GAAD,QAAeA,KAAS,IAX5B,GAoBrB,SAASsO,GACPC,EACAJ,GAGA,IADA,IAAMK,EAAqC,GAC3C,MAAmBjK,OAAOkK,KAAKF,GAA/B,eAAwC,CAAnC,IAAMtY,EAAI,KACbuY,EAAOvY,GAAQiY,GAASK,EAAOtY,GAAOkY,EAAMlY,IAG9C,OAAOuY,EAgBF,SAASE,GAAT,GAIH,IAHFC,EAGC,EAHDA,SAIA,EAA4B3a,mBAAoC,IAAhE,mBAAOua,EAAP,KAAeK,EAAf,KACA,EAAoC5a,mBAAoC,IAAxE,mBAAO6a,EAAP,KAAmBC,EAAnB,KACA,EAAwB9a,mBAAuB,MAA/C,mBAAOoN,EAAP,KAAa2N,EAAb,KACA,EAA0B/a,mBAAS,IAAnC,mBAAOgP,EAAP,KAAcgM,EAAd,KACA,EAA8Bhb,oBAAS,GAAvC,mBAAOkP,EAAP,KAAgB+L,EAAhB,KACMC,EAAcpb,iBAAqB,MACnCqb,EAAWrb,iBAAkD,IAEnEc,qBAAU,WACRsa,EAAYra,QAAUuM,KAGxB,IAAMgO,EAAe,SAAC/S,GACpB,IAAMpG,EAAOoG,EAAEyH,OAAO7N,KAChBU,EAAQ0F,EAAEyH,OAAOnN,MACjBwX,EAAQgB,EAASta,QAEvB+Z,EAAU,2BACLL,GADI,kBAENtY,EAAOU,KAGVmY,EAAc,2BACTD,GADQ,kBAEV5Y,EAAOiY,GAASvX,EAAOwX,EAAMlY,QA6DlC,MAAO,CACLoZ,aA1DgB,uCAAG,WAAOhT,GAAP,mBAAAjI,EAAA,yDACnBiI,EAAEiT,iBACInB,EAAQgB,EAASta,SAEnBqO,EAJe,oDAMbsL,EAASF,GAAYC,EAAQJ,GACnCW,EAAcN,IAEVjK,OAAOgK,OAAOC,GAAQe,MAAK,SAACvM,GAAD,OAAWA,KATvB,wDAanB+L,EAAQ,MACRE,GAAW,GAdQ,oBAiBCN,EAASJ,GAjBV,QAiBX1O,EAjBW,OAkBjBmP,EAAS,IACTD,EAAQlP,GAnBS,mDAqBjBmP,EAAS,KAAIhP,SArBI,yBAuBjBiP,GAAW,GAvBM,8EAAH,sDA2DhB7N,OACAoO,YAAapO,IAAS8N,EAAYra,QAClCmO,QACAE,UACAqL,SACAK,YACAzP,SAtCe,SACflJ,GAQI,IAAD,yDADC,GACD,IANDU,aAMC,MANO,GAMP,EALDuX,EAKC,EALDA,SAiBF,OAXMjY,KAAQsY,GACZK,EAAU,2BACLL,GADI,kBAENtY,EAAOU,KAIRuX,KAAcjY,KAAQkZ,EAASta,WACjCsa,EAASta,QAAQoB,GAAQiY,GAGpB,CACLjY,OACAU,MAAO4X,EAAOtY,IAAS,GACvBwZ,SAAUL,EACVpM,QAAS6L,EAAW5Y,GACpByZ,UAAWb,EAAW5Y,MCjLrB,IAAM0Z,GAAuC,mBACvCC,GAAuC,mBACvCC,GAAmC,iBACnCC,GAAuB,WACvBC,GAA2B,aCHjC,SAASC,KACd,MAA6D9c,GAC3D,SAAC6P,GAAD,OAAWA,EAAMzD,QADXA,EAAR,EAAQA,KAAM2Q,EAAd,EAAcA,YAAaC,EAA3B,EAA2BA,YAAaC,EAAxC,EAAwCA,iBAGlCC,EAAaF,KAAiBC,EAC9B9N,EAAWrP,IAEjB4B,qBAAU,WACHqb,GAAgBG,GACnB/N,ED2BJ,uCAAM,WAAOA,EAAuB+J,GAA9B,eAAAhY,EAAA,6DACJiO,EAAS,CACPnG,KAAMyT,KAFJ,kBAKiB7N,KALjB,OAKIV,EALJ,OAMFiB,EAAS,CACPnG,KAAM0T,GACNtQ,KAAM8B,EAAK9B,OARX,gDAWF+C,EAAS,CACPnG,KAAM2T,GACN7P,QAAS,KAAIA,UAbb,yDAAN,2DCzBG,CAACqC,EAAU+N,EAAYH,IAE1B,IAAMI,EAASpF,sBAAW,uCACxB,WAAO3K,GAAP,eAAAlM,EAAA,sEACqB8K,GAAMoB,GAD3B,cACQc,EADR,OAEEiB,EAAS,CAAEnG,KAAM4T,GAAUxQ,KAAM8B,EAAK9B,OAFxC,kBAGS8B,GAHT,2CADwB,sDAMxB,CAACiB,IAGGiO,EAAUrF,sBAAW,sBAAC,sBAAA7W,EAAA,sEACpBgL,KADoB,OAE1BiD,EAAS,CAAEnG,KAAM6T,KAFS,2CAGzB,CAAC1N,IAEJ,MAAO,CACL/C,OACA8Q,aACAC,SACAC,W,wBCtBG,SAASC,KACd,IAcU,EAdV,EAAqCP,KAA7B1Q,EAAR,EAAQA,KAAM8Q,EAAd,EAAcA,WAAYC,EAA1B,EAA0BA,OACpBxN,EAAWC,cACjB,EAAyD4L,GAAc,CACrEC,SAAU0B,IADJjP,EAAR,EAAQA,KAAM8B,EAAd,EAAcA,QAASF,EAAvB,EAAuBA,MAAO7D,EAA9B,EAA8BA,SAAUkQ,EAAxC,EAAwCA,aAIxC,OAAKe,GAIAlN,GAAW5D,EACP,cAAC,IAAD,CAAU4F,GAAG,MAGlB9D,EACK,cAAC,IAAD,CAAU8D,IAAI,UAAArC,EAASuC,aAAT,eAAgBoL,OAAQ,MAI7C,uBAAMhd,UAAWoC,KAAOwG,UAAWuS,SAAUU,EAA7C,UACE,oBAAI7b,UAAU,kCAAd,sCACCwP,GACC,mBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,oCAA/B,SACGA,IAGL,qBAAKxP,UAAU,OAAf,SACE,cAAC,QAAD,yBACE0I,KAAK,QACLuU,YAAY,UACRtR,EAAS,QAAS,CAAE+O,SAAU,CAAEP,UAAU,EAAMC,OAAO,MAH7D,IAIE8C,SAAUxN,OAGd,qBAAK1P,UAAU,OAAf,SACE,cAAC,GAAD,yBACEid,YAAY,wCACRtR,EAAS,WAAY,CACvB+O,SAAU,CAAEP,UAAU,EAAMK,UAAW,MAH3C,IAKE0C,SAAUxN,OAGd,qBAAK1P,UAAU,QAAf,SACE,cAAC,SAAD,+CAEF,oBAAGA,UAAU,uDAAb,mIACyB,cAAC,IAAD,CAAM0R,GAAG,YAAT,6HAEzB,oBAAG1R,UAAU,kDAAb,wFACiB,cAAC,IAAD,CAAM0R,GAAG,mBAAT,iIA3CZ,K,wBCRJ,SAASyL,KACd,MAAyDjC,GAAc,CACrEC,SAAU,SAACrO,GAAD,OlB2IP,SAAP,mCkB3I0BsQ,CAAatQ,MAD7Bc,EAAR,EAAQA,KAAM8B,EAAd,EAAcA,QAASF,EAAvB,EAAuBA,MAAO7D,EAA9B,EAA8BA,SAAUkQ,EAAxC,EAAwCA,aAIxC,OAAIjO,EAEA,uBAAM5N,UAAWoC,KAAOwG,UAAxB,UACE,oBAAI5I,UAAU,kCAAd,gFACA,oBAAGA,UAAU,+BAAb,6KACgC,cAAC,IAAD,CAAM0R,GAAG,SAAT,kDAOpC,uBAAM1R,UAAWoC,KAAOwG,UAAWuS,SAAUU,EAA7C,UACE,oBAAI7b,UAAU,kCAAd,gFACCwP,GACC,mBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,oCAA/B,SACGA,IAGL,qBAAKxP,UAAU,OAAf,SACE,cAAC,QAAD,yBACE0I,KAAK,OACLuU,YAAY,sBACRtR,EAAS,OAAQ,CAAE+O,SAAU,CAAEP,UAAU,EAAMK,UAAW,MAHhE,IAIE0C,SAAUxN,OAGd,qBAAK1P,UAAU,OAAf,SACE,cAAC,QAAD,yBACE0I,KAAK,QACLuU,YAAY,UACRtR,EAAS,QAAS,CAAE+O,SAAU,CAAEP,UAAU,EAAMC,OAAO,MAH7D,IAIE8C,SAAUxN,OAGd,qBAAK1P,UAAU,OAAf,SACE,cAAC,GAAD,yBACEid,YAAY,wCACRtR,EAAS,WAAY,CACvB+O,SAAU,CAAEP,UAAU,EAAMK,UAAW,MAH3C,IAKE0C,SAAUxN,OAGd,qBAAK1P,UAAU,QAAf,SACE,cAAC,SAAD,6HAEF,oBAAGA,UAAU,kDAAb,4HACuB,cAAC,IAAD,CAAM0R,GAAG,SAAT,kD,wBCvDtB,SAAS2L,KACd,MACEnC,GAAc,CACZC,SAAU/M,KAFNR,EAAR,EAAQA,KAAM8B,EAAd,EAAcA,QAASF,EAAvB,EAAuBA,MAAO7D,EAA9B,EAA8BA,SAAUoP,EAAxC,EAAwCA,OAAQc,EAAhD,EAAgDA,aAKhD,OAAIjO,EAEA,cAAC,IAAD,CACE8D,GAAI,CACFC,SAAU,kBACVC,MAAO,CAAEwI,MAAOW,EAAOX,UAO7B,uBAAMpa,UAAWoC,KAAOwG,UAAWuS,SAAUU,EAA7C,UACE,oBAAI7b,UAAU,kCAAd,uIACCwP,GACC,mBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,oCAA/B,SACGA,IAGL,qBAAKxP,UAAU,OAAf,SACE,cAAC,QAAD,yBACE0I,KAAK,QACLuU,YAAY,qDACRtR,EAAS,QAAS,CAAE+O,SAAU,CAAEP,UAAU,EAAMC,OAAO,MAH7D,IAIE8C,SAAUxN,OAGd,qBAAK1P,UAAU,QAAf,SACE,cAAC,SAAD,yFAEF,oBAAGA,UAAU,kDAAb,0GACoB,cAAC,IAAD,CAAM0R,GAAG,SAAT,kD,wBCpCnB,SAAS4L,KAAqB,IAAD,EAC5BjO,EAAWC,cACjB,EAAyD4L,GAAc,CACrEC,SAAU9M,KADJT,EAAR,EAAQA,KAAM8B,EAAd,EAAcA,QAASF,EAAvB,EAAuBA,MAAO7D,EAA9B,EAA8BA,SAAUkQ,EAAxC,EAAwCA,aAIxC,OAAI,UAACxM,EAASuC,aAAV,aAAC,EAAgBwI,OAIjBxM,EAEA,uBAAM5N,UAAWoC,KAAOwG,UAAxB,UACE,oBAAI5I,UAAU,kCAAd,uIAGA,oBAAGA,UAAU,+BAAb,yIAC0B,cAAC,IAAD,CAAM0R,GAAG,SAAT,kDAO9B,uBAAM1R,UAAWoC,KAAOwG,UAAWuS,SAAUU,EAA7C,UACE,oBAAI7b,UAAU,kCAAd,uIACCwP,GACC,mBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,oCAA/B,SACGA,IAGL,qBAAKxP,UAAU,OAAf,SACE,cAAC,GAAD,yBACEid,YAAY,kHACRtR,EAAS,WAAY,CACvB+O,SAAU,CAAEP,UAAU,EAAMK,UAAW,MAH3C,IAKE0C,SAAUxN,OAGd,qBAAK1P,UAAU,OAAf,SACE,cAAC,QAAD,yBACE0I,KAAK,OACLuU,YAAY,mHACRtR,EAAS,QAAS,CACpB+O,SAAU,CAAEP,UAAU,EAAMK,UAAW,OAJ3C,IAME0C,SAAUxN,OAGd,qBAAK1P,UAAU,QAAf,SACE,cAAC,SAAD,uEAEF,oBAAGA,UAAU,kDAAb,0GACoB,cAAC,IAAD,CAAM0R,GAAG,SAAT,kDA/Cf,cAAC,IAAD,CAAUA,GAAG,qB,WCgCT6L,GAzC8B,SAAC,GAA4B,IAA1BC,EAAyB,EAAzBA,SAAapd,EAAY,4BACvE,EAAkCI,oBAAS,GAA3C,mBAAOid,EAAP,KAAmBC,EAAnB,KACMjE,EAAWnZ,iBAAyB,MACtCqd,GAAY,EA0BhB,OACE,cAAC,QAAD,2BACMvd,GADN,IAEEC,IAAKoZ,EACLM,KAAM0D,EAAa,YAAc,WACjCzD,YA7BoB,SAACnR,GACvB,IAAMvH,EAAKmY,EAASpY,QACpBsc,GAAY,EACRF,GAAcnc,GAChBkc,EAAS,IACTlc,EAAGuY,SACMvY,IACToc,GAAY,GACZ/V,YAAW,WACTrG,EAAGuY,UACF,KAoBH+D,OAhBe,SAAC/U,GAClBlB,YAAW,WACLgW,EACFA,GAAY,EAGdD,GAAY,KACX,MAUDR,SAAU9c,EAAM8c,WAAaO,M,oBC8EpBI,GA/Ge,WAC5B,IAAMhP,EAAWrP,cACTsM,EAAS0Q,KAAT1Q,KACR,EASIoP,GAAc,CAChBC,SAAU5M,KATVX,EADF,EACEA,KACAoO,EAFF,EAEEA,YACAtM,EAHF,EAGEA,QACAF,EAJF,EAIEA,MACA7D,EALF,EAKEA,SACAoP,EANF,EAMEA,OACAK,EAPF,EAOEA,UACAS,EARF,EAQEA,aAKI5T,EAAaD,IAEnB,IAAK8D,EACH,OAAO,KAGT,IAAMgS,GAAiB7Z,EAAQ,2BAAK6H,GAAN,IAAYC,SAAU,KAAMgP,GAEpDgD,EAAiB,SAACtb,GACtB,OAAO,SAACU,GAAD,OAAmBiY,EAAU,2BAAKL,GAAN,kBAAetY,EAAOU,OAyB3D,OAjBEyK,GACAoO,IACC/X,EAAQ8W,EAAD,YAAC,eACJnN,EAAK9B,MADF,IAENC,SAAU,OAGZqP,EAAU,2BACLxN,EAAK9B,MADD,IAEPC,SAAU,MAIV6B,GAAQ9B,IAAS8B,EAAK9B,MACxB+C,EAAS,CAAEnG,KAAM4T,GAAUxQ,KAAM8B,EAAK9B,OAItC,uBAAM9L,UAAWmC,IAAGC,KAAO4b,MAAO7C,SAAUU,EAA5C,UACGrM,GACC,mBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,oCAA/B,SACGA,IAGL,qBAAKxP,UAAU,OAAf,SACE,cAAC,GAAD,yBACE0I,KAAK,OACLuU,YAAY,qBACZO,SAAUO,EAAe,SACrBpS,EAAS,OAAQ,CACnBxI,MAAO2I,EAAKrJ,KACZiY,SAAU,CAAEP,UAAU,EAAMK,UAAW,MAN3C,IAQE0C,SAAUxN,OAGd,qBAAK1P,UAAU,OAAf,SACE,cAAC,GAAD,yBACE0I,KAAK,QACLuU,YAAY,iCACZO,SAAUO,EAAe,UACrBpS,EAAS,QAAS,CACpBxI,MAAO2I,EAAKsO,MACZM,SAAU,CAAEP,UAAU,EAAMC,OAAO,MANvC,IAQE8C,SAAUxN,OAGd,qBAAK1P,UAAU,OAAf,SACE,cAAC,GAAD,yBACEid,YAAY,uCACZvU,KAAK,WACL8U,SAAUO,EAAe,aACrBpS,EAAS,WAAY,CAAE+O,SAAU,CAAEF,UAAW,MAJpD,IAKE0C,SAAUxN,OAGd,yBACExN,MAAO,CAAEgU,QAAS4H,EAAgB,GAAK,QACvC9d,UAAWoC,KAAO6b,WAFpB,UAIE,mBACEje,UAAU,mCACVsI,QAASoH,OAAUzM,EApEN,WACnBmY,EAAU,2BAAKtP,GAAN,IAAYC,SAAU,OAiE3B,kDAMA,cAAC,SAAD,CACErD,KAAK,UACLM,KAAqB,YAAff,EAA2B,SAAW,QAF9C,2E,oBClFOiW,GAtB4C,SAAC,GAGrD,IAFL1V,EAEI,EAFJA,MAEI,IADJH,aACI,MADI,EACJ,EACJ,OACE,sBAAKrI,UAAWoC,KAAOyO,WAAvB,UACE,cAAC,EAAD,CACE/Q,IAAK0I,EACLxI,UAAWoC,KAAO+b,gBAClBje,MAAO,IACPH,YAAY,EACZE,IAAI,eAELoI,EAAQ,GACP,oBAAGrI,UAAWmC,IAAGC,KAAOgc,aAAc,+BAAtC,cACI/V,SCvBCgW,GACX,2BACWC,GACX,2BAGWC,GACX,6BACWC,GACX,4BACWC,GACX,2BACWC,GAA6C,sBCZ7CC,GACX,8BACWC,GACX,8BAGWC,GACX,gCACWC,GACX,+BACWC,GACX,8BACWC,GACX,yBCOF,SAASC,GAAkB1T,GACzB,OAAO0E,mBACL,kBACE1E,EAAYnB,QAAO,SAACT,EAAqCvB,GAEvD,OADAuB,EAAIvB,EAAKW,KAAOX,EACTuB,IACN,MACL,CAAC4B,IAIL,SAAS2T,GACPhI,EACAiI,GAEA,GAA2C,IAAvCpO,OAAOkK,KAAKkE,GAAgBhP,OAC9B,OAAO,KAGT,IAAM5E,EAAc2L,EAAM3L,YACvB2E,QAAO,SAAC1B,GAAD,QAAUA,KACjB7E,KAAI,SAAC6E,GAAD,OAAQ2Q,EAAe3Q,MAC3BpE,QAAO,SAACgV,EAA4BvO,GACnC,IAAMwO,EAAQD,EAAOE,MAAK,gBAAGvW,EAAH,EAAGA,IAAH,OAAa8H,EAAW9H,MAAQA,KAE1D,OAAIsW,GACiB,QAAfA,EAAM3W,MACR2W,EAAMhX,QAED+W,IAGTA,EAAOvM,KAAP,2BACKhC,GADL,IAEExI,MAA2B,QAApBwI,EAAWnI,KAAiB,EAAI,KAElC0W,KACN,IAEL,OAAO,2BACFlI,GADL,IAEE3O,MAAOgD,EAAYnB,QACjB,SAACmV,EAAD,UAA6BA,EAA7B,EAAUlX,MAAV,EAAiBE,QACjB,GAEFgD,gBAIJ,IAAMiU,GAAY,CAChBC,QAAS,uCACTC,QAAS,yDACTC,KAAM,mDACNC,SAAU,8CAGL,SAASC,GAAgBlT,GAC9B,OAAO6S,GAAU7S,IAAWA,EAGvB,SAASmT,GAAUtU,GACxB,IAEM2T,EAAiBF,GAFQvf,GAAY,SAAC6P,GAAD,OAAWA,EAAMhE,eAApD2C,OAYR,MAAO,CAAE6R,WARU9P,mBACjB,kBACEzE,EACG7B,KAAI,SAACuN,GAAD,OAAWgI,GAAahI,EAAOiI,MACnCjP,QAAO,SAACgH,GAAD,OAA0C,OAAVA,OAC5C,CAAC1L,EAAQ2T,KAMN,SAASa,GAAaxR,GAC3B,IAAMK,EAAWrP,IAEjB,EAAsCgB,qBAAtC,mBAAOyf,EAAP,KAAoBC,EAApB,KACA,EAA0B1f,mBAA4B,MAAtD,mBAAO0W,EAAP,KAAciJ,EAAd,KACA,EAAwC3f,oBAAS,GAAjD,mBAAO4W,EAAP,KAAqBgJ,EAArB,KACA,EAAoC5f,mBAAS,IAA7C,mBAAO8W,EAAP,KAAmB+I,EAAnB,KAEA,EAII3gB,GAAY,SAAC6P,GAAD,OAAWA,EAAMhE,eAHxBA,EADT,EACE2C,MACmBoS,EAFrB,EAEE7Q,kBACc8Q,EAHhB,EAGE5Q,aAGFvO,qBAAU,WACmB,IAAvBmK,EAAY4E,QACdtB,EAASD,QAEV,CAACC,EAAUtD,EAAY4E,SAE1B,IAAMgP,EAAiBF,GAAkB1T,GAqBzC,OAnBIA,EAAY4E,QAAU8P,IAAgB/I,GACxCiJ,EAASjB,GAAae,EAAad,IAGrC/d,qBAAU,WACRgf,GAAgB,G1BgEb,SAAP,mC0B/DII,CAAchS,GACX3M,MAAK,SAAC+L,GACLsS,EAAetS,MAEhB6S,OAAM,SAACC,GAAD,OAASL,EAAcK,MAC7BC,SAAQ,WACPP,GAAgB,QAEnB,CAAC5R,IAKG,CAAE0I,QAAOxH,QAHA6Q,GAAsBnJ,EAGb5H,MAFX8Q,EAAmBhJ,G,wBCzH7BsJ,GAA2C,SAAC,GAA0B,IAAD,IAAvBrV,mBAAuB,MAAT,GAAS,EACnEsV,EAAOtV,EAAYuV,MAAM,EAAG,GAC5BC,EAAOxV,EAAYuV,MAAM,GAC/B,OACE,qBAAI9gB,UAAWoC,KAAOwO,eAAtB,UACGiQ,EAAKlX,KAAI,WAAYC,GAAZ,IAAGpB,EAAH,EAAGA,MAAH,OACR,oBACExI,UAAWoC,KAAOyO,WAElB3O,MAAO,CAAEwV,OAAQmJ,EAAK1Q,OAASvG,GAHjC,SAKE,cAAC,GAAD,CAAkBpB,MAAOA,KAHpBoB,MAMRmX,EAAK5Q,OAAS,GACb,oBAAInQ,UAAWoC,KAAOyO,WAAtB,SACE,cAAC,GAAD,CAAkBrI,MAAOuY,EAAK,GAAGvY,MAAOH,MAAO0Y,EAAK5Q,OAAS,KADxB0Q,EAAK1Q,YAsDrC6Q,GA1C8BnhB,gBAAK,YAAgB,IAAbqX,EAAY,EAAZA,MAC7C7H,EAAWC,cACT3L,EAASsd,cAATtd,KACR,OACE,eAAC,IAAD,CACE3D,UAAWmC,IAAGC,KAAOwG,WACrB8I,GAAI,CACFC,SAAS,GAAD,OAAKhO,EAAL,YAAauT,EAAMC,QAC3BvF,MAAO,CAAEC,WAAYxC,IAJzB,UAOE,yBAAQrP,UAAWoC,KAAOsQ,OAA1B,UACE,qBAAI1S,UAAU,qCAAd,cAAqDkX,EAAMC,UAC3D,sBAAMnX,UAAU,kDAAhB,SACGuE,EAAe2S,EAAMgK,gBAG1B,oBAAIlhB,UAAWmC,IAAG,6BAA8BC,KAAO6G,OAAvD,SACGiO,EAAMzU,OAERyU,EAAMvK,QACL,mBACE3M,UAAWmC,IAAG,iDAAD,eACVC,KAAO+e,WAA8B,SAAjBjK,EAAMvK,SAF/B,SAKGkT,GAAgB3I,EAAMvK,UAG3B,yBAAQ3M,UAAWmC,IAAGC,KAAOsW,QAA7B,UACE,cAAC,GAAD,CAAanN,YAAa2L,EAAM3L,cAChC,sBAAKvL,UAAWoC,KAAOmG,MAAvB,UACE,mBAAGvI,UAAU,qCAAb,SAAmDkX,EAAM3O,QACzD,mBAAGvI,UAAU,OAAb,SACE,cAAC,eAAD,CAAc0I,KAAK,0B,oBC5D/B,SAAS0Y,KACP,IAAQzd,EAASsd,cAATtd,KACR,OACE,sBAAK3D,UAAWmC,IAAGC,KAAOif,MAA1B,UACE,qBAAIrhB,UAAU,6BAAd,UACE,6BACE,cAAC,IAAD,CACE0R,GAAI/N,EACJ2d,OAAK,EACLthB,UAAWoC,KAAOmf,SAClBC,gBAAiBpf,KAAOqf,eAJ1B,0DASF,6BACE,cAAC,IAAD,CACE/P,GAAE,UAAK/N,EAAL,WACF3D,UAAWoC,KAAOmf,SAClBC,gBAAiBpf,KAAOqf,eAH1B,qGAQF,6BACE,cAAC,IAAD,CACE/P,GAAE,UAAK/N,EAAL,WACF2d,OAAK,EACLthB,UAAWoC,KAAOmf,SAClBC,gBAAiBpf,KAAOqf,eAJ1B,iDAUJ,yBACEzhB,UAAWmC,IACTC,KAAOsf,WACP,mDAHJ,UAME,cAAC,IAAD,CAAO/d,KAAMA,EAAM2d,OAAK,EAAxB,kUAGA,cAAC,IAAD,CAAO3d,KAAI,UAAKA,EAAL,WAAoB2d,OAAK,EAApC,kUAQR,SAASK,KACP,IAAQ7E,EAAYN,KAAZM,QACR,EAAsCtc,mBAAS,IAA/C,mBAAOohB,EAAP,KAAoBC,EAApB,KAMA,OAJAzgB,qBAAU,WACR0b,IAAU2D,OAAM,SAACC,GAAD,OAASmB,EAAenB,EAAIlU,cAC3C,CAACsQ,IAEG8E,EACL,oBAAG5hB,UAAWmC,IAAGC,KAAOoN,MAAO,qCAA/B,uTAC6DoS,KAG7D,cAAC,GAAD,CAAStO,QAAQ,IAIrB,SAASwO,KACP,IAAMC,EAAezhB,iBAAyB,MAC9CuJ,EAAakY,GAEb,MFoHK,WACL,IAAMlT,EAAWrP,IAEjB,EAAyCE,GACvC,SAAC6P,GAAD,OAAWA,EAAMyS,WADXxW,EAAR,EAAQA,OAAiByW,EAAzB,EAAgBC,QAIhB/W,2BAAgB,WAGd,OAFA0D,EAAS,CAAEnG,KAAMiW,KAEV,WACL9P,EAAS,CAAEnG,KAAMkW,QAElB,CAAC/P,IAEJ,MAIInP,GAAY,SAAC6P,GAAD,OAAWA,EAAMhE,eAHxBA,EADT,EACE2C,MACmBoS,EAFrB,EAEE7Q,kBACc8Q,EAHhB,EAGE5Q,aAGFxE,2BAAgB,WACa,IAAvBI,EAAY4E,QACdtB,EAASD,QAEV,CAACC,EAAUtD,EAAY4E,SAE1B,IAAQ4P,EAAeD,GAAUtU,GAAzBuU,WAERA,EAAWoC,MACT,SAACvhB,EAAGwhB,GAAJ,OAAU,IAAI7e,KAAK6e,EAAElB,WAAWzd,UAAY,IAAIF,KAAK3C,EAAEsgB,WAAWzd,aAGpE,IAAM+L,EAAQyS,EAAc3B,EAG5B,MAAO,CACLP,aACAvQ,QACAE,SALgBlE,EAAO2E,SAAWX,GAAU+Q,GEtJP8B,GAA/BtC,EAAR,EAAQA,WAAYvQ,EAApB,EAAoBA,MAAOE,EAA3B,EAA2BA,QAE3B,OACE,qCACGF,GACC,oBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,+BAA/B,6GACwBA,KAG1B,qBAAIxP,UAAWoC,KAAOkgB,UAAWjiB,IAAK0hB,EAAtC,UACGrS,GACC,cAAC,EAAD,CACEtG,OAAQ,EACRpJ,UAAWmC,IAAGC,KAAOmgB,cAAe,aACpClZ,IAAI,OAGP0W,EAAWpW,KAAI,SAACuN,GAAD,OACd,oBAAuBlX,UAAU,YAAjC,SACE,cAAC,GAAD,CAAWkX,MAAOA,KADXA,EAAMC,iBASlB,SAASqL,KACd,IAAQ7e,EAASsd,cAATtd,KACR,OACE,0BAAS3D,UAAWmC,IAAGC,KAAOwG,UAAW,SAAzC,UACE,cAACwY,GAAD,IACA,cAAC,IAAD,CAAOzd,KAAMA,EAAM2d,OAAK,EAAxB,SACE,cAAC,GAAD,MAEF,cAAC,IAAD,CAAO3d,KAAI,UAAKA,EAAL,WAAoB2d,OAAK,EAApC,SACE,cAACQ,GAAD,MAEF,cAAC,IAAD,CAAOne,KAAI,UAAKA,EAAL,WAAoB2d,OAAK,EAApC,SACE,cAACK,GAAD,S,wBC9GR,SAASc,GAAT,GAM6B,IAL3BxZ,EAK0B,EAL1BA,MACAuC,EAI0B,EAJ1BA,OACAkE,EAG0B,EAH1BA,QACA1P,EAE0B,EAF1BA,UAE0B,IAD1B0iB,gBAC0B,SAC1B,OACE,0BAAS1iB,UAAWmC,IAAGC,KAAOugB,kBAAmB3iB,GAAjD,UACE,oBACEA,UAAWmC,IACT,6BACAC,KAAOwgB,wBAHX,SAMG3Z,IAEH,qBACEjJ,UAAWmC,IACTC,KAAOygB,sBACP,gCAFW,eAIRzgB,KAAOmK,QAAUmW,IALxB,UASGhT,GAAW,cAAC,EAAD,CAAUtG,OAAQ,EAAGpJ,UAAU,OAAOqJ,IAAI,OACrDmC,EAAO7B,KAAI,SAACuN,EAAOtN,GAAR,OACV,oBAAI5J,UAAWoC,KAAO0gB,sBAAtB,SACG5L,GAD+CtN,YASrD,SAASmZ,KACd,IAAMC,EAAe1iB,iBAAoB,MACnCyhB,EAAezhB,iBAAyB,MAC9CuJ,EAAamZ,GACbnZ,EAAakY,GAEb,MHgFK,WACL,IAAMlT,EAAWrP,IAEjB,EAKIE,GAAY,SAAC6P,GAAD,OAAWA,EAAM0T,QAJ/BzX,EADF,EACEA,OACA+T,EAFF,EAEEA,MACA2D,EAHF,EAGEA,WACSjB,EAJX,EAIEC,QAGF9gB,qBAAU,WAGR,OAFAyN,EAAS,CAAEnG,KAAM2V,KAEV,WACLxP,EAAS,CAAEnG,KAAM4V,QAElB,CAACzP,IAEJ,MAIInP,GAAY,SAAC6P,GAAD,OAAWA,EAAMhE,eAHxBA,EADT,EACE2C,MACmBoS,EAFrB,EAEE7Q,kBACc8Q,EAHhB,EAGE5Q,aAGFxE,2BAAgB,WACa,IAAvBI,EAAY4E,QACdtB,EAASD,QAEV,CAACC,EAAUtD,EAAY4E,SAE1B,IAoBMX,EAAQyS,EAAc3B,EAG5B,MAAO,CACLP,WAxBqBD,GAAUtU,GAAzBuU,WAyBNR,QACA2D,aACAC,gBAzBsBlT,mBACtB,kBACEzE,EACG0E,QAAO,kBAA2B,SAA3B,EAAGvD,UACVmU,MAAM,EAAG,IACTnX,KAAI,qBAAGwN,YACZ,CAAC3L,IAoBD4X,gBAjBsBnT,mBACtB,kBACEzE,EACG0E,QAAO,kBAA2B,YAA3B,EAAGvD,UACVmU,MAAM,EAAG,IACTnX,KAAI,qBAAGwN,YACZ,CAAC3L,IAYDgE,QACAE,SATgBlE,EAAO2E,SAAWX,GAAU+Q,GG3H1C8C,GAPFtD,EADF,EACEA,WACAoD,EAFF,EAEEA,gBACAC,EAHF,EAGEA,gBACA7D,EAJF,EAIEA,MACA2D,EALF,EAKEA,WACA1T,EANF,EAMEA,MACAE,EAPF,EAOEA,QAGF,OACE,0BAAS1P,UAAWmC,IAAGC,KAAOwG,WAA9B,UACE,oBAAI5I,UAAU,iCAAd,uFACA,0BAASA,UAAWoC,KAAO+Q,QAA3B,UACG3D,GACC,oBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,+BAA/B,6GACwBA,KAG1B,qBAAIxP,UAAWmC,IAAGC,KAAOkgB,WAAYjiB,IAAK0hB,EAA1C,UACGrS,GACC,cAAC,EAAD,CACE1P,UAAWmC,IAAGC,KAAOmgB,cAAe,aACpCnZ,OAAQ,EACRC,IAAI,OAGP0W,EAAWpW,KAAI,SAACuN,GAAD,OACd,oBAAIlX,UAAU,YAAd,SACE,cAAC,GAAD,CAAWkX,MAAOA,KADWA,EAAMC,cAKzC,0BAASnX,UAAWoC,KAAOkhB,UAAWjjB,IAAK2iB,EAA3C,UACE,0BAAShjB,UAAWoC,KAAOmhB,cAA3B,UACE,cAACd,GAAD,CACEziB,UAAU,OACViJ,MAAM,wCACNyG,QAASA,EACTlE,OAAQ2X,EACRT,UAAU,IAEZ,cAACD,GAAD,CACExZ,MAAM,+CACNyG,QAASA,EACTlE,OAAQ4X,OAGX7D,EAAQ,GACP,qCACE,oBACEvf,UAAWmC,IACT,6BACAC,KAAOohB,qBAHX,oIAQA,mBACExjB,UAAWmC,IACT8I,IAAUwY,gBACV,+BAHJ,SAMGlE,IAEH,oBACEvf,UAAWmC,IACT,6BACAC,KAAOohB,qBAHX,6HAQA,mBACExjB,UAAWmC,IACT8I,IAAUwY,gBACV,+BAHJ,SAMGP,gB,wBC3HXtC,GAA2C,SAAC,GAG3C,IAAD,IAFJrV,mBAEI,MAFU,GAEV,EADJuM,EACI,EADJA,QAEA,OACE,oBAAI9X,UAAWoC,KAAOwO,eAAgBvQ,IAAKyX,EAA3C,SACGvM,EAAY5B,KAAI,WAAgCC,GAAhC,IAAGpB,EAAH,EAAGA,MAAO/F,EAAV,EAAUA,KAAM4F,EAAhB,EAAgBA,MAAOE,EAAvB,EAAuBA,MAAvB,OACf,qBAAIvI,UAAWmC,IAAGC,KAAOyO,WAAY,aAArC,UACE,cAAC,GAAD,CAAkBrI,MAAOA,IACzB,mBACExI,UAAWmC,IACTC,KAAOshB,eACP,oCAHJ,SAMGjhB,IAEH,sBAAKzC,UAAWoC,KAAOmG,MAAvB,UACE,oBAAGvI,UAAU,qCAAb,UACGqI,EADH,MACaE,KAEb,mBAAGvI,UAAU,OAAb,SACE,cAAC,eAAD,CAAc0I,KAAK,mBAf+BkB,SAoEjD+Z,GAvC8B9jB,gBAC3C,YAAmC,IAAhCqX,EAA+B,EAA/BA,MAA+B,IAAxBjN,iBAAwB,SAC1B6N,EAAUxX,iBAAyB,MACnC0X,EAAY1X,iBAAoB,MAItC,OAFAuJ,EAAaiO,EAAS,CAAE/N,QAASiO,EAAWhO,UAAW,IAAKC,cAG1D,0BAASjK,UAAWmC,IAAGC,KAAOwG,WAA9B,UACE,oBAAI5I,UAAU,kCAAd,SAAiDkX,EAAMzU,OACtDyU,EAAMvK,QACL,mBACE3M,UAAWmC,IAAG,mCAAD,eACVC,KAAO+e,WAA8B,SAAjBjK,EAAMvK,SAF/B,SAKGkT,GAAgB3I,EAAMvK,UAG3B,0BAAS3M,UAAWmC,IAAG,SAAvB,UACE,oBAAInC,UAAU,kCAAd,mDACA,cAAC,GAAD,CAAauL,YAAa2L,EAAM3L,YAAauM,QAASA,OAExD,yBAAQ9X,UAAWmC,IAAGC,KAAOsW,OAAQ,SAAUrY,IAAK2X,EAApD,UACE,sBAAMhY,UAAU,kDAAhB,SACGuE,EAAe2S,EAAMgK,aAExB,sBAAKlhB,UAAWoC,KAAOmG,MAAvB,UACE,mBAAGvI,UAAU,qCAAb,SAAmDkX,EAAM3O,QACzD,mBAAGvI,UAAU,OAAb,SACE,cAAC,eAAD,CAAc0I,KAAK,0B,oBC7E1B,SAASkb,KACd,IAAQpV,EAAOqV,cAAPrV,GAER,EAAkCwR,GAAaxR,GAAvC0I,EAAR,EAAQA,MAAOxH,EAAf,EAAeA,QAASF,EAAxB,EAAwBA,MAExB,OAAIA,EAEA,yBACExP,UAAWmC,IACTC,KAAOwG,UACP,yCAHJ,SAME,oBAAG5I,UAAWoC,KAAOoN,MAArB,mIAC0BhB,EAD1B,IAC8B,uBAD9B,IACsCgB,OAMxCE,EAEA,0BAAS1P,UAAWmC,IAAGC,KAAOwG,UAAW,aAAzC,UACE,qBAAK5I,UAAWoC,KAAOkR,OAAvB,SACE,cAAC,EAAD,CACEpT,MAAO,IACPF,UAAW,0CAGf,cAAC,EAAD,CAAUoJ,OAAQ,EAAGpJ,UAAU,oCAC/B,sBAAKA,UAAU,QAAf,UACE,cAAC,EAAD,CAAUE,MAAO,GAAIiJ,QAAQ,EAAMnJ,UAAU,SAC7C,cAAC,EAAD,CAAUE,MAAM,MAAMF,UAAU,wCAElC,sBAAKA,UAAU,OAAf,UACE,cAAC,EAAD,CAAUE,MAAO,GAAIC,OAAQ,GAAIgJ,QAAQ,EAAMnJ,UAAU,SACzD,cAAC,EAAD,CAAUE,MAAM,MAAMF,UAAU,2CAOtCkX,GACE,0BAASlX,UAAWmC,IAAGC,KAAOwG,UAAW,aAAzC,UACE,qBACE5I,UAAWmC,IAAGC,KAAOkR,OAAQ,uCAD/B,cAGI4D,EAAMC,UAEV,cAAC,GAAD,CAAWD,MAAOA,O,wBCFX4M,GA7C6CjkB,gBAC1D,YAAqB,IAAlBgR,EAAiB,EAAjBA,WACD,OACE,sBAAK7Q,UAAWmC,IAAGC,KAAOwG,UAAW,oBAArC,UACE,cAAC,EAAD,CACE9I,IAAK+Q,EAAWkT,YAChB9jB,IAAK4Q,EAAWpO,KAChBvC,MAAO,MAET,oBACEF,UAAWmC,IAAGC,KAAO6G,MAAO,wCAD9B,SAGG4H,EAAWpO,OAEd,qBAAIzC,UAAWmC,IAAGC,KAAO+Q,QAAS,+BAAlC,UACE,gCACE,sGACA,oBAAInT,UAAU,qCAAd,SACG6Q,EAAWmT,cAGhB,gCACE,wEACA,oBAAIhkB,UAAU,qCAAd,SACG6Q,EAAWoT,cAGhB,gCACE,kEACA,oBAAIjkB,UAAU,qCAAd,SACG6Q,EAAWqT,SAGhB,gCACE,0FACA,oBAAIlkB,UAAU,qCAAd,SACG6Q,EAAWsT,4B,oBClCpB3a,GACJ,gCACE,cAAC,EAAD,CAAUtJ,MAAM,MAAMF,UAAU,8BAChC,cAAC,EAAD,CAAUE,MAAO,IAAKC,OAAQ,IAAKH,UAAU,cAC7C,cAAC,EAAD,CAAUG,OAAQ,GAAIH,UAAU,OAAOoJ,OAAQ,OAG5C,SAASgb,KACd,IAAQ5V,EAAOqV,cAAPrV,GACFK,EAAWrP,IAEjB,EAIIE,GAAY,SAAC6P,GAAD,OAAWA,EAAMhE,eAHxBA,EADT,EACE2C,MACmBsB,EAFrB,EAEEC,kBACcC,EAHhB,EAGEC,aAGFxE,2BAAgB,WACa,IAAvBI,EAAY4E,QACdtB,EAASD,QAEV,CAACrD,EAAY4E,OAAQtB,IAExB,IAAMgC,EAAatF,EAAY+T,MAAK,qBAAGvW,MAAkByF,KACzD,OACE,0BAASxO,UAAWmC,IAAGC,KAAOwG,WAA9B,UACG8G,GAAWlG,GACXgG,GACC,oBAAGxP,UAAWmC,IAAGC,KAAOoN,MAAO,+BAA/B,yIAC2BA,KAG5BqB,GACC,qCACE,oBAAI7Q,UAAU,4BAAd,qHACA,cAAC,GAAD,CAAmB6Q,WAAYA,QAGjCrB,IAAUE,IAAYmB,GACtB,mBAAG7Q,UAAU,8BAAb,yLCpDD,SAASqkB,KACd,OACE,sBAAKniB,MAAO,CAAEoiB,UAAW,UAAzB,UACE,mBAAGtkB,UAAU,oCAAb,iBAGA,mBAAGA,UAAU,sDAAb,iCAGA,mBAAGA,UAAU,sDAAb,0I,4CC4BSukB,GAxBgC,SAAC,GAIzC,IAHCC,EAGF,EAHJzK,KACAtH,EAEI,EAFJA,SACA9O,EACI,EADJA,KAEMd,EAAQoe,YAAc,CAAEtd,OAAM2d,MAAgB,MAAT3d,IAC3C,OACE,eAAC,IAAD,CACE3D,UAAWmC,IACTC,KAAOwG,UACP,mDAEF8I,GAAI/N,EALN,UAOE,cAAC6gB,EAAD,CAAM9b,KAAM7F,EAAQ,UAAY,cAChC,sBACE7C,UAAWmC,IAAGC,KAAOmU,KAAM,CAAEkO,qBAAsB5hB,GAAS,QAD9D,SAGG4P,QCgBMiS,GAnCa,WAC1B,OACE,wBAAQ1kB,UAAWmC,IAAGC,KAAOsQ,QAA7B,SACE,qBAAI1S,UAAWoC,KAAO+Q,QAAtB,UACE,oBAAInT,UAAWoC,KAAOuiB,YAAtB,SACE,qBAAK3kB,UAAWmC,IAAGC,KAAOwiB,YAA1B,SACE,+BACE,6BACE,cAAC,GAAD,CAAY7K,KAAM8K,aAAYlhB,KAAK,IAAnC,kFAIF,oBAAI3D,UAAWmC,IAAG,QAAlB,SACE,cAAC,GAAD,CAAY4X,KAAM+K,WAAUnhB,KAAK,QAAjC,gGAOR,oBAAI3D,UAAWoC,KAAO2iB,kBAAtB,SACE,cAAC,IAAD,CAAMrT,GAAG,IAAT,SACE,cAAC,OAAD,QAGJ,oBAAI1R,UAAWoC,KAAO4iB,iBAAtB,SACE,cAAC,GAAD,CAAYjL,KAAMkL,cAAathB,KAAK,WAApC,qGC5BGuhB,GAAiD,SAAC,GAGxD,IAFLzS,EAEI,EAFJA,SACGsO,EACC,4BACJ,EAA6BvE,KAArB1Q,EAAR,EAAQA,KAER,OAFA,EAAc8Q,WAOZ,cAAC,IAAD,2BACMmE,GADN,IAEEoE,OAAQ,gBAAG9V,EAAH,EAAGA,SAAH,OACNvD,EACE2G,EAEA,cAAC,IAAD,CACEf,GAAI,CACFC,SAAU,SACVC,MAAO,CAAEoL,KAAM3N,UAblB,cAAC,GAAD,CAASiE,QAAQ,KCTf8R,GAAuD,SAAC,GAG9D,IAFL3S,EAEI,EAFJA,SACGsO,EACC,4BACJ,EAA6BvE,KAArB1Q,EAAR,EAAQA,KAER,OAFA,EAAc8Q,WAOZ,cAAC,IAAD,2BAAWmE,GAAX,IAAiBoE,OAAQ,kBAAOrZ,EAAO,cAAC,IAAD,CAAU4F,GAAG,MAASe,MAJtD,cAAC,GAAD,CAASa,QAAQ,KCYb+R,GApB0BxlB,gBAAK,WAC5C,IAAQ2O,EAAOqV,cAAPrV,GACFyJ,EAAUC,cAGVrH,EAFyBnR,GAAY,SAAC6P,GAAD,OAAWA,EAAMhE,eAApD2C,MAEuBoR,MAAK,qBAAGvW,MAAkByF,MAAO,KAE1D8W,EAAe7N,uBAAY,WAC/BQ,EAAQsN,WACP,CAACtN,IAEJ,OACEpH,GACE,cAAC,GAAD,CAAO6B,OAAO,0GAAqBR,SAAS,EAAMC,QAASmT,EAA3D,SACE,cAAC,GAAD,CAAmBzU,WAAYA,SCqBxB2U,GAjCkB3lB,gBAAK,WACpC,IAAQ2O,EAAOqV,cAAPrV,GACFyJ,EAAUC,cACV7I,EAAWC,cAEDmW,EAAe/lB,GAAY,SAAC6P,GAAD,OAAWA,EAAM0T,QAApDzX,OACQka,EAAkBhmB,GAAY,SAAC6P,GAAD,OAAWA,EAAMyS,WAAvDxW,OAQF0L,EAFiB4I,GAJRzQ,EAASsC,SAASgU,WAAW,SACxCF,EACAC,GAEI3F,WAEiBT,MAAK,qBAAGnI,SAAwByO,OAAOpX,OAAQ,KAElE8W,EAAe7N,uBAAY,WAC/BQ,EAAQsN,WACP,CAACtN,IAEEvF,EAASwE,GACb,sBAAKlX,UAAU,gCAAf,cAAiDkX,EAAMC,UAGzD,OACED,GACE,cAAC,GAAD,CAAOxE,OAAQA,EAAQR,SAAS,EAAMC,QAASmT,EAA/C,SACE,cAAC,GAAD,CAAWpO,MAAOA,EAAOjN,WAAW,SCqD7B4b,GAhEO,WAAO,IAAD,EACpBxW,EAAWC,cAEXuC,EAAgC,SADtBqG,cACW4N,SAAR,UAA6BzW,EAASuC,aAAtC,aAA6B,EAAgBC,YAEhE,OACE,sBAAK7R,UAAWoC,IAAO2jB,IAAvB,UACE,cAAC,GAAD,IACA,sBAAM/lB,UAAWmC,IAAGC,IAAO6M,MAA3B,SACE,eAAC,IAAD,CAAQI,SAAUwC,GAAcxC,EAAhC,UACE,cAAC,IAAD,CAAO1L,KAAK,IAAI2d,OAAO,EAAvB,SACE,cAACxI,GAAD,MAEF,cAAC,IAAD,CAAOnV,KAAK,SAAS2d,OAAO,EAA5B,SACE,cAACvE,GAAD,MAEF,cAAC,GAAD,CAAmBpZ,KAAK,YAAY2d,OAAO,EAA3C,SACE,cAACnE,GAAD,MAEF,cAAC,GAAD,CAAmBxZ,KAAK,mBAAmB2d,OAAO,EAAlD,SACE,cAACjE,GAAD,MAEF,cAAC,GAAD,CAAmB1Z,KAAK,kBAAkB2d,OAAO,EAAjD,SACE,cAAChE,GAAD,MAEF,cAAC,GAAD,CAAgB3Z,KAAK,sBAAsB2d,OAAO,EAAlD,SACE,cAACsC,GAAD,MAEF,cAAC,GAAD,CAAgBjgB,KAAK,WAArB,SACE,cAAC6e,GAAD,MAEF,cAAC,IAAD,CAAO7e,KAAK,YAAY2d,OAAO,EAA/B,SACE,cAACsC,GAAD,MAEF,cAAC,IAAD,CAAOjgB,KAAK,QAAQ2d,OAAO,EAA3B,SACE,cAACyB,GAAD,MAEF,cAAC,IAAD,CAAOpf,KAAK,mBAAmB2d,OAAO,EAAtC,SACE,cAAC8C,GAAD,MAEF,cAAC,IAAD,UACE,cAACC,GAAD,WAILxS,GACC,cAAC,IAAD,CAAOlO,KAAK,mBAAZ,SACE,cAAC,GAAD,MAGHkO,GACC,cAAC,IAAD,CAAOlO,KAAK,sBAAZ,SACE,cAAC,GAAD,MAGHkO,GACC,cAAC,IAAD,CAAOlO,KAAK,YAAZ,SACE,cAAC,GAAD,UCpEKqiB,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBrkB,MAAK,YAAkD,IAA/CskB,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,O,mBCORO,GAAsC,CAC1CtY,MAAO,GACPyB,cAAc,EACd8W,cAAc,EACdhX,kBAAmB,ICVrB,SAASiX,KAGN,IAFDxY,EAEA,uDAFkC,GAClC4B,EACA,uCACA,OACE5B,EAAM9D,QAAO,SAACuc,EAAMxjB,GAAP,OAAiBwjB,EAAOxjB,EAAMoF,QAAO,GAC1B,IAAhB,OAAPuH,QAAO,IAAPA,OAAA,EAAAA,EAASvH,QAAS,GAUvB,IAAMqe,GAAsC,CAC1C1Y,MAAO,GACP4B,QAAS,KACTmH,WAAY,GCbR4P,GAA0B,CAC9B1P,OAAQ,KACRE,iBAAiB,EACjByP,iBAAiB,EACjBvP,qBAAsB,ICFlBwP,GAAwB,CAC5Bjb,KAAM,KACN2Q,aAAa,EACbC,aAAa,EACbC,iBAAkB,ICLdqK,GAA6B,CACjCC,aAAa,EACb/E,QAAS,GACT1W,OAAQ,GACR+T,MAAO,EACP2D,WAAY,GCNR8D,GAAgC,CACpCC,aAAa,EACb/E,QAAS,GACT1W,OAAQ,ICXG0b,GAAcC,aAAgB,CACzC5b,YNcgC,WAG5B,IAFJqG,EAEG,uDAFwB4U,GAC3BV,EACG,uCACH,OAAQA,EAAOpd,MACb,KAAK+F,GACH,OAAO,2BACFmD,GADL,IAEEjC,cAAc,EACd8W,cAAc,EACdhX,kBAAmB,KAGvB,KAAKf,GACH,OAAO,2BACFkD,GADL,IAEEjC,cAAc,EACd8W,cAAc,EACdhX,kBAAmB,GACnBvB,MAAO4X,EAAO5X,QAGlB,KAAKS,GACH,OAAO,2BACFiD,GADL,IAEEjC,cAAc,EACd8W,cAAc,EACdhX,kBAAmBqW,EAAOtZ,QAC1B0B,MAAO,KAGX,QACE,OAAO0D,IM7CXhC,ULsBgC,WAG5B,IAFJgC,EAEG,uDAFwBgV,GAC3Bd,EACG,uCACH,OAAQA,EAAOpd,MACb,KAAKqL,GACH,IAAM3L,EAAO0d,EAAO1d,KAEpB,GAAkB,QAAdA,EAAKM,KACP,OAAO,2BACFkJ,GADL,IAEE9B,QAAS1H,EACT6O,WAAYyP,GAAgB9U,EAAM1D,MAAO9F,KAG3C,IAAM8F,EAAK,sBACN0D,EAAM1D,OADA,4BAGJ9F,GAHI,IAIP4I,IAAK5I,EAAKW,KAAM,IAAIxF,MAAOE,cAG/B,OAAO,2BACFmO,GADL,IAEE1D,QACA+I,WAAYyP,GAAgBxY,EAAO0D,EAAM9B,WAI/C,KAAKkE,GACH,IAAM9F,EAAQ0D,EAAM1D,MAAMgC,QAAO,qBAAGc,MAAkB8U,EAAO1d,KAAK4I,OAClE,OAAO,2BACFY,GADL,IAEE1D,QACA+I,WAAYyP,GAAgBxY,EAAO0D,EAAM9B,WAG7C,KAAKmE,GACH,IAAM/F,EAAQ0D,EAAM1D,MACdkZ,EAAWlZ,EAAM4X,EAAO1Q,WAE9B,OAAO,2BACFxD,GADL,IAEE1D,MAAM,GAAD,mBACAA,EACA4S,MAAM,EAAGgF,EAAO3Q,WAAa,GAC7BjF,QAAO,qBAAGc,MAAkBoW,EAASpW,QAHrC,CAIHoW,GAJG,YAKAlZ,EACA4S,MAAMgF,EAAO3Q,WAAa,GAC1BjF,QAAO,qBAAGc,MAAkBoW,EAASpW,WAK9C,KAAKkD,GACH,OAAO0S,GAET,QACE,OAAOhV,IKhFXsF,MJY0B,WAGtB,IAFJtF,EAEG,uDAFkBiV,GACrBf,EACG,uCACH,OAAQA,EAAOpd,MACb,KAAKgO,GACH,OAAO,2BACF9E,GADL,IAEEyF,iBAAiB,EACjByP,iBAAiB,EACjBvP,qBAAsB,GACtBJ,OAAQ,OAGZ,KAAKR,GACH,OAAO,2BACF/E,GADL,IAEEyF,iBAAiB,EACjByP,iBAAiB,EACjB3P,OAAQ2O,EAAO3O,SAGnB,KAAKP,GACH,OAAO,2BACFhF,GADL,IAEEyF,iBAAiB,EACjByP,iBAAiB,EACjBvP,qBAAsBuO,EAAOtZ,UAGjC,KAAKqK,GACH,OAAOgQ,GAET,QACE,OAAOjV,II7CX9F,KHayB,WAGrB,IAFJ8F,EAEG,uDAFiBmV,GACpBjB,EACG,uCACH,OAAQA,EAAOpd,MACb,KAAKyT,GACH,OAAO,2BACFvK,GADL,IAEE6K,aAAa,EACbC,aAAa,EACbC,iBAAkB,GAClB7Q,KAAM,OAGV,KAAKsQ,GACH,OAAO,2BACFxK,GADL,IAEE6K,aAAa,EACbC,aAAa,EACbC,iBAAkB,GAClB7Q,KAAMga,EAAOha,OAGjB,KAAKuQ,GACH,OAAO,2BACFzK,GADL,IAEE6K,aAAa,EACbC,aAAa,EACbC,iBAAkBmJ,EAAOtZ,QACzBV,KAAM,OAGV,KAAKwQ,GACH,OAAO,2BACF1K,GADL,IAEE9F,KAAMga,EAAOha,OAGjB,KAAKyQ,GACH,OAAO,2BACF3K,GADL,IAEE9F,KAAM,OAGV,QACE,OAAO8F,IGzDXqR,KFY2B,WAGvB,IAFJrR,EAEG,uDAFmBoV,GACtBlB,EACG,uCACH,OAAQA,EAAOpd,MACb,KAAK6V,GACH,OAAO,2BACF3M,GADL,IAEEsQ,QAAS,GACT+E,aAAa,IAGjB,KAAKxI,GACH,OAAO,2BACF7M,GADL,IAEEsQ,QAAS4D,EAAOuB,QAAQ7a,QACxBya,aAAa,IAGjB,KAAKzI,GACH,OAAO,2BACF5M,GADL,IAEEsQ,QAAS,GACT+E,aAAa,IAGjB,KAAKvI,GACH,OAAIoH,EAAOuB,QAAQ7a,QACV,2BACFoF,GADL,IAEEsQ,QAAS4D,EAAOuB,QAAQ7a,QACxBhB,OAAQ,GACR+T,MAAO,EACP2D,WAAY,IAIT,2BACFtR,GADL,IAEEsQ,QAAS,GACT1W,OAAQsa,EAAOuB,QAAQ7b,OACvB+T,MAAOuG,EAAOuB,QAAQ9H,MACtB2D,WAAY4C,EAAOuB,QAAQnE,aAG/B,QACE,OAAOtR,IEzDXoQ,QDQ8B,WAG1B,IAFJpQ,EAEG,uDAFsBoV,GACzBlB,EACG,uCACH,OAAQA,EAAOpd,MACb,KAAKmW,GACH,OAAO,2BACFjN,GADL,IAEEsQ,QAAS,GACT+E,aAAa,IAGjB,KAAKlI,GACH,OAAO,2BACFnN,GADL,IAEEsQ,QAAS4D,EAAOuB,QAAQ7a,QACxBya,aAAa,IAGjB,KAAKnI,GACH,OAAO,2BACFlN,GADL,IAEEsQ,QAAS,GACT+E,aAAa,IAGjB,KAAKjI,GACH,OAAI8G,EAAOuB,QAAQ7a,QACV,2BACFoF,GADL,IAEEsQ,QAAS4D,EAAOuB,QAAQ7a,QACxBhB,OAAQ,KAIL,2BACFoG,GADL,IAEEsQ,QAAS,GACT1W,OAAQsa,EAAOuB,QAAQ7b,SAG3B,QACE,OAAOoG,MExBA0V,GAAmB,SAC9BC,EACAC,EACAC,GAMA,OAAO,SAAClY,GACN,IAAImY,EAA2B,KAE/B,OAAO,SAACC,GAAD,OAAU,SAAC7B,GAChB,IAAQjX,EAAaU,EAAbV,SACAnG,EAAkBod,EAAlBpd,KAAM2e,EAAYvB,EAAZuB,QAEZO,EAOEJ,EAPFI,OACAC,EAMEL,EANFK,QACAC,EAKEN,EALFM,cACAC,EAIEP,EAJFO,OACA5V,EAGEqV,EAHFrV,QACA6V,EAEER,EAFFQ,QACAC,EACET,EADFS,UAEF,GAAIvf,IAASkf,EAAQ,CACnB,IAAI/a,EAAM0a,EACV,GAAIE,EAAU,CACZ,IAAMna,EAAc9K,EAAU,eAC9BqK,GAAG,iBAAcS,GAEnBoa,EAAS,IAAIQ,UAAUrb,GAEzB,GAAI6a,EAAQ,CAmCV,GAlCAA,EAAOS,OAAS,SAACC,GACfvZ,EAAS,CAAEnG,KAAMqf,EAAQV,QAASe,KAGpCV,EAAOvmB,QAAU,SAACinB,GAChBvZ,EAAS,CACPnG,KAAMsf,EACNX,QAAS,CAAE7a,QAAS,wGAIxBkb,EAAOW,UAAY,SAACD,GAClB,IAAQxa,EAASwa,EAATxa,KACF0a,EAAanb,KAAKob,MAAM3a,GACV4a,GAAmBF,EAA/B/b,QAAR,YAAuC+b,EAAvC,cAGEE,EAAehc,SACY,6BAA3Bgc,EAAehc,SACfkb,GAEAA,EAAOe,QACPlb,KAAe1L,MAAK,WAClBgN,EAAS,CAAEnG,KAAMkf,QAGnB/Y,EAAS,CAAEnG,KAAMuf,EAAWZ,QAASmB,KAIzCd,EAAOgB,QAAU,SAACN,GAChBvZ,EAAS,CAAEnG,KAAMyJ,KAGfzJ,IAASof,EAAe,CAC1B,IAAMtb,EAAO,eAAQ6a,GACrBK,EAAOiB,KAAKxb,KAAKC,UAAUZ,IAGzB9D,IAASmf,IACXH,EAAOe,QACPf,EAAS,MAIbC,EAAK7B,OC7FL8C,GAAe,CACnB/b,IAAK,6CACLgc,QAAS,CACPjB,OAAQvJ,GACRwJ,QAASvJ,GACTwJ,c3BvBF,uB2BwBEC,OAAQxJ,GACRpM,QAASqM,GACTwJ,QAASvJ,GACTwJ,UAAWvJ,KAIToK,GAAkB,CACtBjc,IAAK,yCACLgc,QAAS,CACPjB,OAAQjJ,GACRkJ,QAASjJ,GACTkJ,c1BpCF,0B0BqCEC,OAAQlJ,GACR1M,QAAS2M,GACTkJ,QAASjJ,GACTkJ,UAAWjJ,KAYT+J,IAFmBrhB,OAAOshB,sCAAwCC,MAGtEC,aACEC,KACA7B,GAAiBsB,GAAa/b,IAAK+b,GAAaC,SAChDvB,GAAiBwB,GAAgBjc,IAAKic,GAAgBD,SAAS,KAIpDO,gBAAYlC,GAAa6B,ICzDxCM,IAASlE,OACP,cAAC,IAAMmE,WAAP,UACE,cAAC,IAAD,CAAU/Z,MAAOA,GAAjB,SACE,cAAC,IAAD,UACE,cAAC,GAAD,UAIN5M,SAAS2P,eAAe,SAM1B0T,M,mBCvBA1mB,EAAOC,QAAU,CAAC,UAAY,sCAAsC,SAAW,qCAAqC,cAAgB,0CAA0C,iBAAmB,6CAA6C,YAAc,wCAAwC,gBAAkB,4CAA4C,eAAiB,8EAA8E,OAAS,mCAAmC,eAAiB,2CAA2C,MAAQ,kCAAkC,OAAS,qC,mBCA5lBD,EAAOC,QAAU,CAAC,UAAY,sCAAsC,MAAQ,kCAAkC,KAAO,iCAAiC,eAAiB,2CAA2C,YAAc,wCAAwC,WAAa,uCAAuC,MAAQ,kCAAkC,YAAc,wCAAwC,KAAO,iCAAiC,WAAa,uCAAuC,OAAS,mCAAmC,MAAQ,oC,mBCA5iBD,EAAOC,QAAU,CAAC,UAAY,8BAA8B,OAAS,2BAA2B,MAAQ,0BAA0B,WAAa,+BAA+B,OAAS,2BAA2B,eAAiB,mCAAmC,WAAa,+BAA+B,MAAQ,4B,mBCA1TD,EAAOC,QAAU,CAAC,IAAM,iBAAiB,KAAO,kBAAkB,gBAAkB,6BAA6B,gBAAkB,+B,mBCAnID,EAAOC,QAAU,CAAC,UAAY,8BAA8B,WAAa,+BAA+B,OAAS,2BAA2B,eAAiB,mCAAmC,WAAa,+BAA+B,eAAiB,mCAAmC,MAAQ,4B,mBCAxSD,EAAOC,QAAU,CAAC,UAAY,yBAAyB,OAAS,sBAAsB,MAAQ,uB,mBCA9FD,EAAOC,QAAU,CAAC,OAAS,2BAA2B,QAAU,4BAA4B,YAAc,gCAAgC,kBAAoB,oEAAoE,iBAAmB,mEAAmE,WAAa,iC,mBCArUD,EAAOC,QAAU,CAAC,UAAY,yBAAyB,MAAQ,qBAAqB,QAAU,kDAAkD,YAAc,2BAA2B,OAAS,wB,mBCAlMD,EAAOC,QAAU,CAAC,UAAY,8BAA8B,MAAQ,0BAA0B,MAAQ,4B,mBCAtGD,EAAOC,QAAU,CAAC,gBAAkB,oCAAoC,eAAiB,mCAAmC,yBAA2B,+C,mBCAvJD,EAAOC,QAAU,CAAC,QAAU,yBAAyB,OAAS,wBAAwB,cAAgB,+BAA+B,OAAS,wBAAwB,KAAO,wB,mBCA7KD,EAAOC,QAAU,CAAC,UAAY,4BAA4B,MAAQ,0B,mBCAlED,EAAOC,QAAU,CAAC,UAAY,kCAAkC,MAAQ,gC,mBCAxED,EAAOC,QAAU,CAAC,KAAO,2BAA2B,WAAa,iCAAiC,MAAQ,8B,mBCA1GD,EAAOC,QAAU,CAAC,WAAa,sCAAsC,gBAAkB,2CAA2C,aAAe,0C,mBCAjJD,EAAOC,QAAU,CAAC,UAAY,sCAAsC,MAAQ,kCAAkC,MAAQ,kCAAkC,eAAiB,2EAA2E,QAAU,sC,mBCA9PD,EAAOC,QAAU,CAAC,SAAW,2BAA2B,OAAS,2B,mBCAjED,EAAOC,QAAU,CAAC,UAAY,iCAAiC,MAAQ,0D,mBCAvED,EAAOC,QAAU,CAAC,UAAY,iCAAiC,OAAS,gC,mBCAxED,EAAOC,QAAU,CAAC,UAAY,gCAAgC,SAAW,iC,mBCAzED,EAAOC,QAAU,CAAC,UAAY,yBAAyB,MAAQ,uB,mBCA/DD,EAAOC,QAAU,CAAC,UAAY,mCAAmC,MAAQ,iC,mBCAzED,EAAOC,QAAU,CAAC,UAAY,8BAA8B,MAAQ,4B,mBCApED,EAAOC,QAAU,CAAC,UAAY,+BAA+B,KAAO,6B","file":"static/js/main.1bf2ccef.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"feed_container__1womP\",\"content\":\"feed_content__3ZfI4\",\"orderList\":\"feed_orderList__1PpT4\",\"statistic\":\"feed_statistic__3GNTH\",\"statisticGrid\":\"feed_statisticGrid__1ZOHC\",\"statisticGridItem\":\"feed_statisticGridItem__1NvIS\",\"statisticGridItemTitle\":\"feed_statisticGridItemTitle__2ZEkO\",\"statisticGridItemList\":\"feed_statisticGridItemList__3K1R6\",\"statisticGridItemText\":\"feed_statisticGridItemText__36yxY\",\"success\":\"feed_success__3Grio\",\"error\":\"feed_error__3ukov\",\"skeletonOrder\":\"feed_skeletonOrder__lmqkO\",\"statisticTotalTitle\":\"feed_statisticTotalTitle__1TdDq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"profile_container__2srQK\",\"menu\":\"profile_menu__1__XZ\",\"menuItem\":\"profile_menuItem__lVgDN\",\"menuItemActive\":\"profile_menuItemActive__a_SQV\",\"menuFooter\":\"profile_menuFooter__27Xhl\",\"orderList\":\"profile_orderList__3X4Yq\",\"error\":\"profile_error__3jZER\",\"skeletonOrder\":\"profile_skeletonOrder__2z85r\"};","import {\n  TypedUseSelectorHook,\n  useDispatch as dispatchHook,\n  useSelector as selectorHook,\n} from \"react-redux\";\nimport { AppDispatch, RootState, AppThunk } from \"./types\";\n\nexport const useDispatch = () => dispatchHook<AppDispatch | AppThunk>();\nexport const useSelector: TypedUseSelectorHook<RootState> = selectorHook;\n","import {\n  useState,\n  useEffect,\n  useRef,\n  memo,\n  ImgHTMLAttributes,\n  RefObject,\n} from \"react\";\nimport cn from \"classnames\";\n\nimport styles from \"./lazy-image.module.css\";\n\nfunction useImageLoaded(src: string, ref: RefObject<HTMLDivElement>) {\n  const [isLoaded, setLoaded] = useState(false);\n\n  const loadImage = async (src: string) => {\n    if (!src) return;\n    const img = new Image();\n    img.src = src;\n\n    return new Promise((resolve, reject) => {\n      img.onload = () => resolve(src);\n      img.onerror = reject;\n    });\n  };\n\n  useEffect(() => {\n    if (ref.current === null || !src) {\n      return;\n    }\n\n    const el = ref.current;\n\n    const observer = new IntersectionObserver(\n      (entries, observer) => {\n        entries.forEach((entry) => {\n          // если элемент является наблюдаемым\n          if (entry.isIntersecting) {\n            loadImage(src).then(() => setLoaded(true));\n          }\n        });\n      },\n      {\n        threshold: 0,\n      }\n    );\n\n    observer.observe(el);\n\n    return () => observer.unobserve(el);\n  }, [isLoaded, src, ref]);\n\n  return isLoaded;\n}\n\ninterface ILazyImage extends ImgHTMLAttributes<HTMLImageElement> {\n  src: string;\n  responsive?: boolean;\n  className?: string;\n  width?: number;\n  height?: string;\n}\n\nconst LazyImage: React.FC<ILazyImage> = memo(\n  ({\n    src,\n    responsive = true,\n    className = \"\",\n    alt = \"\",\n    width = 250,\n    height = \"50%\",\n    ...props\n  }) => {\n    const ref = useRef<HTMLDivElement>(null);\n    const imageLoaded = useImageLoaded(src, ref);\n    const style = {\n      \"--img-width\": `${width}px`,\n      \"--img-height\": height,\n    } as React.CSSProperties;\n    return (\n      <>\n        {imageLoaded ? (\n          <img\n            className={cn(className, { [styles.imageResponsive]: responsive })}\n            src={src}\n            {...(responsive ? {} : { width })}\n            alt={alt}\n            {...props}\n          />\n        ) : (\n          <div\n            className={cn(styles.imagePreloader, className, {\n              [styles.imagePreloaderResponsive]: responsive,\n            })}\n            ref={ref}\n            style={style}\n          ></div>\n        )}\n      </>\n    );\n  }\n);\n\nexport default LazyImage;\n","import { useEffect, useRef, useState } from \"react\";\n\nexport function getCookie(name: string) {\n  const matches = document.cookie.match(\n    new RegExp(\n      \"(?:^|; )\" + name.replace(/([.$?*|{}()[]\\\\\\/+^])/g, \"\\\\$1\") + \"=([^;]*)\"\n    )\n  );\n  return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nexport function setCookie(\n  name: string,\n  value: string,\n  props: {\n    expires?: number | Date | string;\n    path?: string;\n  } = {}\n) {\n  let exp = props.expires;\n  if (typeof exp == \"number\" && exp) {\n    const d = new Date();\n    d.setTime(d.getTime() + exp * 1000);\n    exp = props.expires = d;\n  }\n  if (exp && exp instanceof Date) {\n    props.expires = exp.toUTCString();\n  }\n  props.path = \"/\";\n  value = encodeURIComponent(value);\n  let updatedCookie = name + \"=\" + value;\n  for (const propName in props) {\n    updatedCookie += \"; \" + propName;\n    const propValue = (props as { [key: string]: string | boolean })[propName];\n    if (propValue !== true) {\n      updatedCookie += \"=\" + propValue;\n    }\n  }\n  document.cookie = updatedCookie;\n}\n\nexport function deleteCookie(name: string) {\n  setCookie(name, \"\", { expires: -1 });\n}\n\nexport function isEqual(obj1: any, obj2: any) {\n  // Цикл через свойства объекта obj1\n  for (const p in obj1) {\n    //Проверка на то, что оба объекта существуют\n    if (obj1.hasOwnProperty(p) !== obj2.hasOwnProperty(p)) return false;\n\n    switch (typeof obj1[p]) {\n      // Глубокое сравнение объектов по ключам и значения:\n      case \"object\":\n        if (!isEqual(obj1[p], obj2[p])) return false;\n        break;\n      // Сравнение данных типа function:\n      case \"function\":\n        if (\n          typeof obj2[p] == \"undefined\" ||\n          (p !== \"compare\" && obj1[p].toString() !== obj2[p].toString())\n        )\n          return false;\n        break;\n      // Сравнение значений:\n      default:\n        if (obj1[p] !== obj2[p]) return false;\n    }\n  }\n\n  // Проверка объекта obj2 на дополнительные свойства:\n  for (const p in obj2) {\n    if (typeof obj1[p] == \"undefined\") return false;\n  }\n  return true;\n}\n\n/**\n * Склонение существительного с числом\n * @param {*} n число\n * @param {Array} text_forms существительной в формате [один, два, пять]\n * @returns\n */\nfunction declensionOfNum(n: number, text_forms: [string, string, string]) {\n  n = Math.abs(n) % 100;\n  var n1 = n % 10;\n  if (n > 10 && n < 20) {\n    return text_forms[2];\n  }\n  if (n1 > 1 && n1 < 5) {\n    return text_forms[1];\n  }\n  if (n1 === 1) {\n    return text_forms[0];\n  }\n  return text_forms[2];\n}\n\nexport function formatPastDate(dateStr: string) {\n  const today = new Date();\n  today.setHours(0);\n  today.setMinutes(0);\n  today.setSeconds(0);\n\n  const date = new Date(dateStr);\n  const timezone = date.getHours() - date.getUTCHours();\n  const hours = date.getHours().toString().padStart(2, \"0\");\n  const minutes = date.getMinutes().toString().padStart(2, \"0\");\n\n  let past = \"\";\n\n  if (date.getTime() > today.getTime() + 24 * 3600 * 1000) {\n    past = date.toLocaleDateString();\n  } else if (date > today) {\n    past = \"Сегодня\";\n  } else if (date.getTime() > today.getTime() - 24 * 3600 * 1000) {\n    past = \"Вчера\";\n  } else {\n    const days = Math.ceil(\n      (today.getTime() - date.getTime()) / (24 * 3600 * 1000)\n    );\n    past = `${days} ${declensionOfNum(days, [\"день\", \"дня\", \"дней\"])} назад`;\n  }\n\n  return `${past}, ${hours}:${minutes} i-GMT${\n    timezone > 0 ? \"+\" : \"\"\n  }${timezone}`;\n}\n\nexport const timingFunctions = {\n  linear(k: number) {\n    return k;\n  },\n  easeIn(k: number) {\n    return Math.pow(k, 1.675);\n  },\n  easeOut(k: number) {\n    return 1 - Math.pow(1 - k, 1.675);\n  },\n  easeInOut(k: number) {\n    return 0.5 * (Math.sin((k - 0.5) * Math.PI) + 1);\n  },\n};\n\ninterface IAnimateProps {\n  timing?: keyof typeof timingFunctions;\n  draw: (step: number) => void;\n  duration: number;\n}\n\nexport function animate({\n  timing = \"easeInOut\",\n  draw,\n  duration,\n}: IAnimateProps) {\n  const start = performance.now();\n  const timingFunc = timingFunctions[timing];\n\n  return new Promise((resolve) => {\n    requestAnimationFrame(function animate(time) {\n      // timeFraction изменяется от 0 до 1\n      let timeFraction = (time - start) / duration;\n      if (timeFraction > 1) timeFraction = 1;\n      if (timeFraction < 0) timeFraction = 0;\n\n      // вычисление текущего состояния анимации\n      const progress = timingFunc(timeFraction);\n\n      draw(progress); // отрисовать её\n\n      if (timeFraction < 1) {\n        requestAnimationFrame(animate);\n      } else {\n        resolve(true);\n      }\n    });\n  });\n}\n\n// Хук: получаем предыдущее значение пропса или состояния\nexport function usePrevious(value: any) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n  return ref.current;\n}\n\nexport function isTouchDevice() {\n  return (\n    \"ontouchstart\" in window ||\n    navigator.maxTouchPoints > 0 ||\n    navigator.msMaxTouchPoints > 0\n  );\n}\n\n/**\n * Хук назначает выполнение callback на событие изменения ширины экрана с определенной оптимизацией\n * @param callback Функция для выполнения при изменении ширины экрана\n * @param props Пропсы, при изменении которых происходит сброс\n */\nexport function useWindowResize(callback: Function, props?: any[]) {\n  let running = false;\n\n  function run() {\n    callback();\n    running = false;\n  }\n\n  function onResize() {\n    if (!running) {\n      running = true;\n\n      if (window.requestAnimationFrame) {\n        window.requestAnimationFrame(run);\n      } else {\n        setTimeout(run, 66);\n      }\n    }\n  }\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", onResize);\n\n    return function cleanup() {\n      window.removeEventListener(\"resize\", onResize);\n    };\n  }, props);\n}\n\nexport const getScreenSize = () => {\n  const width = window.innerWidth;\n  if (width < 768) {\n    return \"mobile\";\n  } else if (width < 1024) {\n    return \"tablet\";\n  }\n  return \"desktop\";\n};\n\nexport function useScreenSize() {\n  const [screenSize, setScreenSize] = useState(getScreenSize());\n\n  useWindowResize(() => {\n    setScreenSize(getScreenSize());\n  }, []);\n\n  return screenSize;\n}\n","import styles from \"./ingredient.module.css\";\n\nimport { memo } from \"react\";\nimport cn from \"classnames\";\nimport {\n  Counter,\n  CurrencyIcon,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport { useDrag } from \"react-dnd\";\nimport { IIngredient } from \"../../../services/types/data\";\nimport LazyImage from \"../../lazy-image/lazy-image\";\nimport { useScreenSize } from \"../../../services/utils\";\n\ninterface IIngredientProps {\n  className?: string;\n  onClick?: (e: React.MouseEvent, item: IIngredient) => void;\n  item: IIngredient;\n  count?: number;\n}\n\nconst Ingredient: React.FC<IIngredientProps> = memo(\n  ({ className, item, count = 0, onClick = () => {} }) => {\n    const { name, price, image } = item;\n    const handleClick = (e: React.MouseEvent) => onClick(e, item);\n    const [, dragRef] = useDrag(() => ({\n      type: \"ingredient\",\n      item,\n    }));\n\n    const screenSize = useScreenSize();\n\n    return (\n      <div\n        className={cn(styles.container, className)}\n        onClick={handleClick}\n        ref={dragRef}\n        data-test-id={`ingredient-${item._id}`}\n      >\n        {count > 0 && (\n          <Counter\n            count={count}\n            size={screenSize === \"desktop\" ? \"default\" : \"small\"}\n          />\n        )}\n        <LazyImage src={image} className={\"mb-1\"} alt={name} width={240} />\n        <p className={cn(styles.price, \"text text_type_digits-default mb-1\")}>\n          <span className=\"mr-2\">{price}</span>\n          <CurrencyIcon type=\"primary\" />\n        </p>\n        <p className={cn(styles.title, \"text text_type_main-default\")}>\n          {name}\n        </p>\n      </div>\n    );\n  }\n);\n\nexport default Ingredient;\n","import cn from \"classnames\";\n\nimport styles from \"./skeleton.module.css\";\n\ninterface ISkeletonProps {\n  width?: number | string;\n  height?: number | string;\n  className?: string;\n  circle?: boolean;\n  repeat?: number;\n  tag?: keyof JSX.IntrinsicElements;\n}\n\nconst Skeleton: React.FC<ISkeletonProps> = ({\n  width,\n  height,\n  className,\n  circle = false,\n  repeat = 1,\n  tag: Tag = \"div\",\n}) => {\n  const style = {\n    ...(width ? { width } : {}),\n    ...(circle ? { height: width } : {}),\n    ...(height ? { height } : {}),\n  };\n\n  const classNameTotal = cn(styles.skeleton, className, {\n    [styles.circle]: circle,\n  });\n\n  if (repeat > 1) {\n    return (\n      <>\n        {Array(repeat)\n          .fill(null)\n          .map((item, index) => (\n            <Tag key={index} className={classNameTotal} style={{ ...style }}>\n              &nbsp;\n            </Tag>\n          ))}\n      </>\n    );\n  }\n\n  return (\n    <Tag className={classNameTotal} style={{ ...style }}>\n      &nbsp;\n    </Tag>\n  );\n};\n\nexport default Skeleton;\n","import { RefObject, useLayoutEffect } from \"react\";\nimport appStyles from \"../components/app/app.module.css\";\nimport { useWindowResize } from \"./utils\";\n\ninterface IUseScrollbarExtraParams {\n  exclude?: RefObject<HTMLElement> | RefObject<HTMLElement>[];\n  props?: any[];\n  maxHeight?: number;\n  isInModal?: boolean;\n}\n\nexport function useScrollbar(\n  ref: RefObject<HTMLElement>,\n  {\n    exclude = [],\n    props = [],\n    maxHeight,\n    isInModal,\n  }: IUseScrollbarExtraParams = {}\n) {\n  let arrExclude: RefObject<HTMLElement>[];\n\n  if (exclude instanceof Array) {\n    arrExclude = exclude;\n  } else {\n    arrExclude = [exclude];\n  }\n\n  const updateScrollbar = () => {\n    const el = ref.current;\n\n    if (!el) return;\n\n    const bottom = arrExclude.reduce((acc, ref) => {\n      const el = ref.current;\n      if (!el) return acc;\n      const style = getComputedStyle(el);\n\n      return (\n        acc +\n        el.offsetHeight +\n        parseInt(style.marginTop) +\n        parseInt(style.marginBottom)\n      );\n    }, 0);\n    const modalFix = isInModal ? \"(5vh + 41px)\" : \"0px\";\n    const { top } = el.getBoundingClientRect();\n    const aroundSpace = `(${modalFix} + ${Math.ceil(top + bottom)}px)`;\n    if (maxHeight) {\n      el.style.maxHeight = `calc(min(100vh - ${aroundSpace}, \n      ${maxHeight}px))`;\n    } else {\n      el.style.maxHeight = `calc(100vh - ${aroundSpace})`;\n    }\n    el.classList.add(appStyles.customScrollbar);\n  };\n\n  useLayoutEffect(() => {\n    updateScrollbar();\n    return () => {\n      const el = ref.current;\n      if (!el) return;\n      el.classList.remove(appStyles.customScrollbar);\n      el.style.maxHeight = \"\";\n    };\n  }, [ref, maxHeight, isInModal, arrExclude, ...props]);\n\n  useWindowResize(updateScrollbar, [\n    ref,\n    maxHeight,\n    isInModal,\n    arrExclude,\n    ...props,\n  ]);\n}\n","import { IIngredient, IOrder, IUser } from \"./types/data\";\nimport { getCookie, setCookie, deleteCookie } from \"./utils\";\n\ninterface IDataResponse {\n  success: boolean;\n  message?: string;\n}\n\nconst API_URL = \"https://norma.nomoreparties.space/api\";\nexport const routes = {\n  ingredients: `${API_URL}/ingredients`,\n  orders: `${API_URL}/orders`,\n  auth: {\n    login: `${API_URL}/auth/login`,\n    register: `${API_URL}/auth/register`,\n    logout: `${API_URL}/auth/logout`,\n    token: `${API_URL}/auth/token`,\n    user: `${API_URL}/auth/user`,\n  },\n  password: {\n    resetCheck: `${API_URL}/password-reset`,\n    reset: `${API_URL}/password-reset/reset`,\n  },\n};\n\nfunction translate(msg?: string) {\n  switch (msg) {\n    case \"email or password are incorrect\":\n      return \"Введены неверные Email или пароль\";\n    case \"Incorrect reset token\":\n      return \"Неверный токен для сброса пароля\";\n    default:\n      return msg;\n  }\n}\n\nasync function checkResponse<IData = object>(res: Response) {\n  let json: (IDataResponse & IData) | null = null;\n  try {\n    json = await res.json();\n  } catch (ex) {}\n\n  if (json && !json.success) {\n    json.message = translate(json.message);\n    throw json;\n  }\n\n  if (!res.ok) {\n    throw new Error(`Статус: ${res.status}`);\n  }\n\n  if (!json) {\n    throw new Error(`Ошибка парсинга ответа`);\n  }\n\n  return json;\n}\n\nasync function fetchPost<IData>(url: string, params: object) {\n  const res = await fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(params),\n  });\n\n  return checkResponse<IData>(res);\n}\n\nfunction setTokens({\n  accessToken,\n  refreshToken,\n}: {\n  accessToken: string;\n  refreshToken: string;\n}) {\n  if (accessToken) {\n    accessToken = accessToken.split(\"Bearer \")[1];\n    setCookie(\"accessToken\", accessToken);\n  }\n  localStorage.setItem(\"refreshToken\", refreshToken);\n}\n\nexport async function refreshToken() {\n  const data = await fetchPost<{\n    accessToken: string;\n    refreshToken: string;\n  }>(routes.auth.token, {\n    token: localStorage.getItem(\"refreshToken\"),\n  });\n  setTokens(data);\n  return data;\n}\n\nasync function fetchWithRefresh<IData>(\n  url: string,\n  { params = {}, method = \"GET\" } = {}\n): Promise<IData> {\n  try {\n    const options: RequestInit = {\n      method,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + getCookie(\"accessToken\"),\n      },\n    };\n    if (method !== \"GET\") {\n      options.body = JSON.stringify(params);\n    }\n\n    const res = await fetch(url, options);\n    return await checkResponse<IData>(res);\n  } catch (err) {\n    if (err.message === \"jwt expired\") {\n      await refreshToken();\n      return fetchWithRefresh<IData>(url, { params, method });\n    } else {\n      throw err;\n    }\n  }\n}\n\nexport async function loadIngredients() {\n  const res = await fetch(routes.ingredients);\n  const json = await checkResponse<{ data: IIngredient[] }>(res);\n  return json.data;\n}\n\nexport async function checkoutOrder(items: string[] = []) {\n  return await fetchWithRefresh<{ order: IOrder }>(routes.orders, {\n    method: \"POST\",\n    params: { ingredients: items },\n  });\n}\n\nexport async function login(params: { email: string; password: string }) {\n  const data = await fetchPost<{\n    refreshToken: string;\n    accessToken: string;\n    user: IUser;\n  }>(routes.auth.login, params);\n  setTokens(data);\n  return data;\n}\n\nexport async function logout() {\n  const data = await fetchPost(routes.auth.logout, {\n    token: localStorage.getItem(\"refreshToken\"),\n  });\n  deleteCookie(\"accessToken\");\n  localStorage.removeItem(\"refreshToken\");\n  return data;\n}\n\nexport async function register(params: {\n  email: string;\n  password: string;\n  name: string;\n}) {\n  return await fetchPost(routes.auth.register, params);\n}\n\nexport async function checkResetPassword(params: { email: string }) {\n  return await fetchPost(routes.password.resetCheck, params);\n}\n\nexport async function resetPassword(params: {\n  password: string;\n  token: string;\n}) {\n  return await fetchPost(routes.password.reset, params);\n}\n\nexport async function loadUser() {\n  return await fetchWithRefresh<{ user: IUser }>(routes.auth.user);\n}\n\nexport async function updateUser(params: {\n  email: string;\n  password: string;\n  name: string;\n}) {\n  return await fetchWithRefresh<{ user: IUser }>(routes.auth.user, {\n    method: \"PATCH\",\n    params,\n  });\n}\n\nexport async function loadOrderById(id: string) {\n  const res = await fetch(`${routes.orders}/${id}`);\n  const json = await checkResponse<{ orders: IOrder[] }>(res);\n  return json.orders[0];\n}\n","import { loadIngredients } from \"../api\";\nimport { AppDispatch, AppThunk } from \"../types\";\nimport { IIngredient } from \"../types/data\";\n\nexport const GET_INGREDIENTS_REQUEST: \"GET_INGREDIENTS_REQUEST\" =\n  \"GET_INGREDIENTS_REQUEST\";\nexport const GET_INGREDIENTS_SUCCESS: \"GET_INGREDIENTS_SUCCESS\" =\n  \"GET_INGREDIENTS_SUCCESS\";\nexport const GET_INGREDIENTS_ERROR: \"GET_INGREDIENTS_ERROR\" =\n  \"GET_INGREDIENTS_ERROR\";\n\nexport type IGetIngredientsRequestAction = {\n  readonly type: typeof GET_INGREDIENTS_REQUEST;\n};\n\nexport interface IGetIngredientsSuccessAction {\n  readonly type: typeof GET_INGREDIENTS_SUCCESS;\n  readonly items: IIngredient[];\n}\n\nexport interface IGetIngredientsErrorAction {\n  readonly type: typeof GET_INGREDIENTS_ERROR;\n  readonly message: string;\n}\n\nexport type TIngredientsActions =\n  | IGetIngredientsRequestAction\n  | IGetIngredientsSuccessAction\n  | IGetIngredientsErrorAction;\n\nexport const getIngredients: AppThunk = () => async (dispatch: AppDispatch) => {\n  dispatch({\n    type: GET_INGREDIENTS_REQUEST,\n  });\n  try {\n    const items = await loadIngredients();\n    dispatch({\n      type: GET_INGREDIENTS_SUCCESS,\n      items,\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_INGREDIENTS_ERROR,\n      message: err.message,\n    });\n  }\n};\n","import styles from \"./burger-ingredients.module.css\";\n\nimport { useState, useRef, useEffect, useLayoutEffect, useMemo } from \"react\";\nimport { useSelector, useDispatch } from \"../../services/hooks\";\nimport { useLocation, Link } from \"react-router-dom\";\nimport cn from \"classnames\";\nimport { Tab } from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport Ingredient from \"./ingredient/ingredient\";\nimport Skeleton from \"../skeleton/skeleton\";\nimport { animate } from \"../../services/utils\";\nimport { useScrollbar } from \"../../services/scrollbar\";\n\nimport { getIngredients } from \"../../services/actions/ingredients\";\n\nconst GROUP_NAME = {\n  bun: \"Булки\",\n  sauce: \"Соусы\",\n  main: \"Начинки\",\n};\n\nconst BurgerIngredients: React.FC = () => {\n  const [currentTab, setCurrentTab] = useState(\"bun\");\n\n  const dispatch = useDispatch();\n  const location = useLocation();\n\n  const {\n    items: ingredients,\n    itemsErrorMessage: error,\n    itemsRequest: loading,\n  } = useSelector((store) => store.ingredients);\n\n  const { items: constructorItems, bunItem } = useSelector(\n    (store) => store.construct\n  );\n\n  const ingredientsRef = useRef<HTMLUListElement>(null);\n  useScrollbar(ingredientsRef);\n\n  const counterMap = useMemo(\n    () =>\n      ingredients.reduce((map: { [key: string]: number }, item) => {\n        if (bunItem && item._id === bunItem._id) {\n          map[item._id] = 2;\n          return map;\n        }\n\n        map[item._id] = constructorItems.filter(\n          ({ _id }) => _id === item._id\n        ).length;\n        return map;\n      }, {}),\n    [ingredients, constructorItems, bunItem]\n  );\n\n  useLayoutEffect(() => {\n    if (ingredients.length === 0) {\n      dispatch(getIngredients());\n    }\n  }, [dispatch, ingredients.length]);\n\n  const scrollToTabSection = (tab: string) => {\n    const el = ingredientsRef.current;\n\n    if (!el) {\n      return;\n    }\n\n    const section: HTMLElement | null = el.querySelector(\n      `[data-group=\"${tab}\"]`\n    );\n    const startScroll = el.scrollTop;\n    const endScroll = section?.offsetTop || 0;\n\n    animate({\n      draw(progress) {\n        el.scrollTop = startScroll + (endScroll - startScroll) * progress;\n      },\n      duration: 400,\n    });\n  };\n\n  useEffect(() => {\n    const root = ingredientsRef.current;\n    if (!root) {\n      return;\n    }\n    const height = root.offsetHeight;\n    const observer = new IntersectionObserver(\n      (entries, observer) => {\n        entries.forEach((entry) => {\n          // если элемент является наблюдаемым\n          if (entry.isIntersecting) {\n            const section = entry.target as HTMLElement;\n            setCurrentTab(section.dataset.group || \"bun\");\n          }\n        });\n      },\n      {\n        root,\n        rootMargin: `-130px 0px ${130 - height}px 0px`,\n      }\n    );\n\n    const sections = root.querySelectorAll(\"[data-group]\");\n    sections.forEach((section) => observer.observe(section));\n\n    return () => sections.forEach((section) => observer.unobserve(section));\n  }, [ingredients]);\n\n  const skeleton = useMemo(\n    () => (\n      <ul\n        className={cn(styles.ingredients, \"mt-10\")}\n        data-test-id=\"ingredients-skeleton\"\n      >\n        <li>\n          <Skeleton width={100} className=\"text text_type_main-medium\" />\n          <div className={cn(styles.ingredientList, \"pl-4 pr-4 pt-6 pb-2\")}>\n            <Skeleton\n              height={200}\n              repeat={2}\n              className={cn(styles.ingredient, \"mb-8 mt-4\")}\n            />\n          </div>\n        </li>\n      </ul>\n    ),\n    []\n  );\n\n  return (\n    <section className={cn(styles.container)}>\n      <h1 className={cn(\"text text_type_main-large\", styles.title)}>\n        Соберите бургер\n      </h1>\n      <section className={styles.tabs}>\n        {Object.entries(GROUP_NAME).map(([key, value]) => {\n          return (\n            <Tab\n              key={key}\n              value={key}\n              active={key === currentTab}\n              onClick={() => scrollToTabSection(key)}\n            >\n              {value}\n            </Tab>\n          );\n        })}\n      </section>\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default mt-15\")}>\n          Что-то пошло не так. Попробуйте зайти еще раз позже. {error}\n        </p>\n      )}\n      {loading && skeleton}\n      <ul className={cn(styles.ingredients, \"mt-10\")} ref={ingredientsRef}>\n        {useMemo(\n          () =>\n            ingredients.length > 0 &&\n            Object.entries(GROUP_NAME).map(([key, value]) => {\n              return (\n                <li key={key} data-group={key}>\n                  <h2 className=\"text text_type_main-medium\">{value}</h2>\n                  <ul className={cn(styles.ingredientList)}>\n                    {ingredients\n                      .filter(({ type }) => type === key)\n                      .map((item, index) => {\n                        return (\n                          <li className={cn(styles.ingredient)} key={item._id}>\n                            <Link\n                              to={{\n                                pathname: `/ingredients/${item._id}`,\n                                state: { background: location },\n                              }}\n                            >\n                              <Ingredient\n                                count={counterMap[item._id]}\n                                item={item}\n                              />\n                            </Link>\n                          </li>\n                        );\n                      })}\n                  </ul>\n                </li>\n              );\n            }),\n          [location, ingredients, counterMap]\n        )}\n      </ul>\n    </section>\n  );\n};\n\nexport default BurgerIngredients;\n","export default __webpack_public_path__ + \"static/media/done.7341dd32.svg\";","import cn from \"classnames\";\nimport statusIcon from \"../../images/done.svg\";\n\nimport styles from \"./order-details.module.css\";\n\ninterface IOrderDetailsProps {\n  orderNumber: number;\n}\n\nconst OrderDetails: React.FC<IOrderDetailsProps> = ({ orderNumber }) => {\n  return (\n    <div className={cn(styles.container, \"pl-15 pr-15 pb-20\")}>\n      <h1 className={cn(styles.title, \"text text_type_digits-large mt-4 mb-8\")}>\n        {orderNumber}\n      </h1>\n      <p className=\"text text_type_main-medium mb-15\">Идентификатор заказа</p>\n      <img\n        width=\"120\"\n        height=\"120\"\n        src={statusIcon}\n        alt=\"Заказ зарегистрирован\"\n      />\n      <p className=\"text text_type_main-default mt-15 mb-2\">\n        Ваш заказ начали готовить\n      </p>\n      <p className=\"text text_type_main-default text_color_inactive\">\n        Дождитесь готовности на орбитальной станции\n      </p>\n    </div>\n  );\n};\n\nexport default OrderDetails;\n","import cn from \"classnames\";\nimport styles from \"./modal-overlay.module.css\";\n\ninterface IModalOverlayProps {\n  visible?: boolean;\n  onClose?: () => void;\n}\n\nconst ModalOverlay: React.FC<IModalOverlayProps> = ({\n  visible = false,\n  onClose = () => {},\n}) => {\n  return (\n    <div\n      className={cn(styles.container, { [styles.hidden]: !visible })}\n      onClick={onClose}\n    ></div>\n  );\n};\n\nexport default ModalOverlay;\n","import { useEffect, useRef, memo, ReactNode } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport cn from \"classnames\";\nimport { CloseIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport styles from \"./modal.module.css\";\n\nimport ModalOverlay from \"../modal-overlay/modal-overlay\";\n\nconst modalRoot = document.getElementById(\"react-modals\") as HTMLElement;\nconst ESC_KEY = \"Escape\";\n\nconst visibleModals: React.MutableRefObject<undefined>[] = [];\n\ninterface IModalProps {\n  children: ReactNode;\n  header?: ReactNode;\n  visible?: boolean;\n  onClose?: () => void;\n}\nconst Modal: React.FC<IModalProps> = memo(\n  ({ children, header = \"\", visible = false, onClose }) => {\n    const modal = useRef();\n    const closeVisible = !!onClose;\n\n    useEffect(() => {\n      if (visible) {\n        visibleModals.push(modal);\n      } else {\n        const index = visibleModals.indexOf(modal);\n        visibleModals.splice(index, 1);\n      }\n    }, [visible]);\n\n    // Если открыто несколько модальных окон, закрываем по ESC только самое верхнее\n    useEffect(() => {\n      const keyDownHandler = (e: KeyboardEvent) => {\n        if (\n          e.key === ESC_KEY &&\n          visibleModals[visibleModals.length - 1] === modal &&\n          onClose\n        ) {\n          onClose();\n        }\n      };\n\n      if (visible) {\n        document.addEventListener(\"keydown\", keyDownHandler);\n      }\n\n      return () => {\n        document.removeEventListener(\"keydown\", keyDownHandler);\n      };\n    }, [onClose, visible]);\n\n    return createPortal(\n      <>\n        <ModalOverlay visible={visible} onClose={onClose} />\n        <div\n          className={cn(styles.container, \"pt-10 pl-10 pr-10 pb-10\", {\n            [styles.hidden]: !visible,\n          })}\n        >\n          <h1 className={cn(styles.title, \"text text_type_main-large pr-7\")}>\n            {header}\n          </h1>\n          {closeVisible && (\n            <div className={styles.closeButton}>\n              <CloseIcon type=\"primary\" onClick={onClose} />\n            </div>\n          )}\n          <section className={cn(styles.content)}>{children}</section>\n        </div>\n      </>,\n      modalRoot\n    );\n  }\n);\n\nexport default Modal;\n","import cn from \"classnames\";\n\nimport styles from \"./spinner.module.css\";\n\ninterface ISpinnerProps {\n  size?: number;\n  stroke?: number;\n  className?: string;\n  center?: boolean;\n}\n\nconst Spinner: React.FC<ISpinnerProps> = ({\n  size = 50,\n  stroke = 3,\n  className,\n  center = false,\n}) => {\n  const radius = 0.4 * size;\n\n  return (\n    <svg\n      className={cn(\n        styles.spinner,\n        { [styles.spinnerCenter]: center },\n        className\n      )}\n      style={{ width: size, height: size }}\n      viewBox={`0 0 ${size} ${size}`}\n    >\n      <circle\n        className={styles.circle}\n        cx={size / 2}\n        cy={size / 2}\n        r={radius}\n        fill=\"none\"\n        strokeWidth={stroke}\n      ></circle>\n    </svg>\n  );\n};\n\nexport default Spinner;\n","import { IIngredient, IConstructorIngredient } from \"../types/data\";\n\nexport const ADD_CONSTRUCTOR_INGREDIENT: \"ADD_CONSTRUCTOR_INGREDIENT\" =\n  \"ADD_CONSTRUCTOR_INGREDIENT\";\nexport const REMOVE_CONSTRUCTOR_INGREDIENT: \"REMOVE_CONSTRUCTOR_INGREDIENT\" =\n  \"REMOVE_CONSTRUCTOR_INGREDIENT\";\nexport const REORDER_CONSTRUCTOR_INGREDIENTS: \"REORDER_CONSTRUCTOR_INGREDIENTS\" =\n  \"REORDER_CONSTRUCTOR_INGREDIENTS\";\nexport const CLEAR_CONSTRUCTOR: \"CLEAR_CONSTRUCTOR\" = \"CLEAR_CONSTRUCTOR\";\n\nexport interface IAddConstructorIngredientAction {\n  readonly type: typeof ADD_CONSTRUCTOR_INGREDIENT;\n  readonly item: IIngredient;\n}\n\nexport interface IRemoveConstructorIngredientAction {\n  readonly type: typeof REMOVE_CONSTRUCTOR_INGREDIENT;\n  readonly item: IConstructorIngredient;\n}\n\nexport interface IReorderConstructorIngredientsAction {\n  readonly type: typeof REORDER_CONSTRUCTOR_INGREDIENTS;\n  readonly dropIndex: number;\n  readonly hoverIndex: number;\n}\n\nexport interface IClearConstructorAction {\n  readonly type: typeof CLEAR_CONSTRUCTOR;\n}\n\nexport type TConstructorActions =\n  | IAddConstructorIngredientAction\n  | IRemoveConstructorIngredientAction\n  | IReorderConstructorIngredientsAction\n  | IClearConstructorAction;\n","import { RefObject, useEffect, useRef, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport cn from \"classnames\";\nimport {\n  ConstructorElement,\n  DragIcon,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport { useDrag, useDrop } from \"react-dnd\";\n\nimport { REORDER_CONSTRUCTOR_INGREDIENTS } from \"../../../services/actions/constructor\";\nimport { animate, usePrevious, useScreenSize } from \"../../../services/utils\";\nimport { IConstructorIngredient } from \"../../../services/types/data\";\n\nimport styles from \"./drag-element.module.css\";\n\ninterface IDragElementProps {\n  item: IConstructorIngredient;\n  index: number;\n  onDelete: (\n    item: IConstructorIngredient,\n    ref: RefObject<HTMLLIElement>\n  ) => void;\n}\n\nconst DragElement: React.FC<IDragElementProps> = ({\n  item,\n  index,\n  onDelete = () => {},\n}) => {\n  const dispatch = useDispatch();\n  const ref = useRef<HTMLLIElement>(null);\n  const [isHoverTop, setHoverTop] = useState(false);\n  const [isTransition, setTransition] = useState(false);\n\n  const element = ref.current?.querySelector(\".constructor-element\");\n\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) {\n      return;\n    }\n    el.style.opacity = \"0\";\n    animate({\n      draw(progress) {\n        el.style.opacity = `${progress}`;\n      },\n      duration: 500,\n      timing: \"easeOut\",\n    });\n  }, []);\n\n  const [{ isDrag }, dragTargetRef] = useDrag({\n    type: \"constructorItem\",\n    item: () => {\n      return { id: item._id, index };\n    },\n    collect: (monitor) => ({\n      isDrag: monitor.isDragging(),\n    }),\n  });\n\n  const [{ isOver, didDrop }, dropTargetRef] = useDrop({\n    accept: \"constructorItem\",\n    drop(item: { id: string; index: number }) {\n      const hoverIndex = index - (isHoverTop ? 1 : 0);\n      const dropIndex = item.index;\n      setTransition(false);\n\n      if (dropIndex === hoverIndex) {\n        return;\n      }\n\n      dispatch({\n        type: REORDER_CONSTRUCTOR_INGREDIENTS,\n        dropIndex,\n        hoverIndex,\n      });\n      item.index = hoverIndex;\n    },\n    hover(item, monitor) {\n      if (!element) return;\n      setTransition(true);\n      const clientRect = element.getBoundingClientRect();\n      const offset = monitor.getSourceClientOffset() || { y: 0 };\n      setHoverTop(offset.y <= clientRect.y);\n    },\n    collect: (monitor) => ({\n      isOver: monitor.isOver(),\n      didDrop: monitor.didDrop(),\n    }),\n  });\n\n  const prevIsDrag = usePrevious(isDrag);\n  const prevIsOver = usePrevious(isOver);\n\n  const overLeave = prevIsOver && !isOver;\n  const dragLeave = prevIsDrag && !isDrag;\n\n  const height = ref.current?.getBoundingClientRect().height || 0;\n\n  dragTargetRef(dropTargetRef(ref));\n\n  const screenSize = useScreenSize();\n  const padding = screenSize === \"desktop\" ? 16 : 0;\n  const defHeight = screenSize === \"desktop\" ? 80 : 56;\n\n  return (\n    <li\n      className={cn(styles.container)}\n      ref={ref}\n      style={{\n        opacity: isDrag ? 0 : 1,\n        display: dragLeave && didDrop ? \"none\" : \"\",\n        marginTop: isDrag && overLeave ? -height : 0,\n        paddingBottom:\n          !isDrag && isOver && !isHoverTop ? defHeight + padding * 2 : padding,\n        paddingTop: !isDrag && isOver && isHoverTop ? defHeight + padding : 0,\n        transitionDuration: isTransition ? \"0.3s\" : \"0s\",\n      }}\n      data-test-id={`ctr-item-${item._id}`}\n    >\n      <i className={cn(styles.dragItem)}>\n        <DragIcon type=\"primary\" />\n      </i>\n      <ConstructorElement\n        text={item.name}\n        price={item.price}\n        thumbnail={item.image}\n        handleClose={() => onDelete(item, ref)}\n      />\n    </li>\n  );\n};\n\nexport default DragElement;\n","import { checkoutOrder } from \"../api\";\nimport { AppDispatch, AppThunk } from \"../types\";\n\nexport const CHECKOUT_ORDER_REQUEST: \"CHECKOUT_ORDER_REQUEST\" =\n  \"CHECKOUT_ORDER_REQUEST\";\nexport const CHECKOUT_ORDER_SUCCESS: \"CHECKOUT_ORDER_SUCCESS\" =\n  \"CHECKOUT_ORDER_SUCCESS\";\nexport const CHECKOUT_ORDER_ERROR: \"CHECKOUT_ORDER_ERROR\" =\n  \"CHECKOUT_ORDER_ERROR\";\nexport const CLEAR_ORDER: \"CLEAR_ORDER\" = \"CLEAR_ORDER\";\n\nexport interface ICheckoutOrderRequestAction {\n  readonly type: typeof CHECKOUT_ORDER_REQUEST;\n}\n\nexport interface ICheckoutOrderSuccessAction {\n  readonly type: typeof CHECKOUT_ORDER_SUCCESS;\n  readonly number: number;\n}\n\nexport interface ICheckoutOrderErrorAction {\n  readonly type: typeof CHECKOUT_ORDER_ERROR;\n  readonly message: string;\n}\n\nexport interface IClearOrderAction {\n  readonly type: typeof CLEAR_ORDER;\n}\n\nexport type TOrderActions =\n  | ICheckoutOrderRequestAction\n  | ICheckoutOrderSuccessAction\n  | ICheckoutOrderErrorAction\n  | IClearOrderAction;\n\nexport const doCheckoutOrder: AppThunk =\n  () => async (dispatch: AppDispatch, getState) => {\n    const { bunItem, items } = getState().construct;\n\n    if (!bunItem) {\n      return dispatch({\n        type: CHECKOUT_ORDER_ERROR,\n        message: \"Для оформления заказа добавьте булку!\",\n      });\n    }\n\n    const ids = [bunItem._id, ...items.map((el) => el._id)];\n\n    dispatch({\n      type: CHECKOUT_ORDER_REQUEST,\n    });\n    try {\n      const data = await checkoutOrder(ids);\n      dispatch({\n        type: CHECKOUT_ORDER_SUCCESS,\n        number: data.order.number,\n      });\n    } catch (err) {\n      dispatch({\n        type: CHECKOUT_ORDER_ERROR,\n        message: err.message,\n      });\n    }\n  };\n","import { useState, useCallback, useRef, RefObject } from \"react\";\nimport { useSelector, useDispatch } from \"../../services/hooks\";\nimport { useHistory } from \"react-router-dom\";\nimport cn from \"classnames\";\nimport {\n  ConstructorElement,\n  Button,\n  CurrencyIcon,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport { useDrop } from \"react-dnd\";\n\nimport OrderDetails from \"../order-details/order-details\";\nimport Modal from \"../modal/modal\";\nimport Spinner from \"../spinner/spinner\";\nimport DragElement from \"./drag-element/drag-element\";\n\nimport { CHECKOUT_ORDER_ERROR } from \"../../services/actions/order\";\n\nimport { animate, useScreenSize } from \"../../services/utils\";\nimport { useScrollbar } from \"../../services/scrollbar\";\nimport { IConstructorIngredient } from \"../../services/types/data\";\n\nimport {\n  ADD_CONSTRUCTOR_INGREDIENT,\n  REMOVE_CONSTRUCTOR_INGREDIENT,\n  CLEAR_CONSTRUCTOR,\n} from \"../../services/actions/constructor\";\nimport { doCheckoutOrder, CLEAR_ORDER } from \"../../services/actions/order\";\nimport styles from \"./burger-constructor.module.css\";\n\nconst BurgerConstructor: React.FC = () => {\n  const [isOrderShown, setOrderShown] = useState(false);\n\n  const { bunItem, items, totalPrice } = useSelector(\n    (store) => store.construct\n  );\n\n  const {\n    number: orderNumber,\n    checkoutRequest: orderLoading,\n    checkoutErrorMessage: orderError,\n  } = useSelector((store) => store.order);\n\n  const dispatch = useDispatch();\n\n  const elementOnDelete = useCallback(\n    (item: IConstructorIngredient, ref: RefObject<HTMLLIElement>) => {\n      const el = ref.current;\n      if (!el) {\n        return;\n      }\n      const height = el.offsetHeight;\n      el.style.zIndex = \"-1\";\n      animate({\n        draw(progress) {\n          el.style.opacity = `${1 - progress}`;\n          el.style.marginTop = `-${height * progress}px`;\n        },\n        duration: 500,\n        timing: \"easeOut\",\n      }).then(() => dispatch({ type: REMOVE_CONSTRUCTOR_INGREDIENT, item }));\n    },\n    [dispatch]\n  );\n\n  const orderModalOnClose = useCallback(() => {\n    setOrderShown(false);\n    if (orderNumber) {\n      dispatch({ type: CLEAR_CONSTRUCTOR });\n      dispatch({ type: CLEAR_ORDER });\n    }\n  }, [dispatch, orderNumber]);\n\n  function handleCheckoutOrder() {\n    setOrderShown(true);\n    dispatch(doCheckoutOrder());\n  }\n\n  const [{ isOver, canDrop }, dropIngredientsRef] = useDrop(\n    () => ({\n      accept: \"ingredient\",\n      drop(item, monitor) {\n        dispatch({ type: ADD_CONSTRUCTOR_INGREDIENT, item });\n      },\n      collect: (monitor) => ({\n        isOver: monitor.isOver(),\n        canDrop: monitor.canDrop(),\n      }),\n    }),\n    [dispatch]\n  );\n\n  const listRef = useRef<HTMLUListElement>(null);\n  const bottomBunRef = useRef<HTMLLIElement>(null);\n  const footerRef = useRef<HTMLElement>(null);\n  useScrollbar(listRef, {\n    exclude: [bottomBunRef, footerRef],\n    props: [bunItem, items.length === 0],\n  });\n\n  const history = useHistory();\n  const screenSize = useScreenSize();\n\n  if (orderError === \"jwt malformed\") {\n    dispatch({\n      type: CHECKOUT_ORDER_ERROR,\n      message: \"\",\n    });\n    history.replace(\"/login\");\n    return null;\n  }\n\n  return (\n    <div\n      className={cn(styles.container)}\n      ref={dropIngredientsRef}\n      data-test-id=\"constructor-container\"\n    >\n      <ul className={styles.elements}>\n        {!bunItem && !items.length && (\n          <li\n            className={cn(\n              styles.dragMessage,\n              \"text text_type_main-medium pt-25 pb-25\",\n              {\n                [styles.dragMessageOver]: isOver,\n                text_color_inactive: !canDrop,\n              }\n            )}\n          >\n            Перетащите ингридиенты сюда\n          </li>\n        )}\n        {bunItem && (\n          <li className={styles.bunElementTop} data-test-id=\"ctr-bun-top\">\n            <ConstructorElement\n              type=\"top\"\n              isLocked={true}\n              text={`${bunItem.name} (верх)`}\n              price={bunItem.price}\n              thumbnail={bunItem.image}\n            />\n          </li>\n        )}\n        <li>\n          <ul className={cn(styles.elementsScroll, \"noselect\")} ref={listRef}>\n            {items.map((el, index) => {\n              return (\n                <DragElement\n                  key={el.key}\n                  item={el}\n                  index={index}\n                  onDelete={elementOnDelete}\n                />\n              );\n            })}\n          </ul>\n        </li>\n        {bunItem && (\n          <li\n            className={styles.bunElementBottom}\n            ref={bottomBunRef}\n            data-test-id=\"ctr-bun-bottom\"\n          >\n            <ConstructorElement\n              type=\"bottom\"\n              isLocked={true}\n              text={`${bunItem.name} (низ)`}\n              price={bunItem.price}\n              thumbnail={bunItem.image}\n            />\n          </li>\n        )}\n      </ul>\n      <footer className={cn(styles.footer)} ref={footerRef}>\n        <p className=\"text text_type_digits-medium mr-2\">{totalPrice}</p>\n        <p className={cn(\"text\", styles.footerCurrency)}>\n          <CurrencyIcon type=\"primary\" />\n        </p>\n        <Button\n          type=\"primary\"\n          size={screenSize === \"desktop\" ? \"large\" : \"small\"}\n          onClick={handleCheckoutOrder}\n        >\n          Оформить заказ\n        </Button>\n      </footer>\n      <Modal\n        header={orderError && \"Ошибка\"}\n        visible={isOrderShown}\n        onClose={orderLoading ? undefined : orderModalOnClose}\n      >\n        <>\n          {orderLoading && (\n            <div className={styles.center}>\n              <p className=\"text text_type_main-default mb-20 ml-25 mr-25\">\n                Оформляем заказ...\n              </p>\n              <Spinner className=\"mb-15\" />\n            </div>\n          )}\n          {orderError && (\n            <p className={cn(\"text text_type_main-default mt-5\", styles.error)}>\n              {orderError}\n            </p>\n          )}\n          {orderNumber && <OrderDetails orderNumber={orderNumber} />}\n        </>\n      </Modal>\n    </div>\n  );\n};\n\nexport default BurgerConstructor;\n","import { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport { TouchBackend } from \"react-dnd-touch-backend\";\n\nimport BurgerIngredients from \"../components/burger-ingredients/burger-ingredients\";\nimport BurgerConstructor from \"../components/burger-constructor/burger-constructor\";\n\nimport { isTouchDevice } from \"../services/utils\";\n\nexport function HomePage() {\n  return (\n    <DndProvider backend={isTouchDevice() ? TouchBackend : HTML5Backend}>\n      <BurgerIngredients />\n      <BurgerConstructor />\n    </DndProvider>\n  );\n}\n","import { useState, useCallback, useRef } from \"react\";\nimport { Input } from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport \"./password-input.module.css\";\n\ntype TPasswordInputProps = {\n  value: string;\n  onChange(e: React.ChangeEvent<HTMLInputElement>): void;\n} & typeof Input[\"defaultProps\"];\n\nconst PasswordInput: React.FC<TPasswordInputProps> = ({ ...props }) => {\n  const [isValueHidden, setValueHidden] = useState(true);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const handleIconClick = useCallback(() => {\n    setValueHidden(!isValueHidden);\n    const el = inputRef.current;\n    if (!el) {\n      return;\n    }\n    const pos = el.selectionStart;\n    setTimeout(() => {\n      el.focus();\n      el.setSelectionRange(pos || el.value.length, pos || el.value.length);\n    }, 0);\n  }, [isValueHidden]);\n\n  return (\n    <Input\n      {...props}\n      ref={inputRef}\n      type={isValueHidden ? \"password\" : \"text\"}\n      icon={isValueHidden ? \"ShowIcon\" : \"HideIcon\"}\n      onIconClick={handleIconClick}\n    />\n  );\n};\n\nexport default PasswordInput;\n","import { useState, useRef, useEffect, ChangeEvent, FormEvent } from \"react\";\n\nconst emailRegExp =\n  /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\ntype TValidationRuleNames = \"required\" | \"email\" | \"minLength\";\n\ninterface IValidationRuleParams<TParam = any> {\n  value: string;\n  param?: TParam;\n  message?: string;\n}\n\ntype TValidationRules = {\n  [key in TValidationRuleNames]: (params: IValidationRuleParams) => string;\n};\n\ntype TValidationRuleValue =\n  | boolean\n  | number\n  | {\n      param: boolean | number;\n      message?: string;\n    };\n\ntype TValidationRuleValues = {\n  [key in TValidationRuleNames]?: TValidationRuleValue;\n};\n\n// Правила валидации\nconst validationRules: TValidationRules = {\n  required: ({ value, message = \"Введите значение\" }) => {\n    return value && value.length > 0 ? \"\" : message;\n  },\n  email: ({ value, message = \"Введите корректный email\" }) => {\n    return emailRegExp.test(String(value).toLowerCase()) ? \"\" : message;\n  },\n  minLength: ({ value, param = 0, message }: IValidationRuleParams<number>) => {\n    message = message || `Введите не менее ${param} символов`;\n    return value.length >= param || value.length === 0 ? \"\" : message;\n  },\n};\n\n/**\n * Проверка значения в соответствии с правилами\n * @param value значение\n * @param rules правила\n * @returns Первое сообщение об ошибке или \"\", если без ошибок\n */\nfunction validate(value: string, rules: TValidationRuleValues): string {\n  if (!rules) return \"\";\n\n  const messages = Object.entries(rules).map(([ruleName, ruleParam]) => {\n    if (!ruleParam) return \"\";\n    return validationRules[ruleName as TValidationRuleNames]({\n      value,\n      param: typeof ruleParam === \"object\" ? ruleParam.param : ruleParam,\n      ...(typeof ruleParam === \"object\" ? { message: ruleParam.message } : {}),\n    });\n  });\n\n  return messages.filter((message) => !!message)[0] || \"\";\n}\n\n/**\n * Проверка всех значени в values в соотвествии с правилами rules\n * @param values\n * @param rules\n * @returns объект: ключ имя поля, значение - первое сообщение об ошибке\n */\nfunction validateAll(\n  values: { [name: string]: string },\n  rules: { [name: string]: TValidationRuleValues }\n) {\n  const errors: { [name: string]: string } = {};\n  for (const name of Object.keys(values)) {\n    errors[name] = validate(values[name], rules[name]);\n  }\n\n  return errors;\n}\n\n/**\n * Хук управляет отправкой данных формы,\n * проверяет клиентскую валидацию с помощью правил validation,\n * устанавливает значения полей по умолчанию defValues\n * @param {(values) => Promise} onSubmit Отправщик данных формы\n * @return {{\n *   handleSubmit, обрабочик формы onSubmit\n *   data,         данные с сервера после отправки формы\n *   error,        ошибка с сервера после отправки формы\n *   loading,      загрузка данных после отправки формы\n *   register,     обрабтчик изменения поля формы\n * }}\n */\nexport function useFormSubmit<IData>({\n  onSubmit,\n}: {\n  onSubmit: (param: any) => Promise<IData>;\n}) {\n  const [values, setValues] = useState<{ [key: string]: string }>({});\n  const [validation, setValidation] = useState<{ [key: string]: string }>({});\n  const [data, setData] = useState<IData | null>(null);\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const prevDataRef = useRef<IData | null>(null);\n  const rulesRef = useRef<{ [name: string]: TValidationRuleValues }>({});\n\n  useEffect(() => {\n    prevDataRef.current = data;\n  });\n\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const name = e.target.name;\n    const value = e.target.value;\n    const rules = rulesRef.current;\n\n    setValues({\n      ...values,\n      [name]: value,\n    });\n\n    setValidation({\n      ...validation,\n      [name]: validate(value, rules[name]),\n    });\n  };\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    const rules = rulesRef.current;\n\n    if (loading) return;\n\n    const errors = validateAll(values, rules);\n    setValidation(errors);\n    // Есть ошибки клиентской валидации\n    if (Object.values(errors).some((error) => error)) {\n      return;\n    }\n\n    setData(null);\n    setLoading(true);\n\n    try {\n      const res = await onSubmit(values);\n      setError(\"\");\n      setData(res);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const register = (\n    name: string,\n    {\n      value = \"\",\n      validate,\n    }: {\n      value?: string;\n      validate?: TValidationRuleValues;\n    } = {}\n  ) => {\n    if (!(name in values)) {\n      setValues({\n        ...values,\n        [name]: value,\n      });\n    }\n\n    if (validate && !(name in rulesRef.current)) {\n      rulesRef.current[name] = validate;\n    }\n\n    return {\n      name,\n      value: values[name] || \"\",\n      onChange: handleChange,\n      error: !!validation[name],\n      errorText: validation[name],\n    };\n  };\n\n  return {\n    handleSubmit,\n    data,\n    dataChanged: data !== prevDataRef.current,\n    error,\n    loading,\n    values,\n    setValues,\n    register,\n  };\n}\n","import { loadUser } from \"../api\";\nimport { AppDispatch, AppThunk } from \"../types\";\nimport { IUser } from \"../types/data\";\n\nexport const GET_USER_REQUEST: \"GET_USER_REQUEST\" = \"GET_USER_REQUEST\";\nexport const GET_USER_SUCCESS: \"GET_USER_SUCCESS\" = \"GET_USER_SUCCESS\";\nexport const GET_USER_ERROR: \"GET_USER_ERROR\" = \"GET_USER_ERROR\";\nexport const SET_USER: \"SET_USER\" = \"SET_USER\";\nexport const CLEAR_USER: \"CLEAR_USER\" = \"CLEAR_USER\";\n\nexport interface IGetUserRequestAction {\n  readonly type: typeof GET_USER_REQUEST;\n}\n\nexport interface IGetUserSuccessAction {\n  readonly type: typeof GET_USER_SUCCESS;\n  readonly user: IUser;\n}\n\nexport interface IGetUserErrorAction {\n  readonly type: typeof GET_USER_ERROR;\n  readonly message: string;\n}\n\nexport interface ISetUserAction {\n  readonly type: typeof SET_USER;\n  readonly user: IUser;\n}\n\nexport interface IClearUserAction {\n  readonly type: typeof CLEAR_USER;\n}\n\nexport type TUserActions =\n  | IGetUserRequestAction\n  | IGetUserSuccessAction\n  | IGetUserErrorAction\n  | ISetUserAction\n  | IClearUserAction;\n\nexport const getUser: AppThunk =\n  () => async (dispatch: AppDispatch, getState) => {\n    dispatch({\n      type: GET_USER_REQUEST,\n    });\n    try {\n      const data = await loadUser();\n      dispatch({\n        type: GET_USER_SUCCESS,\n        user: data.user,\n      });\n    } catch (err) {\n      dispatch({\n        type: GET_USER_ERROR,\n        message: err.message,\n      });\n    }\n  };\n","import { useEffect, useCallback } from \"react\";\nimport { useSelector, useDispatch } from \"./hooks\";\nimport { login, logout } from \"./api\";\nimport { getUser, SET_USER, CLEAR_USER } from \"./actions/user\";\n\nexport function useAuth() {\n  const { user, userRequest, userSuccess, userErrorMessage } = useSelector(\n    (store) => store.user\n  );\n  const userLoaded = userSuccess || !!userErrorMessage;\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (!userRequest && !userLoaded) {\n      dispatch(getUser());\n    }\n  }, [dispatch, userLoaded, userRequest]);\n\n  const signIn = useCallback(\n    async (params) => {\n      const data = await login(params);\n      dispatch({ type: SET_USER, user: data.user });\n      return data;\n    },\n    [dispatch]\n  );\n\n  const signOut = useCallback(async () => {\n    await logout();\n    dispatch({ type: CLEAR_USER });\n  }, [dispatch]);\n\n  return {\n    user,\n    userLoaded,\n    signIn,\n    signOut,\n  };\n}\n","import cn from \"classnames\";\nimport {\n  Input,\n  Button,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport { Link, Redirect, useLocation } from \"react-router-dom\";\n\nimport PasswordInput from \"../components/password-input/password-input\";\nimport { useFormSubmit } from \"../services/form\";\nimport { useAuth } from \"../services/auth\";\n\nimport styles from \"./login.module.css\";\n\nexport function LoginPage() {\n  const { user, userLoaded, signIn } = useAuth();\n  const location = useLocation<{ from?: Location }>();\n  const { data, loading, error, register, handleSubmit } = useFormSubmit({\n    onSubmit: signIn,\n  });\n\n  if (!userLoaded) {\n    return null;\n  }\n\n  if (!loading && user) {\n    return <Redirect to=\"/\" />;\n  }\n\n  if (data) {\n    return <Redirect to={location.state?.from || \"/\"} />;\n  }\n\n  return (\n    <form className={styles.container} onSubmit={handleSubmit}>\n      <h1 className=\"text text_type_main-medium mb-6\">Вход</h1>\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default mb-4\")}>\n          {error}\n        </p>\n      )}\n      <div className=\"mb-6\">\n        <Input\n          type=\"email\"\n          placeholder=\"E-mail\"\n          {...register(\"email\", { validate: { required: true, email: true } })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-6\">\n        <PasswordInput\n          placeholder=\"Пароль\"\n          {...register(\"password\", {\n            validate: { required: true, minLength: 6 },\n          })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-20\">\n        <Button>Войти</Button>\n      </div>\n      <p className=\"text text_type_main-default text_color_inactive mb-4\">\n        Вы новый пользователь? <Link to=\"/register\">Зарегистрироваться</Link>\n      </p>\n      <p className=\"text text_type_main-default text_color_inactive\">\n        Забыли пароль? <Link to=\"/forgot-password\">Восстановить пароль</Link>\n      </p>\n    </form>\n  );\n}\n","import cn from \"classnames\";\nimport {\n  Input,\n  Button,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport { Link } from \"react-router-dom\";\n\nimport PasswordInput from \"../components/password-input/password-input\";\nimport { useFormSubmit } from \"../services/form\";\nimport { register as callRegister } from \"../services/api\";\n\nimport styles from \"./register.module.css\";\n\nexport function RegisterPage() {\n  const { data, loading, error, register, handleSubmit } = useFormSubmit({\n    onSubmit: (params) => callRegister(params),\n  });\n\n  if (data) {\n    return (\n      <form className={styles.container}>\n        <h1 className=\"text text_type_main-medium mb-6\">Регистрация</h1>\n        <p className=\"text text_type_main-default \">\n          Вы успешно зарегистирированы. <Link to=\"/login\">Войти</Link>\n        </p>\n      </form>\n    );\n  }\n\n  return (\n    <form className={styles.container} onSubmit={handleSubmit}>\n      <h1 className=\"text text_type_main-medium mb-6\">Регистрация</h1>\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default mb-4\")}>\n          {error}\n        </p>\n      )}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder=\"Имя\"\n          {...register(\"name\", { validate: { required: true, minLength: 3 } })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-6\">\n        <Input\n          type=\"email\"\n          placeholder=\"E-mail\"\n          {...register(\"email\", { validate: { required: true, email: true } })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-6\">\n        <PasswordInput\n          placeholder=\"Пароль\"\n          {...register(\"password\", {\n            validate: { required: true, minLength: 6 },\n          })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-20\">\n        <Button>Зарегистрироваться</Button>\n      </div>\n      <p className=\"text text_type_main-default text_color_inactive\">\n        Уже зарегистированы? <Link to=\"/login\">Войти</Link>\n      </p>\n    </form>\n  );\n}\n","import cn from \"classnames\";\nimport {\n  Input,\n  Button,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport { Link, Redirect } from \"react-router-dom\";\nimport { useFormSubmit } from \"../services/form\";\nimport { checkResetPassword } from \"../services/api\";\n\nimport styles from \"./forgot-password.module.css\";\n\nexport function ForgotPasswordPage() {\n  const { data, loading, error, register, values, handleSubmit } =\n    useFormSubmit({\n      onSubmit: checkResetPassword,\n    });\n\n  if (data) {\n    return (\n      <Redirect\n        to={{\n          pathname: \"/reset-password\",\n          state: { email: values.email },\n        }}\n      />\n    );\n  }\n\n  return (\n    <form className={styles.container} onSubmit={handleSubmit}>\n      <h1 className=\"text text_type_main-medium mb-6\">Восстановление пароля</h1>\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default mb-4\")}>\n          {error}\n        </p>\n      )}\n      <div className=\"mb-6\">\n        <Input\n          type=\"email\"\n          placeholder=\"Укажите e-mail\"\n          {...register(\"email\", { validate: { required: true, email: true } })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-20\">\n        <Button>Восстановить</Button>\n      </div>\n      <p className=\"text text_type_main-default text_color_inactive\">\n        Вспомнили пароль? <Link to=\"/login\">Войти</Link>\n      </p>\n    </form>\n  );\n}\n","import cn from \"classnames\";\nimport {\n  Input,\n  Button,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport PasswordInput from \"../components/password-input/password-input\";\nimport { Link, Redirect, useLocation } from \"react-router-dom\";\nimport { useFormSubmit } from \"../services/form\";\nimport { resetPassword } from \"../services/api\";\n\nimport styles from \"./reset-password.module.css\";\n\nexport function ResetPasswordPage() {\n  const location = useLocation<{ email?: string }>();\n  const { data, loading, error, register, handleSubmit } = useFormSubmit({\n    onSubmit: resetPassword,\n  });\n\n  if (!location.state?.email) {\n    return <Redirect to=\"/forgot-password\" />;\n  }\n\n  if (data) {\n    return (\n      <form className={styles.container}>\n        <h1 className=\"text text_type_main-medium mb-6\">\n          Восстановление пароля\n        </h1>\n        <p className=\"text text_type_main-default \">\n          Пароль успешно изменён. <Link to=\"/login\">Войти</Link>\n        </p>\n      </form>\n    );\n  }\n\n  return (\n    <form className={styles.container} onSubmit={handleSubmit}>\n      <h1 className=\"text text_type_main-medium mb-6\">Восстановление пароля</h1>\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default mb-4\")}>\n          {error}\n        </p>\n      )}\n      <div className=\"mb-6\">\n        <PasswordInput\n          placeholder=\"Введите новый пароль\"\n          {...register(\"password\", {\n            validate: { required: true, minLength: 6 },\n          })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder=\"Введите код из письма\"\n          {...register(\"token\", {\n            validate: { required: true, minLength: 10 },\n          })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-20\">\n        <Button>Сохранить</Button>\n      </div>\n      <p className=\"text text_type_main-default text_color_inactive\">\n        Вспомнили пароль? <Link to=\"/login\">Войти</Link>\n      </p>\n    </form>\n  );\n}\n","import { useState, useRef, FocusEvent } from \"react\";\nimport { Input } from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport \"./view-input.module.css\";\n\ntype TViewInputProps = {\n  setValue: (value: string) => void;\n} & {\n  value: string;\n  onChange(e: React.ChangeEvent<HTMLInputElement>): void;\n} & typeof Input[\"defaultProps\"];\n\nconst ViewInput: React.FC<TViewInputProps> = ({ setValue, ...props }) => {\n  const [isEditMode, setEditMode] = useState(false);\n  const inputRef = useRef<HTMLInputElement>(null);\n  let iconClick = false;\n\n  const handleIconClick = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    const el = inputRef.current;\n    iconClick = true;\n    if (isEditMode && el) {\n      setValue(\"\");\n      el.focus();\n    } else if (el) {\n      setEditMode(true);\n      setTimeout(() => {\n        el.focus();\n      }, 0);\n    }\n  };\n\n  const handleBlur = (e?: FocusEvent<HTMLInputElement>) => {\n    setTimeout(() => {\n      if (iconClick) {\n        iconClick = false;\n        return;\n      }\n      setEditMode(false);\n    }, 200);\n  };\n\n  return (\n    <Input\n      {...props}\n      ref={inputRef}\n      icon={isEditMode ? \"CloseIcon\" : \"EditIcon\"}\n      onIconClick={handleIconClick}\n      onBlur={handleBlur}\n      disabled={props.disabled || !isEditMode}\n    />\n  );\n};\n\nexport default ViewInput;\n","import cn from \"classnames\";\nimport { Button } from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport { useDispatch } from \"react-redux\";\n\nimport ViewInput from \"../view-input/view-input\";\nimport { useFormSubmit } from \"../../services/form\";\nimport { useAuth } from \"../../services/auth\";\nimport { updateUser } from \"../../services/api\";\nimport { isEqual, useScreenSize } from \"../../services/utils\";\n\nimport { SET_USER } from \"../../services/actions/user\";\n\nimport styles from \"./profile-form.module.css\";\n\nconst ProfileForm: React.FC = () => {\n  const dispatch = useDispatch();\n  const { user } = useAuth();\n  const {\n    data,\n    dataChanged,\n    loading,\n    error,\n    register,\n    values,\n    setValues,\n    handleSubmit,\n  } = useFormSubmit({\n    onSubmit: updateUser,\n  });\n\n  const screenSize = useScreenSize();\n\n  if (!user) {\n    return null;\n  }\n\n  const footerVisible = !isEqual({ ...user, password: \"\" }, values);\n\n  const createSetValue = (name: string) => {\n    return (value: string) => setValues({ ...values, [name]: value });\n  };\n\n  const handleCancel = () => {\n    setValues({ ...user, password: \"\" });\n  };\n\n  if (\n    data &&\n    dataChanged &&\n    !isEqual(values, {\n      ...data.user,\n      password: \"\",\n    })\n  ) {\n    setValues({\n      ...data.user,\n      password: \"\",\n    });\n  }\n\n  if (data && user !== data.user) {\n    dispatch({ type: SET_USER, user: data.user });\n  }\n\n  return (\n    <form className={cn(styles.form)} onSubmit={handleSubmit}>\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default mb-4\")}>\n          {error}\n        </p>\n      )}\n      <div className=\"mb-6\">\n        <ViewInput\n          type=\"text\"\n          placeholder=\"Имя\"\n          setValue={createSetValue(\"name\")}\n          {...register(\"name\", {\n            value: user.name,\n            validate: { required: true, minLength: 3 },\n          })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-6\">\n        <ViewInput\n          type=\"email\"\n          placeholder=\"Логин\"\n          setValue={createSetValue(\"email\")}\n          {...register(\"email\", {\n            value: user.email,\n            validate: { required: true, email: true },\n          })}\n          disabled={loading}\n        />\n      </div>\n      <div className=\"mb-6\">\n        <ViewInput\n          placeholder=\"Пароль\"\n          type=\"password\"\n          setValue={createSetValue(\"password\")}\n          {...register(\"password\", { validate: { minLength: 6 } })}\n          disabled={loading}\n        />\n      </div>\n      <footer\n        style={{ display: footerVisible ? \"\" : \"none\" }}\n        className={styles.formFooter}\n      >\n        <a\n          className=\"text text_type_main-default mr-7\"\n          onClick={loading ? undefined : handleCancel}\n        >\n          Отмена\n        </a>\n        <Button\n          type=\"primary\"\n          size={screenSize === \"desktom\" ? \"medium\" : \"small\"}\n        >\n          Сохранить\n        </Button>\n      </footer>\n    </form>\n  );\n};\n\nexport default ProfileForm;\n","import cn from \"classnames\";\nimport LazyImage from \"../lazy-image/lazy-image\";\n\nimport styles from \"./ingredient-avatar.module.css\";\n\ninterface IIngredientAvatarProps {\n  image: string;\n  count?: number;\n}\n\nconst IngredientAvatar: React.FC<IIngredientAvatarProps> = ({\n  image,\n  count = 0,\n}) => {\n  return (\n    <div className={styles.ingredient}>\n      <LazyImage\n        src={image}\n        className={styles.ingredientImage}\n        width={112}\n        responsive={false}\n        alt=\"ingredient\"\n      />\n      {count > 0 && (\n        <i className={cn(styles.ingredientFg, \"text text_type_main-default\")}>\n          +{count}\n        </i>\n      )}\n    </div>\n  );\n};\n\nexport default IngredientAvatar;\n","import { IOrder } from \"../types/data\";\n\nexport const WS_FEED_CONNECTION_START: \"WS_FEED_CONNECTION_START\" =\n  \"WS_FEED_CONNECTION_START\";\nexport const WS_FEED_CONNECTION_CLOSE: \"WS_FEED_CONNECTION_CLOSE\" =\n  \"WS_FEED_CONNECTION_CLOSE\";\nexport const WS_FEED_SEND_MESSAGE: \"WS_FEED_SEND_MESSAGE\" =\n  \"WS_FEED_SEND_MESSAGE\";\nexport const WS_FEED_CONNECTION_SUCCESS: \"WS_FEED_CONNECTION_SUCCESS\" =\n  \"WS_FEED_CONNECTION_SUCCESS\";\nexport const WS_FEED_CONNECTION_CLOSED: \"WS_FEED_CONNECTION_CLOSED\" =\n  \"WS_FEED_CONNECTION_CLOSED\";\nexport const WS_FEED_CONNECTION_ERROR: \"WS_FEED_CONNECTION_ERROR\" =\n  \"WS_FEED_CONNECTION_ERROR\";\nexport const WS_FEED_GET_MESSAGE: \"WS_FEED_GET_MESSAGE\" = \"WS_FEED_GET_MESSAGE\";\n\nexport interface IWsFeedConnectionStartAction {\n  readonly type: typeof WS_FEED_CONNECTION_START;\n}\n\nexport interface IWsFeedConnectionCloseAction {\n  readonly type: typeof WS_FEED_CONNECTION_CLOSE;\n}\n\nexport interface IWsFeedConnectionClosedAction {\n  readonly type: typeof WS_FEED_CONNECTION_CLOSED;\n}\n\nexport interface IWsFeedConnectionSuccessAction {\n  readonly type: typeof WS_FEED_CONNECTION_SUCCESS;\n}\n\nexport interface IWsFeedConnectionErrorAction {\n  readonly type: typeof WS_FEED_CONNECTION_ERROR;\n  readonly payload: { message: string };\n}\n\nexport interface IWsFeedGetMessageAction {\n  readonly type: typeof WS_FEED_GET_MESSAGE;\n  readonly payload: {\n    message?: string;\n    orders: IOrder[];\n    total: number;\n    totalToday: number;\n  };\n}\n\nexport type TWsFeedActions =\n  | IWsFeedConnectionStartAction\n  | IWsFeedConnectionCloseAction\n  | IWsFeedConnectionClosedAction\n  | IWsFeedConnectionSuccessAction\n  | IWsFeedConnectionErrorAction\n  | IWsFeedGetMessageAction;\n","import { IOrder } from \"../types/data\";\n\nexport const WS_PROFILE_CONNECTION_START: \"WS_PROFILE_CONNECTION_START\" =\n  \"WS_PROFILE_CONNECTION_START\";\nexport const WS_PROFILE_CONNECTION_CLOSE: \"WS_PROFILE_CONNECTION_CLOSE\" =\n  \"WS_PROFILE_CONNECTION_CLOSE\";\nexport const WS_PROFILE_SEND_MESSAGE: \"WS_PROFILE_SEND_MESSAGE\" =\n  \"WS_PROFILE_SEND_MESSAGE\";\nexport const WS_PROFILE_CONNECTION_SUCCESS: \"WS_PROFILE_CONNECTION_SUCCESS\" =\n  \"WS_PROFILE_CONNECTION_SUCCESS\";\nexport const WS_PROFILE_CONNECTION_CLOSED: \"WS_PROFILE_CONNECTION_CLOSED\" =\n  \"WS_PROFILE_CONNECTION_CLOSED\";\nexport const WS_PROFILE_CONNECTION_ERROR: \"WS_PROFILE_CONNECTION_ERROR\" =\n  \"WS_PROFILE_CONNECTION_ERROR\";\nexport const WS_PROFILE_GET_MESSAGE: \"WS_PROFILE_GET_MESSAGE\" =\n  \"WS_PROFILE_GET_MESSAGE\";\n\nexport interface IWsProfileConnectionStartAction {\n  readonly type: typeof WS_PROFILE_CONNECTION_START;\n}\n\nexport interface IWsProfileConnectionCloseAction {\n  readonly type: typeof WS_PROFILE_CONNECTION_CLOSE;\n}\n\nexport interface IWsProfileConnectionClosedAction {\n  readonly type: typeof WS_PROFILE_CONNECTION_CLOSED;\n}\n\nexport interface IWsProfileConnectionSuccessAction {\n  readonly type: typeof WS_PROFILE_CONNECTION_SUCCESS;\n}\n\nexport interface IWsProfileConnectionErrorAction {\n  readonly type: typeof WS_PROFILE_CONNECTION_ERROR;\n  readonly payload: { message: string };\n}\n\nexport interface IWsProfileGetMessageAction {\n  readonly type: typeof WS_PROFILE_GET_MESSAGE;\n  readonly payload: {\n    message?: string;\n    orders: IOrder[];\n    total: number;\n    totalToday: number;\n  };\n}\n\nexport type TWsProfileActions =\n  | IWsProfileConnectionStartAction\n  | IWsProfileConnectionCloseAction\n  | IWsProfileConnectionClosedAction\n  | IWsProfileConnectionSuccessAction\n  | IWsProfileConnectionErrorAction\n  | IWsProfileGetMessageAction;\n","import { useEffect, useLayoutEffect, useMemo, useState } from \"react\";\nimport { useSelector, useDispatch } from \"../services/hooks\";\n\nimport {\n  WS_FEED_CONNECTION_START,\n  WS_FEED_CONNECTION_CLOSE,\n} from \"./actions/ws-feed\";\n\nimport {\n  WS_PROFILE_CONNECTION_START,\n  WS_PROFILE_CONNECTION_CLOSE,\n} from \"./actions/ws-profile\";\n\nimport { getIngredients } from \"./actions/ingredients\";\nimport { loadOrderById } from \"./api\";\nimport {\n  IIngredient,\n  IOrder,\n  IOrderIngredient,\n  IFullOrder,\n} from \"./types/data\";\n\nfunction useIngredientsMap(ingredients: IIngredient[]) {\n  return useMemo(\n    () =>\n      ingredients.reduce((map: { [key: string]: IIngredient }, item) => {\n        map[item._id] = item;\n        return map;\n      }, {}),\n    [ingredients]\n  );\n}\n\nfunction getFullOrder(\n  order: IOrder,\n  ingredientsMap: { [key: string]: IIngredient }\n): IFullOrder | null {\n  if (Object.keys(ingredientsMap).length === 0) {\n    return null;\n  }\n\n  const ingredients = order.ingredients\n    .filter((id) => !!id)\n    .map((id) => ingredientsMap[id])\n    .reduce((result: IOrderIngredient[], ingredient) => {\n      const found = result.find(({ _id }) => ingredient._id === _id);\n\n      if (found) {\n        if (found.type !== \"bun\") {\n          found.count++;\n        }\n        return result;\n      }\n\n      result.push({\n        ...ingredient,\n        count: ingredient.type === \"bun\" ? 2 : 1,\n      });\n      return result;\n    }, []);\n\n  return {\n    ...order,\n    price: ingredients.reduce(\n      (total, { count, price }) => total + count * price,\n      0\n    ),\n    ingredients,\n  };\n}\n\nconst statusMap = {\n  created: \"Создан\",\n  pending: \"Готовится\",\n  done: \"Выполнен\",\n  canceled: \"Отменен\",\n};\n\nexport function translateStatus(status: IFullOrder[\"status\"]) {\n  return statusMap[status] || status;\n}\n\nexport function useOrders(orders: IOrder[]) {\n  const { items: ingredients } = useSelector((store) => store.ingredients);\n\n  const ingredientsMap = useIngredientsMap(ingredients);\n\n  const ordersList = useMemo(\n    () =>\n      orders\n        .map((order) => getFullOrder(order, ingredientsMap))\n        .filter((order): order is IFullOrder => order !== null),\n    [orders, ingredientsMap]\n  );\n\n  return { ordersList };\n}\n\nexport function useOrderLoad(id: string) {\n  const dispatch = useDispatch();\n\n  const [serverOrder, setServerOrder] = useState<IOrder>();\n  const [order, setOrder] = useState<IFullOrder | null>(null);\n  const [orderLoading, setOrderLoading] = useState(true);\n  const [orderError, setOrderError] = useState(\"\");\n\n  const {\n    items: ingredients,\n    itemsErrorMessage: ingredientsError,\n    itemsRequest: ingredientsLoading,\n  } = useSelector((store) => store.ingredients);\n\n  useEffect(() => {\n    if (ingredients.length === 0) {\n      dispatch(getIngredients());\n    }\n  }, [dispatch, ingredients.length]);\n\n  const ingredientsMap = useIngredientsMap(ingredients);\n\n  if (ingredients.length && serverOrder && !order) {\n    setOrder(getFullOrder(serverOrder, ingredientsMap));\n  }\n\n  useEffect(() => {\n    setOrderLoading(true);\n    loadOrderById(id)\n      .then((data) => {\n        setServerOrder(data);\n      })\n      .catch((err) => setOrderError(err))\n      .finally(() => {\n        setOrderLoading(false);\n      });\n  }, [id]);\n\n  const loading = ingredientsLoading || orderLoading;\n  const error = ingredientsError + orderError;\n\n  return { order, loading, error };\n}\n\nexport function useFeedOrders() {\n  const dispatch = useDispatch();\n\n  const {\n    orders,\n    total,\n    totalToday,\n    wsError: ordersError,\n  } = useSelector((store) => store.feed);\n\n  useEffect(() => {\n    dispatch({ type: WS_FEED_CONNECTION_START });\n\n    return () => {\n      dispatch({ type: WS_FEED_CONNECTION_CLOSE });\n    };\n  }, [dispatch]);\n\n  const {\n    items: ingredients,\n    itemsErrorMessage: ingredientsError,\n    itemsRequest: ingredientsLoading,\n  } = useSelector((store) => store.ingredients);\n\n  useLayoutEffect(() => {\n    if (ingredients.length === 0) {\n      dispatch(getIngredients());\n    }\n  }, [dispatch, ingredients.length]);\n\n  const { ordersList } = useOrders(orders);\n\n  const completeNumbers = useMemo(\n    () =>\n      orders\n        .filter(({ status }) => status === \"done\")\n        .slice(0, 20)\n        .map(({ number }) => number),\n    [orders]\n  );\n\n  const progressNumbers = useMemo(\n    () =>\n      orders\n        .filter(({ status }) => status === \"pending\")\n        .slice(0, 20)\n        .map(({ number }) => number),\n    [orders]\n  );\n\n  const error = ordersError + ingredientsError;\n  const loading = (!orders.length && !error) || ingredientsLoading;\n\n  return {\n    ordersList,\n    total,\n    totalToday,\n    completeNumbers,\n    progressNumbers,\n    error,\n    loading,\n  };\n}\n\nexport function useProfileOrders() {\n  const dispatch = useDispatch();\n\n  const { orders, wsError: ordersError } = useSelector(\n    (store) => store.profile\n  );\n\n  useLayoutEffect(() => {\n    dispatch({ type: WS_PROFILE_CONNECTION_START });\n\n    return () => {\n      dispatch({ type: WS_PROFILE_CONNECTION_CLOSE });\n    };\n  }, [dispatch]);\n\n  const {\n    items: ingredients,\n    itemsErrorMessage: ingredientsError,\n    itemsRequest: ingredientsLoading,\n  } = useSelector((store) => store.ingredients);\n\n  useLayoutEffect(() => {\n    if (ingredients.length === 0) {\n      dispatch(getIngredients());\n    }\n  }, [dispatch, ingredients.length]);\n\n  const { ordersList } = useOrders(orders);\n\n  ordersList.sort(\n    (a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n  );\n\n  const error = ordersError + ingredientsError;\n  const loading = (!orders.length && !error) || ingredientsLoading;\n\n  return {\n    ordersList,\n    error,\n    loading,\n  };\n}\n","import { memo } from \"react\";\nimport cn from \"classnames\";\nimport { CurrencyIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport { Link, useRouteMatch, useLocation } from \"react-router-dom\";\nimport { formatPastDate, getScreenSize } from \"../../services/utils\";\nimport IngredientAvatar from \"../ingredient-avatar/ingredient-avatar\";\nimport { IFullOrder, IOrderIngredient } from \"../../services/types/data\";\nimport { translateStatus } from \"../../services/orders\";\n\nimport styles from \"./order-item.module.css\";\n\ninterface IIngredientsProps {\n  ingredients: IOrderIngredient[];\n}\n\nconst Ingredients: React.FC<IIngredientsProps> = ({ ingredients = [] }) => {\n  const list = ingredients.slice(0, 5);\n  const rest = ingredients.slice(5);\n  return (\n    <ul className={styles.ingredientList}>\n      {list.map(({ image }, index) => (\n        <li\n          className={styles.ingredient}\n          key={index}\n          style={{ zIndex: list.length - index }}\n        >\n          <IngredientAvatar image={image} />\n        </li>\n      ))}\n      {rest.length > 0 && (\n        <li className={styles.ingredient} key={list.length}>\n          <IngredientAvatar image={rest[0].image} count={rest.length - 1} />\n        </li>\n      )}\n    </ul>\n  );\n};\n\ninterface IOrderItemProps {\n  order: IFullOrder;\n}\n\nconst OrderItem: React.FC<IOrderItemProps> = memo(({ order }) => {\n  const location = useLocation();\n  const { path } = useRouteMatch();\n  return (\n    <Link\n      className={cn(styles.container)}\n      to={{\n        pathname: `${path}/${order.number}`,\n        state: { background: location },\n      }}\n    >\n      <header className={styles.header}>\n        <h2 className=\"text text_type_digits-default mr-4\">#{order.number}</h2>\n        <span className=\"text text_type_main-default text_color_inactive\">\n          {formatPastDate(order.createdAt)}\n        </span>\n      </header>\n      <h1 className={cn(\"text text_type_main-medium\", styles.title)}>\n        {order.name}\n      </h1>\n      {order.status && (\n        <p\n          className={cn(\"text text_type_main-default pt-2 tablet-hidden\", {\n            [styles.statusDone]: order.status === \"done\",\n          })}\n        >\n          {translateStatus(order.status)}\n        </p>\n      )}\n      <footer className={cn(styles.footer)}>\n        <Ingredients ingredients={order.ingredients} />\n        <div className={styles.price}>\n          <p className=\"text text_type_digits-default mr-2\">{order.price}</p>\n          <p className=\"text\">\n            <CurrencyIcon type=\"primary\" />\n          </p>\n        </div>\n      </footer>\n    </Link>\n  );\n});\n\nexport default OrderItem;\n","import cn from \"classnames\";\n\nimport { useState, useEffect, useRef } from \"react\";\n\nimport { NavLink, Route, useRouteMatch } from \"react-router-dom\";\n\nimport ProfileForm from \"../components/profile-form/profile-form\";\nimport { useAuth } from \"../services/auth\";\nimport OrderItem from \"../components/order-item/order-item\";\nimport Skeleton from \"../components/skeleton/skeleton\";\nimport Spinner from \"../components/spinner/spinner\";\n\nimport { useProfileOrders } from \"../services/orders\";\n\nimport styles from \"./profile.module.css\";\nimport { useScrollbar } from \"../services/scrollbar\";\n\nfunction Menu() {\n  const { path } = useRouteMatch();\n  return (\n    <nav className={cn(styles.menu)}>\n      <ul className=\"text text_type_main-medium\">\n        <li>\n          <NavLink\n            to={path}\n            exact\n            className={styles.menuItem}\n            activeClassName={styles.menuItemActive}\n          >\n            Профиль\n          </NavLink>\n        </li>\n        <li>\n          <NavLink\n            to={`${path}/orders`}\n            className={styles.menuItem}\n            activeClassName={styles.menuItemActive}\n          >\n            История заказов\n          </NavLink>\n        </li>\n        <li>\n          <NavLink\n            to={`${path}/logout`}\n            exact\n            className={styles.menuItem}\n            activeClassName={styles.menuItemActive}\n          >\n            Выход\n          </NavLink>\n        </li>\n      </ul>\n      <footer\n        className={cn(\n          styles.menuFooter,\n          \"text text_type_main-default text_color_inactive\"\n        )}\n      >\n        <Route path={path} exact>\n          В этом разделе вы можете изменить свои персональные данные\n        </Route>\n        <Route path={`${path}/orders`} exact>\n          В этом разделе вы можете просмотреть свою историю заказов\n        </Route>\n      </footer>\n    </nav>\n  );\n}\n\nfunction Logout() {\n  const { signOut } = useAuth();\n  const [logoutError, setLogoutError] = useState(\"\");\n\n  useEffect(() => {\n    signOut().catch((err) => setLogoutError(err.message));\n  }, [signOut]);\n\n  return logoutError ? (\n    <p className={cn(styles.error, \"text text_type_main-default mt-20\")}>\n      При выходе возникла ошибка. Пожалуйста, попробуйте позже. {logoutError}\n    </p>\n  ) : (\n    <Spinner center={true} />\n  );\n}\n\nfunction OrderList() {\n  const orderListRef = useRef<HTMLUListElement>(null);\n  useScrollbar(orderListRef);\n\n  const { ordersList, error, loading } = useProfileOrders();\n\n  return (\n    <>\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default\")}>\n          Что-то пошло не так. {error}\n        </p>\n      )}\n      <ul className={styles.orderList} ref={orderListRef}>\n        {loading && (\n          <Skeleton\n            repeat={2}\n            className={cn(styles.skeletonOrder, \"mb-6 mr-2\")}\n            tag=\"li\"\n          />\n        )}\n        {ordersList.map((order) => (\n          <li key={order.number} className=\"mb-6 mr-2\">\n            <OrderItem order={order} />\n          </li>\n        ))}\n      </ul>\n    </>\n  );\n}\n\nexport function ProfilePage() {\n  const { path } = useRouteMatch();\n  return (\n    <section className={cn(styles.container, \"mt-10\")}>\n      <Menu />\n      <Route path={path} exact>\n        <ProfileForm />\n      </Route>\n      <Route path={`${path}/orders`} exact>\n        <OrderList />\n      </Route>\n      <Route path={`${path}/logout`} exact>\n        <Logout />\n      </Route>\n    </section>\n  );\n}\n","import { useRef } from \"react\";\nimport cn from \"classnames\";\n\nimport OrderItem from \"../components/order-item/order-item\";\nimport Skeleton from \"../components/skeleton/skeleton\";\nimport { useScrollbar } from \"../services/scrollbar\";\nimport { useFeedOrders } from \"../services/orders\";\n\nimport styles from \"./feed.module.css\";\nimport appStyles from \"../components/app/app.module.css\";\n\ninterface IStatisticGridItemProps {\n  title: string;\n  orders: number[];\n  loading: boolean;\n  className?: string;\n  complete?: boolean;\n}\n\nfunction StatisticGridItem({\n  title,\n  orders,\n  loading,\n  className,\n  complete = false,\n}: IStatisticGridItemProps) {\n  return (\n    <section className={cn(styles.statisticGridItem, className)}>\n      <h2\n        className={cn(\n          \"text text_type_main-medium\",\n          styles.statisticGridItemTitle\n        )}\n      >\n        {title}\n      </h2>\n      <ul\n        className={cn(\n          styles.statisticGridItemList,\n          \"text text_type_digits-default\",\n          {\n            [styles.success]: complete,\n          }\n        )}\n      >\n        {loading && <Skeleton repeat={3} className=\"mb-2\" tag=\"li\" />}\n        {orders.map((order, index) => (\n          <li className={styles.statisticGridItemText} key={index}>\n            {order}\n          </li>\n        ))}\n      </ul>\n    </section>\n  );\n}\n\nexport function FeedPage() {\n  const statisticRef = useRef<HTMLElement>(null);\n  const orderListRef = useRef<HTMLUListElement>(null);\n  useScrollbar(statisticRef);\n  useScrollbar(orderListRef);\n\n  const {\n    ordersList,\n    completeNumbers,\n    progressNumbers,\n    total,\n    totalToday,\n    error,\n    loading,\n  } = useFeedOrders();\n\n  return (\n    <section className={cn(styles.container)}>\n      <h1 className=\"text text_type_main-large mb-5\">Лента заказов</h1>\n      <section className={styles.content}>\n        {error && (\n          <p className={cn(styles.error, \"text text_type_main-default\")}>\n            Что-то пошло не так. {error}\n          </p>\n        )}\n        <ul className={cn(styles.orderList)} ref={orderListRef}>\n          {loading && (\n            <Skeleton\n              className={cn(styles.skeletonOrder, \"mb-4 mr-2\")}\n              repeat={2}\n              tag=\"li\"\n            />\n          )}\n          {ordersList.map((order) => (\n            <li className=\"mb-4 mr-2\" key={order.number}>\n              <OrderItem order={order} />\n            </li>\n          ))}\n        </ul>\n        <section className={styles.statistic} ref={statisticRef}>\n          <section className={styles.statisticGrid}>\n            <StatisticGridItem\n              className=\"mr-9\"\n              title=\"Готовы:\"\n              loading={loading}\n              orders={completeNumbers}\n              complete={true}\n            />\n            <StatisticGridItem\n              title=\"В работе:\"\n              loading={loading}\n              orders={progressNumbers}\n            />\n          </section>\n          {total > 0 && (\n            <>\n              <h2\n                className={cn(\n                  \"text text_type_main-medium\",\n                  styles.statisticTotalTitle\n                )}\n              >\n                Выполнено за все время:\n              </h2>\n              <p\n                className={cn(\n                  appStyles.textSpaceShadow,\n                  \"text text_type_digits-large\"\n                )}\n              >\n                {total}\n              </p>\n              <h2\n                className={cn(\n                  \"text text_type_main-medium\",\n                  styles.statisticTotalTitle\n                )}\n              >\n                Выполнено за сегодня:\n              </h2>\n              <p\n                className={cn(\n                  appStyles.textSpaceShadow,\n                  \"text text_type_digits-large\"\n                )}\n              >\n                {totalToday}\n              </p>\n            </>\n          )}\n        </section>\n      </section>\n    </section>\n  );\n}\n","import { useRef, memo, RefObject } from \"react\";\nimport cn from \"classnames\";\nimport { CurrencyIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport { formatPastDate } from \"../../services/utils\";\nimport { useScrollbar } from \"../../services/scrollbar\";\nimport { translateStatus } from \"../../services/orders\";\n\nimport IngredientAvatar from \"../ingredient-avatar/ingredient-avatar\";\n\nimport { IFullOrder, IOrderIngredient } from \"../../services/types/data\";\n\nimport styles from \"./order-info.module.css\";\n\ninterface IIngredientsProps {\n  ingredients: IOrderIngredient[];\n  listRef: RefObject<HTMLUListElement>;\n}\n\nconst Ingredients: React.FC<IIngredientsProps> = ({\n  ingredients = [],\n  listRef,\n}) => {\n  return (\n    <ul className={styles.ingredientList} ref={listRef}>\n      {ingredients.map(({ image, name, count, price }, index) => (\n        <li className={cn(styles.ingredient, \"mb-4 mr-6\")} key={index}>\n          <IngredientAvatar image={image} />\n          <p\n            className={cn(\n              styles.ingredientName,\n              \"text text_type_main-default ml-4\"\n            )}\n          >\n            {name}\n          </p>\n          <div className={styles.price}>\n            <p className=\"text text_type_digits-default mr-2\">\n              {count} x {price}\n            </p>\n            <p className=\"text\">\n              <CurrencyIcon type=\"primary\" />\n            </p>\n          </div>\n        </li>\n      ))}\n    </ul>\n  );\n};\n\ninterface IOrderInfoProps {\n  order: IFullOrder;\n  isInModal?: boolean;\n}\n\nconst OrderInfo: React.FC<IOrderInfoProps> = memo(\n  ({ order, isInModal = false }) => {\n    const listRef = useRef<HTMLUListElement>(null);\n    const footerRef = useRef<HTMLElement>(null);\n\n    useScrollbar(listRef, { exclude: footerRef, maxHeight: 312, isInModal });\n\n    return (\n      <section className={cn(styles.container)}>\n        <h1 className=\"text text_type_main-medium mt-5\">{order.name}</h1>\n        {order.status && (\n          <p\n            className={cn(\"text text_type_main-default pt-3\", {\n              [styles.statusDone]: order.status === \"done\",\n            })}\n          >\n            {translateStatus(order.status)}\n          </p>\n        )}\n        <section className={cn(\"mt-15\")}>\n          <h1 className=\"text text_type_main-medium mb-6\">Состав:</h1>\n          <Ingredients ingredients={order.ingredients} listRef={listRef} />\n        </section>\n        <footer className={cn(styles.footer, \"mt-10\")} ref={footerRef}>\n          <span className=\"text text_type_main-default text_color_inactive\">\n            {formatPastDate(order.createdAt)}\n          </span>\n          <div className={styles.price}>\n            <p className=\"text text_type_digits-default mr-2\">{order.price}</p>\n            <p className=\"text\">\n              <CurrencyIcon type=\"primary\" />\n            </p>\n          </div>\n        </footer>\n      </section>\n    );\n  }\n);\n\nexport default OrderInfo;\n","import cn from \"classnames\";\nimport { useParams } from \"react-router-dom\";\n\nimport OrderInfo from \"../components/order-info/order-info\";\nimport Skeleton from \"../components/skeleton/skeleton\";\nimport { useOrderLoad } from \"../services/orders\";\nimport styles from \"./order.module.css\";\n\nexport function OrderPage() {\n  const { id } = useParams<{ id: string }>();\n\n  const { order, loading, error } = useOrderLoad(id);\n\n  if (error) {\n    return (\n      <section\n        className={cn(\n          styles.container,\n          \"mt-2 mb-2 text text_type_main-default\"\n        )}\n      >\n        <p className={styles.error}>\n          Не удалось найти заказ {id}.<br /> {error}\n        </p>\n      </section>\n    );\n  }\n\n  if (loading) {\n    return (\n      <section className={cn(styles.container, \"mt-2 mb-2\")}>\n        <div className={styles.center}>\n          <Skeleton\n            width={200}\n            className={\"text text_type_digits-default mb-10\"}\n          />\n        </div>\n        <Skeleton repeat={2} className=\"text text_type_main-medium mt-5\" />\n        <div className=\"mt-15\">\n          <Skeleton width={64} circle={true} className=\"mr-4\" />\n          <Skeleton width=\"60%\" className=\"text text_type_main-default mt-6\" />\n        </div>\n        <div className=\"mt-4\">\n          <Skeleton width={64} height={64} circle={true} className=\"mr-4\" />\n          <Skeleton width=\"60%\" className=\"text text_type_main-default mt-6\" />\n        </div>\n      </section>\n    );\n  }\n\n  return (\n    order && (\n      <section className={cn(styles.container, \"mt-2 mb-2\")}>\n        <h2\n          className={cn(styles.center, \"text text_type_digits-default mb-10\")}\n        >\n          #{order.number}\n        </h2>\n        <OrderInfo order={order} />\n      </section>\n    )\n  );\n}\n","import { useState, useEffect, memo } from \"react\";\nimport cn from \"classnames\";\n\nimport styles from \"./ingredient-details.module.css\";\nimport { IIngredient } from \"../../services/types/data\";\nimport LazyImage from \"../lazy-image/lazy-image\";\n\ninterface IngredientDetailsProps {\n  ingredient: IIngredient;\n}\n\nconst IngredientDetails: React.FC<IngredientDetailsProps> = memo(\n  ({ ingredient }) => {\n    return (\n      <div className={cn(styles.container, \"pl-15 pr-15 pb-5\")}>\n        <LazyImage\n          src={ingredient.image_large}\n          alt={ingredient.name}\n          width={480}\n        />\n        <h1\n          className={cn(styles.title, \"text text_type_main-medium mt-4 mb-8\")}\n        >\n          {ingredient.name}\n        </h1>\n        <dl className={cn(styles.content, \"text text_type_main-default\")}>\n          <div>\n            <dt>Калории, ккал</dt>\n            <dd className=\"text text_type_digits-default mt-2\">\n              {ingredient.calories}\n            </dd>\n          </div>\n          <div>\n            <dt>Белки, г</dt>\n            <dd className=\"text text_type_digits-default mt-2\">\n              {ingredient.proteins}\n            </dd>\n          </div>\n          <div>\n            <dt>Жиры, г</dt>\n            <dd className=\"text text_type_digits-default mt-2\">\n              {ingredient.fat}\n            </dd>\n          </div>\n          <div>\n            <dt>Углеводы, г</dt>\n            <dd className=\"text text_type_digits-default mt-2\">\n              {ingredient.carbohydrates}\n            </dd>\n          </div>\n        </dl>\n      </div>\n    );\n  }\n);\n\nexport default IngredientDetails;\n","import { useLayoutEffect } from \"react\";\nimport cn from \"classnames\";\nimport { useParams } from \"react-router-dom\";\n\nimport { useSelector, useDispatch } from \"../services/hooks\";\n\nimport Skeleton from \"../components/skeleton/skeleton\";\nimport IngredientDetails from \"../components/ingredient-details/ingredient-details\";\n\nimport { getIngredients } from \"../services/actions/ingredients\";\n\nimport styles from \"./ingredient.module.css\";\n\nconst skeleton = (\n  <div>\n    <Skeleton width=\"80%\" className=\"text text_type_main-large\" />\n    <Skeleton width={480} height={240} className=\"mt-4 mb-8\" />\n    <Skeleton height={30} className=\"mt-4\" repeat={3} />\n  </div>\n);\nexport function IngredientPage() {\n  const { id } = useParams<{ id: string }>();\n  const dispatch = useDispatch();\n\n  const {\n    items: ingredients,\n    itemsErrorMessage: error,\n    itemsRequest: loading,\n  } = useSelector((store) => store.ingredients);\n\n  useLayoutEffect(() => {\n    if (ingredients.length === 0) {\n      dispatch(getIngredients());\n    }\n  }, [ingredients.length, dispatch]);\n\n  const ingredient = ingredients.find(({ _id }) => _id === id);\n  return (\n    <section className={cn(styles.container)}>\n      {loading && skeleton}\n      {error && (\n        <p className={cn(styles.error, \"text text_type_main-default\")}>\n          Ошибка загрузки данных. {error}\n        </p>\n      )}\n      {ingredient && (\n        <>\n          <h1 className=\"text text_type_main-large\">Детали ингредиента</h1>\n          <IngredientDetails ingredient={ingredient} />\n        </>\n      )}\n      {!error && !loading && !ingredient && (\n        <p className=\"text text_type_main-default\">\n          Увы, не удалось найти ингредиент.\n        </p>\n      )}\n    </section>\n  );\n}\n","export function NotFound404() {\n  return (\n    <div style={{ textAlign: \"center\" }}>\n      <p className=\"text text_type_digits-large mt-20\">\n        404\n      </p>\n      <p className=\"text text_type_main-medium text_color_inactive mt-5\">\n        Упс!\n      </p>\n      <p className=\"text text_type_main-medium text_color_inactive mt-5\">\n        Кажется, мы её потеряли...\n      </p>\n    </div>\n  );\n}\n","import { ReactNode } from \"react\";\nimport cn from \"classnames\";\nimport { useRouteMatch, Link } from \"react-router-dom\";\nimport { BurgerIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\n\nimport styles from \"./header-item.module.css\";\n\ninterface IHeaderItemProps {\n  icon: typeof BurgerIcon;\n  path: string;\n  children: ReactNode;\n}\n\nconst HeaderItem: React.FC<IHeaderItemProps> = ({\n  icon: Icon,\n  children,\n  path,\n}) => {\n  const match = useRouteMatch({ path, exact: path === \"/\" });\n  return (\n    <Link\n      className={cn(\n        styles.container,\n        \"text text_type_main-default pl-5 pr-5 pt-4 pb-4\"\n      )}\n      to={path}\n    >\n      <Icon type={match ? \"primary\" : \"secondary\"} />\n      <span\n        className={cn(styles.text, { text_color_inactive: !match }, \"ml-2\")}\n      >\n        {children}\n      </span>\n    </Link>\n  );\n};\n\nexport default HeaderItem;\n","import styles from \"./app-header.module.css\";\n\nimport { Link } from \"react-router-dom\";\nimport cn from \"classnames\";\nimport {\n  BurgerIcon,\n  ListIcon,\n  Logo,\n  ProfileIcon,\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport HeaderItem from \"./header-item/header-item\";\n\nconst AppHeader: React.FC = () => {\n  return (\n    <header className={cn(styles.header)}>\n      <ul className={styles.content}>\n        <li className={styles.contentItem}>\n          <nav className={cn(styles.navigation)}>\n            <ul>\n              <li>\n                <HeaderItem icon={BurgerIcon} path=\"/\">\n                  Конструктор\n                </HeaderItem>\n              </li>\n              <li className={cn(\"ml-2\")}>\n                <HeaderItem icon={ListIcon} path=\"/feed\">\n                  Лента заказов\n                </HeaderItem>\n              </li>\n            </ul>\n          </nav>\n        </li>\n        <li className={styles.contentItemCenter}>\n          <Link to=\"/\">\n            <Logo />\n          </Link>\n        </li>\n        <li className={styles.contentItemRight}>\n          <HeaderItem icon={ProfileIcon} path=\"/profile\">\n            Личный кабинет\n          </HeaderItem>\n        </li>\n      </ul>\n    </header>\n  );\n};\n\nexport default AppHeader;\n","import React from \"react\";\nimport { Redirect, Route, RouteProps } from \"react-router-dom\";\n\nimport { useAuth } from \"../services/auth\";\nimport Spinner from \"./spinner/spinner\";\n\ninterface IProtectedRouteProps extends RouteProps {\n  children: React.ReactNode;\n}\n\nexport const ProtectedRoute: React.FC<IProtectedRouteProps> = ({\n  children,\n  ...rest\n}) => {\n  const { user, userLoaded } = useAuth();\n\n  if (!userLoaded) {\n    return <Spinner center={true} />;\n  }\n\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        user ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: \"/login\",\n              state: { from: location },\n            }}\n          />\n        )\n      }\n    />\n  );\n};\n","import { useAuth } from \"../services/auth\";\nimport { Redirect, Route, RouteProps } from \"react-router-dom\";\nimport Spinner from \"./spinner/spinner\";\n\ninterface IUnauthorizedRouteProps extends RouteProps {\n  children: React.ReactNode;\n}\n\nexport const UnauthorizedRoute: React.FC<IUnauthorizedRouteProps> = ({\n  children,\n  ...rest\n}) => {\n  const { user, userLoaded } = useAuth();\n\n  if (!userLoaded) {\n    return <Spinner center={true} />;\n  }\n\n  return (\n    <Route {...rest} render={() => (user ? <Redirect to=\"/\" /> : children)} />\n  );\n};\n","import { memo, useCallback } from \"react\";\nimport { useSelector } from \"../../services/hooks\";\nimport { useHistory, useParams } from \"react-router-dom\";\n\nimport Modal from \"../modal/modal\";\nimport IngredientDetails from \"../ingredient-details/ingredient-details\";\n\nconst IngredientDetailsModal: React.FC = memo(() => {\n  const { id } = useParams<{ id: string }>();\n  const history = useHistory();\n  const { items: ingredients } = useSelector((store) => store.ingredients);\n\n  const ingredient = ingredients.find(({ _id }) => _id === id) || null;\n\n  const modalOnClose = useCallback(() => {\n    history.goBack();\n  }, [history]);\n\n  return (\n    ingredient && (\n      <Modal header=\"Детали ингридиента\" visible={true} onClose={modalOnClose}>\n        <IngredientDetails ingredient={ingredient} />\n      </Modal>\n    )\n  );\n});\n\nexport default IngredientDetailsModal;\n","import { memo, useCallback } from \"react\";\nimport OrderInfo from \"../order-info/order-info\";\nimport { useHistory, useLocation, useParams } from \"react-router-dom\";\nimport { useSelector } from \"../../services/hooks\";\n\nimport { useOrders } from \"../../services/orders\";\n\nimport Modal from \"../modal/modal\";\n\nconst OrderInfoModal: React.FC = memo(() => {\n  const { id } = useParams<{ id: string }>();\n  const history = useHistory();\n  const location = useLocation();\n\n  const { orders: feedOrders } = useSelector((store) => store.feed);\n  const { orders: profileOrders } = useSelector((store) => store.profile);\n\n  const orders = location.pathname.startsWith(\"/feed\")\n    ? feedOrders\n    : profileOrders;\n\n  const { ordersList } = useOrders(orders);\n\n  const order = ordersList.find(({ number }) => number === Number(id)) || null;\n\n  const modalOnClose = useCallback(() => {\n    history.goBack();\n  }, [history]);\n\n  const header = order && (\n    <div className=\"text text_type_digits-default\">#{order.number}</div>\n  );\n\n  return (\n    order && (\n      <Modal header={header} visible={true} onClose={modalOnClose}>\n        <OrderInfo order={order} isInModal={true} />\n      </Modal>\n    )\n  );\n});\n\nexport default OrderInfoModal;\n","import cn from \"classnames\";\nimport styles from \"./app.module.css\";\n\nimport { Switch, Route, useLocation, useHistory } from \"react-router-dom\";\n\nimport { Location } from \"history\";\n\nimport {\n  HomePage,\n  LoginPage,\n  RegisterPage,\n  ForgotPasswordPage,\n  ResetPasswordPage,\n  ProfilePage,\n  OrderPage,\n  FeedPage,\n  IngredientPage,\n  NotFound404,\n} from \"../../pages\";\nimport AppHeader from \"../app-header/app-header\";\nimport { ProtectedRoute } from \"../protected-route\";\nimport { UnauthorizedRoute } from \"../unauthorized-route\";\nimport IngredientDetailsModal from \"../ingredient-details-modal/ingredient-details-modal\";\nimport OrderInfoModal from \"../order-info-modal/order-info-modal\";\n\nconst App: React.FC = () => {\n  const location = useLocation<{ background?: Location }>();\n  const history = useHistory();\n  const background = history.action === \"PUSH\" && location.state?.background;\n\n  return (\n    <div className={styles.app}>\n      <AppHeader />\n      <main className={cn(styles.main)}>\n        <Switch location={background || location}>\n          <Route path=\"/\" exact={true}>\n            <HomePage />\n          </Route>\n          <Route path=\"/login\" exact={true}>\n            <LoginPage />\n          </Route>\n          <UnauthorizedRoute path=\"/register\" exact={true}>\n            <RegisterPage />\n          </UnauthorizedRoute>\n          <UnauthorizedRoute path=\"/forgot-password\" exact={true}>\n            <ForgotPasswordPage />\n          </UnauthorizedRoute>\n          <UnauthorizedRoute path=\"/reset-password\" exact={true}>\n            <ResetPasswordPage />\n          </UnauthorizedRoute>\n          <ProtectedRoute path=\"/profile/orders/:id\" exact={true}>\n            <OrderPage />\n          </ProtectedRoute>\n          <ProtectedRoute path=\"/profile\">\n            <ProfilePage />\n          </ProtectedRoute>\n          <Route path=\"/feed/:id\" exact={true}>\n            <OrderPage />\n          </Route>\n          <Route path=\"/feed\" exact={true}>\n            <FeedPage />\n          </Route>\n          <Route path=\"/ingredients/:id\" exact={true}>\n            <IngredientPage />\n          </Route>\n          <Route>\n            <NotFound404 />\n          </Route>\n        </Switch>\n      </main>\n      {background && (\n        <Route path=\"/ingredients/:id\">\n          <IngredientDetailsModal />\n        </Route>\n      )}\n      {background && (\n        <Route path=\"/profile/orders/:id\">\n          <OrderInfoModal />\n        </Route>\n      )}\n      {background && (\n        <Route path=\"/feed/:id\">\n          <OrderInfoModal />\n        </Route>\n      )}\n    </div>\n  );\n};\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {\n  GET_INGREDIENTS_REQUEST,\n  GET_INGREDIENTS_SUCCESS,\n  GET_INGREDIENTS_ERROR,\n} from \"../actions/ingredients\";\n\nimport { TIngredientsActions } from \"../actions/ingredients\";\nimport { IIngredient } from \"../types/data\";\n\nexport interface IIngredientsState {\n  items: IIngredient[];\n  itemsRequest: boolean;\n  itemsSuccess: boolean;\n  itemsErrorMessage: string;\n}\n\nconst ingredientsState: IIngredientsState = {\n  items: [],\n  itemsRequest: false,\n  itemsSuccess: false,\n  itemsErrorMessage: \"\",\n};\n\nexport const ingredientsReducer = (\n  state: IIngredientsState = ingredientsState,\n  action: TIngredientsActions\n) => {\n  switch (action.type) {\n    case GET_INGREDIENTS_REQUEST:\n      return {\n        ...state,\n        itemsRequest: true,\n        itemsSuccess: false,\n        itemsErrorMessage: \"\",\n      };\n\n    case GET_INGREDIENTS_SUCCESS:\n      return {\n        ...state,\n        itemsRequest: false,\n        itemsSuccess: true,\n        itemsErrorMessage: \"\",\n        items: action.items,\n      };\n\n    case GET_INGREDIENTS_ERROR:\n      return {\n        ...state,\n        itemsRequest: false,\n        itemsSuccess: false,\n        itemsErrorMessage: action.message,\n        items: [],\n      };\n\n    default:\n      return state;\n  }\n};\n","import {\n  ADD_CONSTRUCTOR_INGREDIENT,\n  REMOVE_CONSTRUCTOR_INGREDIENT,\n  REORDER_CONSTRUCTOR_INGREDIENTS,\n  CLEAR_CONSTRUCTOR,\n} from \"../actions/constructor\";\n\nimport { TConstructorActions } from \"../actions/constructor\";\nimport { IIngredient, IConstructorIngredient } from \"../types/data\";\n\nfunction countTotalPrice(\n  items: IConstructorIngredient[] = [],\n  bunItem: IIngredient | null\n) {\n  return (\n    items.reduce((prev, value) => prev + value.price, 0) +\n    (bunItem?.price || 0) * 2\n  );\n}\n\nexport interface IConstructorState {\n  items: IConstructorIngredient[];\n  bunItem: IIngredient | null;\n  totalPrice: number;\n}\n\nconst constructorState: IConstructorState = {\n  items: [],\n  bunItem: null,\n  totalPrice: 0,\n};\n\nexport const constructorReducer = (\n  state: IConstructorState = constructorState,\n  action: TConstructorActions\n) => {\n  switch (action.type) {\n    case ADD_CONSTRUCTOR_INGREDIENT:\n      const item = action.item;\n\n      if (item.type === \"bun\") {\n        return {\n          ...state,\n          bunItem: item,\n          totalPrice: countTotalPrice(state.items, item),\n        };\n      } else {\n        const items = [\n          ...state.items,\n          {\n            ...item,\n            key: item._id + new Date().getTime(),\n          },\n        ];\n        return {\n          ...state,\n          items,\n          totalPrice: countTotalPrice(items, state.bunItem),\n        };\n      }\n\n    case REMOVE_CONSTRUCTOR_INGREDIENT:\n      const items = state.items.filter(({ key }) => key !== action.item.key);\n      return {\n        ...state,\n        items,\n        totalPrice: countTotalPrice(items, state.bunItem),\n      };\n\n    case REORDER_CONSTRUCTOR_INGREDIENTS: {\n      const items = state.items;\n      const dropItem = items[action.dropIndex];\n\n      return {\n        ...state,\n        items: [\n          ...items\n            .slice(0, action.hoverIndex + 1)\n            .filter(({ key }) => key !== dropItem.key),\n          dropItem,\n          ...items\n            .slice(action.hoverIndex + 1)\n            .filter(({ key }) => key !== dropItem.key),\n        ],\n      };\n    }\n\n    case CLEAR_CONSTRUCTOR:\n      return constructorState;\n\n    default:\n      return state;\n  }\n};\n","import {\n  CHECKOUT_ORDER_REQUEST,\n  CHECKOUT_ORDER_SUCCESS,\n  CHECKOUT_ORDER_ERROR,\n  CLEAR_ORDER,\n} from \"../actions/order\";\n\nimport { TOrderActions } from \"../actions/order\";\n\nexport interface IOrderState {\n  number: number | null;\n  checkoutRequest: boolean;\n  checkoutSuccess: boolean;\n  checkoutErrorMessage: string;\n}\n\nconst orderState: IOrderState = {\n  number: null,\n  checkoutRequest: false,\n  checkoutSuccess: false,\n  checkoutErrorMessage: \"\",\n};\n\nexport const orderReducer = (\n  state: IOrderState = orderState,\n  action: TOrderActions\n) => {\n  switch (action.type) {\n    case CHECKOUT_ORDER_REQUEST:\n      return {\n        ...state,\n        checkoutRequest: true,\n        checkoutSuccess: false,\n        checkoutErrorMessage: \"\",\n        number: null,\n      };\n\n    case CHECKOUT_ORDER_SUCCESS:\n      return {\n        ...state,\n        checkoutRequest: false,\n        checkoutSuccess: true,\n        number: action.number,\n      };\n\n    case CHECKOUT_ORDER_ERROR:\n      return {\n        ...state,\n        checkoutRequest: false,\n        checkoutSuccess: false,\n        checkoutErrorMessage: action.message,\n      };\n\n    case CLEAR_ORDER:\n      return orderState;\n\n    default:\n      return state;\n  }\n};\n","import {\n  GET_USER_REQUEST,\n  GET_USER_SUCCESS,\n  GET_USER_ERROR,\n  SET_USER,\n  CLEAR_USER,\n} from \"../actions/user\";\n\nimport { TUserActions } from \"../actions/user\";\nimport { IUser } from \"../types/data\";\n\nexport interface IUserState {\n  user: IUser | null;\n  userRequest: boolean;\n  userSuccess: boolean;\n  userErrorMessage: string;\n}\n\nconst userState: IUserState = {\n  user: null,\n  userRequest: false,\n  userSuccess: false,\n  userErrorMessage: \"\",\n};\n\nexport const userReducer = (\n  state: IUserState = userState,\n  action: TUserActions\n) => {\n  switch (action.type) {\n    case GET_USER_REQUEST:\n      return {\n        ...state,\n        userRequest: true,\n        userSuccess: false,\n        userErrorMessage: \"\",\n        user: null,\n      };\n\n    case GET_USER_SUCCESS:\n      return {\n        ...state,\n        userRequest: false,\n        userSuccess: true,\n        userErrorMessage: \"\",\n        user: action.user,\n      };\n\n    case GET_USER_ERROR:\n      return {\n        ...state,\n        userRequest: false,\n        userSuccess: false,\n        userErrorMessage: action.message,\n        user: null,\n      };\n\n    case SET_USER:\n      return {\n        ...state,\n        user: action.user,\n      };\n\n    case CLEAR_USER:\n      return {\n        ...state,\n        user: null,\n      };\n\n    default:\n      return state;\n  }\n};\n","import {\n  WS_FEED_CONNECTION_SUCCESS,\n  WS_FEED_CONNECTION_ERROR,\n  WS_FEED_CONNECTION_CLOSED,\n  WS_FEED_GET_MESSAGE,\n  TWsFeedActions,\n} from \"../actions/ws-feed\";\nimport { IOrder } from \"../types/data\";\n\nexport interface IWsFeedState {\n  orders: IOrder[];\n  total: number;\n  totalToday: number;\n  wsConnected: boolean;\n  wsError: string;\n}\n\nconst initialState: IWsFeedState = {\n  wsConnected: false,\n  wsError: \"\",\n  orders: [],\n  total: 0,\n  totalToday: 0,\n};\n\nexport const wsFeedReducer = (\n  state: IWsFeedState = initialState,\n  action: TWsFeedActions\n) => {\n  switch (action.type) {\n    case WS_FEED_CONNECTION_SUCCESS:\n      return {\n        ...state,\n        wsError: \"\",\n        wsConnected: true,\n      };\n\n    case WS_FEED_CONNECTION_ERROR:\n      return {\n        ...state,\n        wsError: action.payload.message,\n        wsConnected: false,\n      };\n\n    case WS_FEED_CONNECTION_CLOSED:\n      return {\n        ...state,\n        wsError: \"\",\n        wsConnected: false,\n      };\n\n    case WS_FEED_GET_MESSAGE:\n      if (action.payload.message) {\n        return {\n          ...state,\n          wsError: action.payload.message,\n          orders: [],\n          total: 0,\n          totalToday: 0,\n        };\n      }\n\n      return {\n        ...state,\n        wsError: \"\",\n        orders: action.payload.orders,\n        total: action.payload.total,\n        totalToday: action.payload.totalToday,\n      };\n\n    default:\n      return state;\n  }\n};\n","import {\n  WS_PROFILE_CONNECTION_SUCCESS,\n  WS_PROFILE_CONNECTION_ERROR,\n  WS_PROFILE_CONNECTION_CLOSED,\n  WS_PROFILE_GET_MESSAGE,\n} from \"../actions/ws-profile\";\n\nimport { TWsProfileActions } from \"../actions/ws-profile\";\nimport { IOrder } from \"../types/data\";\n\nexport interface IWsProfileState {\n  orders: IOrder[];\n  wsConnected: boolean;\n  wsError: string;\n}\n\nconst initialState: IWsProfileState = {\n  wsConnected: false,\n  wsError: \"\",\n  orders: [],\n};\n\nexport const wsProfileReducer = (\n  state: IWsProfileState = initialState,\n  action: TWsProfileActions\n) => {\n  switch (action.type) {\n    case WS_PROFILE_CONNECTION_SUCCESS:\n      return {\n        ...state,\n        wsError: \"\",\n        wsConnected: true,\n      };\n\n    case WS_PROFILE_CONNECTION_ERROR:\n      return {\n        ...state,\n        wsError: action.payload.message,\n        wsConnected: false,\n      };\n\n    case WS_PROFILE_CONNECTION_CLOSED:\n      return {\n        ...state,\n        wsError: \"\",\n        wsConnected: false,\n      };\n\n    case WS_PROFILE_GET_MESSAGE:\n      if (action.payload.message) {\n        return {\n          ...state,\n          wsError: action.payload.message,\n          orders: [],\n        };\n      }\n\n      return {\n        ...state,\n        wsError: \"\",\n        orders: action.payload.orders,\n      };\n\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from \"redux\";\nimport { ingredientsReducer } from \"./ingredients\";\nimport { constructorReducer } from \"./constructor\";\nimport { orderReducer } from \"./order\";\nimport { userReducer } from \"./user\";\nimport { wsFeedReducer } from \"./ws-feed\";\nimport { wsProfileReducer } from \"./ws-profile\";\n\nexport const rootReducer = combineReducers({\n  ingredients: ingredientsReducer,\n  construct: constructorReducer,\n  order: orderReducer,\n  user: userReducer,\n  feed: wsFeedReducer,\n  profile: wsProfileReducer,\n});\n","import { Middleware, Dispatch } from \"redux\";\nimport { getCookie } from \"./utils\";\nimport { refreshToken } from \"./api\";\nimport { rootReducer } from \"./reducers\";\nimport {\n  WS_FEED_CONNECTION_START,\n  WS_FEED_CONNECTION_CLOSE,\n  WS_FEED_SEND_MESSAGE,\n  WS_FEED_CONNECTION_SUCCESS,\n  WS_FEED_CONNECTION_CLOSED,\n  WS_FEED_CONNECTION_ERROR,\n  WS_FEED_GET_MESSAGE,\n  TWsFeedActions,\n} from \"./actions/ws-feed\";\n\nimport {\n  WS_PROFILE_CONNECTION_START,\n  WS_PROFILE_CONNECTION_CLOSE,\n  WS_PROFILE_SEND_MESSAGE,\n  WS_PROFILE_CONNECTION_SUCCESS,\n  WS_PROFILE_CONNECTION_CLOSED,\n  WS_PROFILE_CONNECTION_ERROR,\n  WS_PROFILE_GET_MESSAGE,\n  TWsProfileActions,\n} from \"./actions/ws-profile\";\n\ntype TWsActions = {\n  wsInit: typeof WS_FEED_CONNECTION_START | typeof WS_PROFILE_CONNECTION_START;\n  wsClose: typeof WS_FEED_CONNECTION_CLOSE | typeof WS_PROFILE_CONNECTION_CLOSE;\n  wsSendMessage: typeof WS_FEED_SEND_MESSAGE | typeof WS_PROFILE_SEND_MESSAGE;\n  onOpen:\n    | typeof WS_FEED_CONNECTION_SUCCESS\n    | typeof WS_PROFILE_CONNECTION_SUCCESS;\n  onClose:\n    | typeof WS_FEED_CONNECTION_CLOSED\n    | typeof WS_PROFILE_CONNECTION_CLOSED;\n  onError: typeof WS_FEED_CONNECTION_ERROR | typeof WS_PROFILE_CONNECTION_ERROR;\n  onMessage: typeof WS_FEED_GET_MESSAGE | typeof WS_PROFILE_GET_MESSAGE;\n};\n\nexport const socketMiddleware = (\n  wsUrl: string,\n  wsActions: TWsActions,\n  useToken?: boolean\n): Middleware<\n  {},\n  ReturnType<typeof rootReducer>,\n  Dispatch<TWsFeedActions | TWsProfileActions>\n> => {\n  return (store) => {\n    let socket: WebSocket | null = null;\n\n    return (next) => (action) => {\n      const { dispatch } = store;\n      const { type, payload } = action;\n      const {\n        wsInit,\n        wsClose,\n        wsSendMessage,\n        onOpen,\n        onClose,\n        onError,\n        onMessage,\n      } = wsActions;\n      if (type === wsInit) {\n        let url = wsUrl;\n        if (useToken) {\n          const accessToken = getCookie(\"accessToken\");\n          url += `?token=${accessToken}`;\n        }\n        socket = new WebSocket(url);\n      }\n      if (socket) {\n        socket.onopen = (event) => {\n          dispatch({ type: onOpen, payload: event });\n        };\n\n        socket.onerror = (event) => {\n          dispatch({\n            type: onError,\n            payload: { message: \"Ошибка соединения\" },\n          });\n        };\n\n        socket.onmessage = (event) => {\n          const { data } = event;\n          const parsedData = JSON.parse(data);\n          const { success, ...restParsedData } = parsedData;\n\n          if (\n            restParsedData.message &&\n            restParsedData.message === \"Invalid or missing token\" &&\n            socket\n          ) {\n            socket.close();\n            refreshToken().then(() => {\n              dispatch({ type: wsInit });\n            });\n          } else {\n            dispatch({ type: onMessage, payload: restParsedData });\n          }\n        };\n\n        socket.onclose = (event) => {\n          dispatch({ type: onClose });\n        };\n\n        if (type === wsSendMessage) {\n          const message = { ...payload };\n          socket.send(JSON.stringify(message));\n        }\n\n        if (type === wsClose) {\n          socket.close();\n          socket = null;\n        }\n      }\n\n      next(action);\n    };\n  };\n};\n","import { compose, createStore, applyMiddleware } from \"redux\";\nimport thunk from \"redux-thunk\";\n\nimport { rootReducer } from \"./reducers\";\nimport { socketMiddleware } from \"./socket-middleware\";\nimport {\n  WS_FEED_CONNECTION_START,\n  WS_FEED_CONNECTION_CLOSE,\n  WS_FEED_SEND_MESSAGE,\n  WS_FEED_CONNECTION_SUCCESS,\n  WS_FEED_CONNECTION_CLOSED,\n  WS_FEED_CONNECTION_ERROR,\n  WS_FEED_GET_MESSAGE,\n} from \"./actions/ws-feed\";\n\nimport {\n  WS_PROFILE_CONNECTION_START,\n  WS_PROFILE_CONNECTION_CLOSE,\n  WS_PROFILE_SEND_MESSAGE,\n  WS_PROFILE_CONNECTION_SUCCESS,\n  WS_PROFILE_CONNECTION_CLOSED,\n  WS_PROFILE_CONNECTION_ERROR,\n  WS_PROFILE_GET_MESSAGE,\n} from \"./actions/ws-profile\";\n\nconst wsFeedOrders = {\n  url: \"wss://norma.nomoreparties.space/orders/all\",\n  actions: {\n    wsInit: WS_FEED_CONNECTION_START,\n    wsClose: WS_FEED_CONNECTION_CLOSE,\n    wsSendMessage: WS_FEED_SEND_MESSAGE,\n    onOpen: WS_FEED_CONNECTION_SUCCESS,\n    onClose: WS_FEED_CONNECTION_CLOSED,\n    onError: WS_FEED_CONNECTION_ERROR,\n    onMessage: WS_FEED_GET_MESSAGE,\n  },\n};\n\nconst wsProfileOrders = {\n  url: \"wss://norma.nomoreparties.space/orders\",\n  actions: {\n    wsInit: WS_PROFILE_CONNECTION_START,\n    wsClose: WS_PROFILE_CONNECTION_CLOSE,\n    wsSendMessage: WS_PROFILE_SEND_MESSAGE,\n    onOpen: WS_PROFILE_CONNECTION_SUCCESS,\n    onClose: WS_PROFILE_CONNECTION_CLOSED,\n    onError: WS_PROFILE_CONNECTION_ERROR,\n    onMessage: WS_PROFILE_GET_MESSAGE,\n  },\n};\n\ndeclare global {\n  interface Window {\n    __REDUX_DEVTOOLS_EXTENSION_COMPOSE__?: typeof compose;\n  }\n}\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst enhancer = composeEnhancers(\n  applyMiddleware(\n    thunk,\n    socketMiddleware(wsFeedOrders.url, wsFeedOrders.actions),\n    socketMiddleware(wsProfileOrders.url, wsProfileOrders.actions, true)\n  )\n);\n\nexport default createStore(rootReducer, enhancer);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter as Router, HashRouter } from \"react-router-dom\";\n\nimport \"./index.css\";\nimport App from \"./components/app/app\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport store from \"./services/store\";\nimport { Provider } from \"react-redux\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <HashRouter>\n        <App />\n      </HashRouter>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"burger-constructor_container__6B1um\",\"elements\":\"burger-constructor_elements__3rOpg\",\"bunElementTop\":\"burger-constructor_bunElementTop__ASSYO\",\"bunElementBottom\":\"burger-constructor_bunElementBottom__3M4Qy\",\"dragMessage\":\"burger-constructor_dragMessage__1qReQ\",\"dragMessageOver\":\"burger-constructor_dragMessageOver__2sNJV\",\"elementsScroll\":\"burger-constructor_elementsScroll__6hMO9 burger-constructor_elements__3rOpg\",\"footer\":\"burger-constructor_footer__bba9V\",\"footerCurrency\":\"burger-constructor_footerCurrency__3fdcB\",\"error\":\"burger-constructor_error__3PhHj\",\"center\":\"burger-constructor_center__rnF9g\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"burger-ingredients_container__g3Y-c\",\"title\":\"burger-ingredients_title__3-eSY\",\"tabs\":\"burger-ingredients_tabs__11tAC\",\"ingredientList\":\"burger-ingredients_ingredientList__1udKK\",\"ingredients\":\"burger-ingredients_ingredients__3JkVS\",\"ingredient\":\"burger-ingredients_ingredient__2d4AW\",\"enter\":\"burger-ingredients_enter___35Li\",\"enterActive\":\"burger-ingredients_enterActive__1L7vt\",\"exit\":\"burger-ingredients_exit__2Ngrf\",\"exitActive\":\"burger-ingredients_exitActive__1JkWc\",\"hidden\":\"burger-ingredients_hidden__aAB8A\",\"error\":\"burger-ingredients_error__28FCP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"order-item_container__21HZr\",\"header\":\"order-item_header__2eoTj\",\"title\":\"order-item_title__2suKe\",\"statusDone\":\"order-item_statusDone__eoToN\",\"footer\":\"order-item_footer__4G-RR\",\"ingredientList\":\"order-item_ingredientList__1eMQg\",\"ingredient\":\"order-item_ingredient__aB_BS\",\"price\":\"order-item_price__2ByDf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"app_app__1iO2A\",\"main\":\"app_main__2xlwg\",\"customScrollbar\":\"app_customScrollbar__9oUGE\",\"textSpaceShadow\":\"app_textSpaceShadow__oE2Xy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"order-info_container__3Z36n\",\"statusDone\":\"order-info_statusDone__2YHWI\",\"footer\":\"order-info_footer__xrBia\",\"ingredientList\":\"order-info_ingredientList__2JmUv\",\"ingredient\":\"order-info_ingredient__11Y2M\",\"ingredientName\":\"order-info_ingredientName__2XXpq\",\"price\":\"order-info_price__29-XW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"order_container__109Bl\",\"center\":\"order_center__v0cy4\",\"error\":\"order_error__21SUu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"app-header_header__2gokJ\",\"content\":\"app-header_content__t8UHX\",\"contentItem\":\"app-header_contentItem__EEQMV\",\"contentItemCenter\":\"app-header_contentItemCenter__-07yp app-header_contentItem__EEQMV\",\"contentItemRight\":\"app-header_contentItemRight__3YCaq app-header_contentItem__EEQMV\",\"navigation\":\"app-header_navigation__1JSpu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"modal_container__3-3mw\",\"title\":\"modal_title__IJjDb\",\"content\":\"modal_content__2OuMO app_customScrollbar__9oUGE\",\"closeButton\":\"modal_closeButton__3REEC\",\"hidden\":\"modal_hidden__1bEaB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ingredient_container__31Igb\",\"price\":\"ingredient_price__1pVsY\",\"title\":\"ingredient_title__1ll2v\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"imageResponsive\":\"lazy-image_imageResponsive__1F645\",\"imagePreloader\":\"lazy-image_imagePreloader__1uXjc\",\"imagePreloaderResponsive\":\"lazy-image_imagePreloaderResponsive__5s5Sx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"spinner\":\"spinner_spinner__10eHT\",\"rotate\":\"spinner_rotate__37IgN\",\"spinnerCenter\":\"spinner_spinnerCenter__QRXSM\",\"circle\":\"spinner_circle__38GPX\",\"dash\":\"spinner_dash__1yuey\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"register_container__3Jyyi\",\"error\":\"register_error__1WF_2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"reset-password_container__3QctV\",\"error\":\"reset-password_error__3D5Q8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form\":\"profile-form_form__2dmNA\",\"formFooter\":\"profile-form_formFooter__1Ed5L\",\"error\":\"profile-form_error__2I4gz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingredient\":\"ingredient-avatar_ingredient__15Zld\",\"ingredientImage\":\"ingredient-avatar_ingredientImage__2sdra\",\"ingredientFg\":\"ingredient-avatar_ingredientFg__-tQzF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ingredient-details_container__3MYGD\",\"title\":\"ingredient-details_title__1mCpc\",\"image\":\"ingredient-details_image__3PqS_\",\"imagePreloader\":\"ingredient-details_imagePreloader__1QTSj ingredient-details_image__3PqS_\",\"content\":\"ingredient-details_content__1ahpI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"skeleton\":\"skeleton_skeleton__2j3X9\",\"circle\":\"skeleton_circle__1J7KM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"order-details_container__21u_h\",\"title\":\"order-details_title__3cmiO app_textSpaceShadow__oE2Xy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"modal-overlay_container__1n_Ma\",\"hidden\":\"modal-overlay_hidden__17Rf-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"drag-element_container__3V56I\",\"dragItem\":\"drag-element_dragItem__7xK8c\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"login_container__1FLBr\",\"error\":\"login_error__1rcy-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"forgot-password_container__7kREh\",\"error\":\"forgot-password_error__3ID3w\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ingredient_container__3LfsL\",\"error\":\"ingredient_error__1v44w\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"header-item_container__rqenJ\",\"text\":\"header-item_text__2cjCi\"};"],"sourceRoot":""}